<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smartscape Slots - Dynatrace Observatory</title>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dt-purple': '#6C2C9C',
                        'dt-blue': '#00A1C9',
                        'dt-cyan': '#00D4FF',
                        'dt-green': '#73BE28',
                        'dt-orange': '#FFA86B',
                        'dt-yellow': '#FFD23F',
                        'dt-dark': '#151515',
                        'dt-darker': '#0A0A0A',
                        'dt-gray': '#2D2D2D',
                        'dt-light-gray': '#4A4A4A'
                    }
                }
            }
        }
    </script>
    
    <!-- External libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        /* SIMPLE CONTAINER LOCK */
        .slot-machine-container,
        .slot-reels-container {
            transform: none !important;
            scale: none !important;
        }
        
        /* Override any inline styles that might cause movement */
        .slot-machine-container[style*="transform"],
        .slot-machine-container[style*="scale"],
        .slot-reels-container[style*="transform"],
        .slot-reels-container[style*="scale"] {
            transform: none !important;
            scale: none !important;
        }
        
        /* === BACKGROUND & ATMOSPHERE === */
        .slots-bg {
            background: 
                /* Animated casino lights */
                radial-gradient(ellipse 800px 400px at 20% 30%, rgba(108, 44, 156, 0.2) 0%, transparent 60%),
                radial-gradient(ellipse 600px 300px at 80% 70%, rgba(0, 212, 255, 0.15) 0%, transparent 60%),
                radial-gradient(ellipse 700px 350px at 50% 10%, rgba(255, 210, 63, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse 500px 250px at 10% 80%, rgba(115, 190, 40, 0.12) 0%, transparent 50%),
                radial-gradient(ellipse 400px 200px at 90% 20%, rgba(255, 168, 107, 0.08) 0%, transparent 40%),
                /* Base gradient */
                linear-gradient(135deg, #0a0a0f 0%, #000000 30%, #0f0a15 70%, #050508 100%);
            min-height: 100vh;
            position: relative;
            animation: casino-atmosphere 12s ease-in-out infinite alternate;
        }

        @keyframes casino-atmosphere {
            0% {
                background: 
                    radial-gradient(ellipse 800px 400px at 20% 30%, rgba(108, 44, 156, 0.2) 0%, transparent 60%),
                    radial-gradient(ellipse 600px 300px at 80% 70%, rgba(0, 212, 255, 0.15) 0%, transparent 60%),
                    radial-gradient(ellipse 700px 350px at 50% 10%, rgba(255, 210, 63, 0.1) 0%, transparent 50%),
                    radial-gradient(ellipse 500px 250px at 10% 80%, rgba(115, 190, 40, 0.12) 0%, transparent 50%),
                    radial-gradient(ellipse 400px 200px at 90% 20%, rgba(255, 168, 107, 0.08) 0%, transparent 40%),
                    linear-gradient(135deg, #0a0a0f 0%, #000000 30%, #0f0a15 70%, #050508 100%);
            }
            25% {
                background: 
                    radial-gradient(ellipse 900px 450px at 25% 35%, rgba(108, 44, 156, 0.25) 0%, transparent 65%),
                    radial-gradient(ellipse 650px 320px at 75% 65%, rgba(0, 212, 255, 0.18) 0%, transparent 65%),
                    radial-gradient(ellipse 750px 380px at 45% 15%, rgba(255, 210, 63, 0.12) 0%, transparent 55%),
                    radial-gradient(ellipse 550px 280px at 15% 75%, rgba(115, 190, 40, 0.15) 0%, transparent 55%),
                    radial-gradient(ellipse 450px 220px at 85% 25%, rgba(255, 168, 107, 0.1) 0%, transparent 45%),
                    linear-gradient(135deg, #0c0c12 0%, #020202 30%, #120a18 70%, #080508 100%);
            }
            50% {
                background: 
                    radial-gradient(ellipse 750px 380px at 30% 40%, rgba(108, 44, 156, 0.18) 0%, transparent 55%),
                    radial-gradient(ellipse 700px 350px at 70% 60%, rgba(0, 212, 255, 0.12) 0%, transparent 58%),
                    radial-gradient(ellipse 800px 400px at 40% 20%, rgba(255, 210, 63, 0.15) 0%, transparent 58%),
                    radial-gradient(ellipse 600px 300px at 20% 70%, rgba(115, 190, 40, 0.1) 0%, transparent 48%),
                    radial-gradient(ellipse 500px 250px at 80% 30%, rgba(255, 168, 107, 0.12) 0%, transparent 48%),
                    linear-gradient(135deg, #0d0d15 0%, #010101 30%, #150a1c 70%, #070508 100%);
            }
            75% {
                background: 
                    radial-gradient(ellipse 850px 420px at 15% 25%, rgba(108, 44, 156, 0.22) 0%, transparent 62%),
                    radial-gradient(ellipse 550px 280px at 85% 75%, rgba(0, 212, 255, 0.2) 0%, transparent 62%),
                    radial-gradient(ellipse 650px 320px at 55% 5%, rgba(255, 210, 63, 0.08) 0%, transparent 48%),
                    radial-gradient(ellipse 480px 240px at 5% 85%, rgba(115, 190, 40, 0.18) 0%, transparent 52%),
                    radial-gradient(ellipse 380px 190px at 95% 15%, rgba(255, 168, 107, 0.06) 0%, transparent 38%),
                    linear-gradient(135deg, #0b0b10 0%, #030303 30%, #110a16 70%, #060508 100%);
            }
            100% {
                background: 
                    radial-gradient(ellipse 800px 400px at 20% 30%, rgba(108, 44, 156, 0.2) 0%, transparent 60%),
                    radial-gradient(ellipse 600px 300px at 80% 70%, rgba(0, 212, 255, 0.15) 0%, transparent 60%),
                    radial-gradient(ellipse 700px 350px at 50% 10%, rgba(255, 210, 63, 0.1) 0%, transparent 50%),
                    radial-gradient(ellipse 500px 250px at 10% 80%, rgba(115, 190, 40, 0.12) 0%, transparent 50%),
                    radial-gradient(ellipse 400px 200px at 90% 20%, rgba(255, 168, 107, 0.08) 0%, transparent 40%),
                    linear-gradient(135deg, #0a0a0f 0%, #000000 30%, #0f0a15 70%, #050508 100%);
            }
        }

        .slots-bg::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 30% 20%, rgba(108, 44, 156, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 70% 80%, rgba(0, 212, 255, 0.08) 0%, transparent 35%);
            animation: floating-lights 8s ease-in-out infinite alternate;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes floating-lights {
            0% {
                background: 
                    radial-gradient(circle at 30% 20%, rgba(108, 44, 156, 0.1) 0%, transparent 40%),
                    radial-gradient(circle at 70% 80%, rgba(0, 212, 255, 0.08) 0%, transparent 35%);
            }
            25% {
                background: 
                    radial-gradient(circle at 60% 30%, rgba(108, 44, 156, 0.12) 0%, transparent 45%),
                    radial-gradient(circle at 40% 70%, rgba(0, 212, 255, 0.1) 0%, transparent 40%);
            }
            50% {
                background: 
                    radial-gradient(circle at 80% 40%, rgba(108, 44, 156, 0.08) 0%, transparent 35%),
                    radial-gradient(circle at 20% 60%, rgba(0, 212, 255, 0.12) 0%, transparent 45%);
            }
            75% {
                background: 
                    radial-gradient(circle at 40% 60%, rgba(108, 44, 156, 0.15) 0%, transparent 50%),
                    radial-gradient(circle at 80% 30%, rgba(0, 212, 255, 0.06) 0%, transparent 30%);
            }
            100% {
                background: 
                    radial-gradient(circle at 30% 20%, rgba(108, 44, 156, 0.1) 0%, transparent 40%),
                    radial-gradient(circle at 70% 80%, rgba(0, 212, 255, 0.08) 0%, transparent 35%);
            }
        }
        
        .slot-machine-container {
            background: 
                radial-gradient(circle at 30% 30%, rgba(108, 44, 156, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 70% 70%, rgba(0, 212, 255, 0.08) 0%, transparent 50%),
                linear-gradient(145deg, rgba(21, 21, 21, 0.95), rgba(45, 45, 45, 0.8));
            border: 4px solid transparent;
            background-clip: padding-box;
            box-shadow: 
                0 0 0 2px #6C2C9C,
                0 20px 60px rgba(0, 0, 0, 0.8),
                0 0 40px rgba(108, 44, 156, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
            transform: none !important;
            transition: none !important;
        }
        
        .slot-machine-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 215, 0, 0.08) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(218, 165, 32, 0.06) 0%, transparent 35%);
            pointer-events: none;
        }
        
        .slot-reel {
            background: 
                radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.15) 0%, transparent 40%),
                linear-gradient(180deg, #2D2D2D 0%, #1A1A1A 30%, #2D2D2D 70%, #1A1A1A 100%);
            border: 3px solid transparent;
            background-clip: padding-box;
            box-shadow: 
                0 0 0 2px #8B4513,
                inset 0 4px 15px rgba(0, 0, 0, 0.9),
                inset 0 -4px 15px rgba(139, 69, 19, 0.3),
                0 8px 25px rgba(0, 0, 0, 0.6),
                0 0 20px rgba(139, 69, 19, 0.4);
            position: relative;
            overflow: hidden;
            border-radius: 12px;
        }
        
        .slot-reel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.1) 0%, 
                transparent 30%,
                rgba(218, 165, 32, 0.1) 70%,
                transparent 100%);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            border-radius: 10px;
        }
        
        .slot-reel:hover::before {
            opacity: 1;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.2) 0%, 
                rgba(218, 165, 32, 0.15) 50%,
                rgba(255, 215, 0, 0.1) 100%);
        }
        
        .slot-symbol {
            font-size: clamp(3.5rem, 9vw, 7rem);
            font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', 'Android Emoji', 'EmojiOne Color', sans-serif;
            text-shadow: 
                0 0 18px rgba(255, 255, 255, 1),
                0 0 30px rgba(0, 212, 255, 0.8),
                0 0 40px rgba(108, 44, 156, 0.6);
            filter: 
                drop-shadow(0 0 15px rgba(255, 255, 255, 0.6))
                drop-shadow(0 4px 8px rgba(0, 0, 0, 0.8));
            transition: all 0.3s ease;
            line-height: 1;
            font-weight: normal;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }
        
        .spinning .slot-symbol {
            animation: casino-reel-blur 0.1s ease-in-out infinite;
            filter: blur(2px) brightness(1.1);
        }
        
        @keyframes casino-reel-blur {
            0%, 100% { 
                filter: blur(1px) brightness(1);
                opacity: 1;
            }
            50% { 
                filter: blur(3px) brightness(1.2);
                opacity: 0.8;
            }
        }
        
        .winning-reel {
            border: 4px solid #FFD700 !important;
            box-shadow: 
                0 0 0 2px #FFFFFF,
                0 0 40px rgba(255, 215, 0, 1),
                0 0 80px rgba(255, 215, 0, 0.6),
                inset 0 4px 15px rgba(255, 255, 255, 0.3),
                inset 0 -4px 15px rgba(255, 215, 0, 0.2) !important;
            animation: casino-win-glow 1.2s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
        }
        
        .winning-reel .slot-symbol {
            animation: win-celebrate 1s ease-in-out infinite alternate;
            text-shadow: 0 0 30px rgba(115, 190, 40, 1);
        }
        
        @keyframes casino-win-glow {
            0% { 
                box-shadow: 
                    0 0 0 2px #FFFFFF,
                    0 0 40px rgba(255, 215, 0, 1),
                    0 0 80px rgba(255, 215, 0, 0.6),
                    inset 0 4px 15px rgba(255, 255, 255, 0.3);
                filter: brightness(1);
            }
            100% { 
                box-shadow: 
                    0 0 0 3px #FFFFFF,
                    0 0 60px rgba(255, 215, 0, 1.2),
                    0 0 120px rgba(255, 215, 0, 0.8),
                    inset 0 4px 20px rgba(255, 255, 255, 0.4);
                filter: brightness(1.2);
            }
        }
        
        @keyframes win-celebrate {
            0% { transform: scale(1) rotate(-1deg); }
            100% { transform: scale(1.1) rotate(1deg); }
        }
        
        /* Enhanced Symbol Rarity Effects */
        .rarity-legendary {
            animation: legendary-glow 2s ease-in-out infinite alternate;
            filter: drop-shadow(0 0 15px rgba(255, 210, 63, 0.8));
        }
        
        .rarity-epic {
            animation: epic-pulse 1.5s ease-in-out infinite alternate;
            filter: drop-shadow(0 0 10px rgba(108, 44, 156, 0.6));
        }
        
        .rarity-rare {
            filter: drop-shadow(0 0 8px rgba(0, 161, 201, 0.4));
        }
        
        .rarity-common {
            filter: drop-shadow(0 0 5px rgba(255, 255, 255, 0.2));
        }
        
        @keyframes legendary-glow {
            0% { 
                transform: scale(1);
                filter: drop-shadow(0 0 15px rgba(255, 210, 63, 0.8)) hue-rotate(0deg);
            }
            100% { 
                transform: scale(1.05);
                filter: drop-shadow(0 0 25px rgba(255, 210, 63, 1)) hue-rotate(30deg);
            }
        }
        
        @keyframes epic-pulse {
            0% { 
                transform: scale(1);
                filter: drop-shadow(0 0 10px rgba(108, 44, 156, 0.6));
            }
            100% { 
                transform: scale(1.03);
                filter: drop-shadow(0 0 20px rgba(108, 44, 156, 0.9));
            }
        }
        
        .jackpot-alert {
            background: linear-gradient(135deg, 
                rgba(115, 190, 40, 0.95) 0%, 
                rgba(255, 210, 63, 0.95) 100%);
            border: 2px solid #73BE28;
            box-shadow: 
                0 0 40px rgba(115, 190, 40, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                0 0 0 2000px rgba(0, 0, 0, 0.6); /* Dark overlay backdrop */
            animation: jackpot-glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes jackpot-glow {
            0% { 
                box-shadow: 
                    0 0 40px rgba(115, 190, 40, 0.6),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3),
                    0 0 0 2000px rgba(0, 0, 0, 0.6);
                transform: scale(1);
            }
            100% { 
                box-shadow: 
                    0 0 60px rgba(115, 190, 40, 0.8),
                    inset 0 1px 0 rgba(255, 255, 255, 0.4),
                    0 0 0 2000px rgba(0, 0, 0, 0.7);
                transform: scale(1.02);
            }
        }
        
        .metrics-panel {
            background: 
                radial-gradient(circle at 20% 30%, rgba(139, 69, 19, 0.3) 0%, transparent 50%),
                linear-gradient(145deg, rgba(21, 21, 21, 0.95), rgba(45, 45, 45, 0.9));
            border: 2px solid transparent;
            background-clip: padding-box;
            backdrop-filter: blur(15px);
            box-shadow: 
                0 0 0 1px #8B4513,
                0 8px 32px rgba(0, 0, 0, 0.8),
                0 0 20px rgba(139, 69, 19, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .metric-value {
            background: linear-gradient(45deg, #00D4FF, #6C2C9C, #73BE28);
            background-size: 300% 300%;
            animation: metric-shimmer 3s ease-in-out infinite;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        @keyframes metric-shimmer {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .connection-line {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(0, 212, 255, 0.8) 50%, 
                transparent 100%);
            animation: line-pulse 2s ease-in-out infinite;
        }
        
        @keyframes line-pulse {
            0%, 100% { opacity: 0.3; transform: scaleX(0.8); }
            50% { opacity: 1; transform: scaleX(1.2); }
        }
        
        .mega-win {
            animation: casino-mega-glow 2s cubic-bezier(0.25, 0.46, 0.45, 0.94) infinite;
            border: 4px solid #FFD700 !important;
            box-shadow: 
                0 0 0 2px #FFFFFF,
                0 0 60px rgba(255, 215, 0, 1.5),
                0 0 120px rgba(255, 215, 0, 1),
                0 0 200px rgba(255, 165, 0, 0.6),
                inset 0 0 50px rgba(255, 215, 0, 0.4) !important;
        }
        
        @keyframes casino-mega-glow {
            0%, 100% { 
                filter: hue-rotate(0deg) brightness(1);
                box-shadow: 
                    0 0 0 2px #FFFFFF,
                    0 0 60px rgba(255, 215, 0, 1.5),
                    0 0 120px rgba(255, 215, 0, 1),
                    0 0 200px rgba(255, 165, 0, 0.6);
            }
            25% { 
                filter: hue-rotate(30deg) brightness(1.2);
                box-shadow: 
                    0 0 0 3px #FFFFFF,
                    0 0 80px rgba(255, 215, 0, 1.8),
                    0 0 160px rgba(255, 215, 0, 1.2),
                    0 0 250px rgba(255, 165, 0, 0.8);
            }
            50% {
                filter: hue-rotate(60deg) brightness(1.3);
                box-shadow: 
                    0 0 0 4px #FFFFFF,
                    0 0 100px rgba(255, 215, 0, 2),
                    0 0 200px rgba(255, 215, 0, 1.4),
                    0 0 300px rgba(255, 165, 0, 1);
            }
            75% { 
                filter: hue-rotate(30deg) brightness(1.1);
                box-shadow: 
                    0 0 0 3px #FFFFFF,
                    0 0 75px rgba(255, 215, 0, 1.7),
                    0 0 150px rgba(255, 215, 0, 1.1),
                    0 0 225px rgba(255, 165, 0, 0.7);
            }
        }
        
        @keyframes celebrate {
            0% {
                transform: translateY(0) rotate(0deg) scale(0);
                opacity: 1;
                filter: hue-rotate(0deg);
            }
            25% {
                transform: translateY(-25vh) rotate(90deg) scale(1.2);
                opacity: 1;
                filter: hue-rotate(90deg);
            }
            75% {
                transform: translateY(-75vh) rotate(270deg) scale(0.8);
                opacity: 0.8;
                filter: hue-rotate(270deg);
            }
            100% {
                transform: translateY(-100vh) rotate(360deg) scale(0);
                opacity: 0;
                filter: hue-rotate(360deg);
            }
        }
        
        .lever-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .lever {
            width: 90px;
            height: 220px;
            background: 
                radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.2) 0%, transparent 40%),
                linear-gradient(145deg, #8B4513 0%, #A0522D 30%, #654321 70%, #4A4A4A 100%);
            border: 4px solid transparent;
            background-clip: padding-box;
            border-radius: 45px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            padding: 15px 0;
            box-shadow: 
                0 0 0 2px #DAA520,
                0 10px 30px rgba(0, 0, 0, 0.8),
                0 0 25px rgba(218, 165, 32, 0.4),
                inset 0 3px 8px rgba(255, 255, 255, 0.2),
                inset 0 -3px 8px rgba(0, 0, 0, 0.3);
        }
        
        .lever:hover {
            transform: translateY(-8px);
            box-shadow: 
                0 0 0 3px #FFD700,
                0 15px 40px rgba(0, 0, 0, 0.9),
                0 0 35px rgba(255, 215, 0, 0.6),
                inset 0 3px 12px rgba(255, 255, 255, 0.3),
                inset 0 -3px 12px rgba(0, 0, 0, 0.3);
        }
        
        .lever:active {
            transform: translateY(10px);
            box-shadow: 
                0 4px 10px rgba(0, 0, 0, 0.6),
                inset 0 2px 4px rgba(0, 0, 0, 0.3),
                0 0 15px rgba(0, 212, 255, 0.4);
        }
        
        .lever-handle {
            width: 65px;
            height: 65px;
            background: 
                radial-gradient(circle at 25% 25%, #FFFFFF 0%, #FFD700 15%, #DAA520 40%, #B8860B 70%, #8B6914 100%);
            border: 3px solid #FFFFFF;
            border-radius: 50%;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 
                0 6px 15px rgba(0, 0, 0, 0.5),
                0 0 25px rgba(255, 215, 0, 0.8),
                inset 0 3px 8px rgba(255, 255, 255, 0.6),
                inset 0 -3px 8px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .lever-handle::before {
            content: 'â™¦';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            color: #8B4513;
            text-shadow: 
                0 0 10px rgba(255, 255, 255, 0.8),
                0 1px 2px rgba(0, 0, 0, 0.3);
        }
        
        .lever-pull-text {
            position: absolute;
            bottom: 25px;
            left: 50%;
            transform: translateX(-50%);
            color: rgba(0, 212, 255, 0.9);
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
        
        .pulling .lever {
            transform: translateY(15px) rotate(5deg);
        }
        
        .control-button {
            background: 
                radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.15) 0%, transparent 40%),
                linear-gradient(145deg, rgba(139, 69, 19, 0.9), rgba(160, 82, 45, 0.8));
            border: 2px solid transparent;
            background-clip: padding-box;
            box-shadow: 
                0 0 0 1px #DAA520,
                0 4px 15px rgba(0, 0, 0, 0.5),
                0 0 15px rgba(218, 165, 32, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
        }
        
        .control-button:hover {
            background: 
                radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.2) 0%, transparent 40%),
                linear-gradient(145deg, rgba(218, 165, 32, 0.9), rgba(255, 215, 0, 0.8));
            box-shadow: 
                0 0 0 2px #FFD700,
                0 6px 20px rgba(0, 0, 0, 0.7),
                0 0 25px rgba(255, 215, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transform: translateY(-3px);
            color: #8B4513;
        }
        
        /* Side Panel Styles */
        .side-panel {
            background: 
                radial-gradient(circle at 20% 30%, rgba(108, 44, 156, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 212, 255, 0.1) 0%, transparent 40%),
                linear-gradient(145deg, rgba(21, 21, 21, 0.98), rgba(45, 45, 45, 0.95));
            backdrop-filter: blur(20px);
            box-shadow: 
                2px 0 20px rgba(0, 0, 0, 0.8),
                0 0 40px rgba(108, 44, 156, 0.3),
                inset -1px 0 0 rgba(0, 212, 255, 0.2);
        }
        
        .side-panel-open {
            transform: translateX(0) !important;
        }
        
        .main-content-shifted {
            margin-left: min(320px, 25vw);
        }
        
        .header-shifted {
            margin-left: min(320px, 25vw);
        }
        
        .config-toggle-btn {
            background: 
                radial-gradient(circle at 25% 25%, rgba(108, 44, 156, 0.95) 0%, rgba(75, 31, 111, 0.95) 70%),
                linear-gradient(145deg, rgba(108, 44, 156, 0.9), rgba(45, 45, 45, 0.8));
            box-shadow: 
                0 6px 20px rgba(0, 0, 0, 0.8),
                0 0 25px rgba(108, 44, 156, 0.6),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            writing-mode: vertical-rl;
            text-orientation: mixed;
            z-index: 150;
        }
        
        .config-toggle-btn:hover {
            background: 
                radial-gradient(circle at 25% 25%, rgba(108, 44, 156, 1) 0%, rgba(75, 31, 111, 1) 70%),
                linear-gradient(145deg, rgba(108, 44, 156, 0.95), rgba(45, 45, 45, 0.8));
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.9),
                0 0 35px rgba(108, 44, 156, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* Cheat Toggle Button Positioning */
        #cheatToggleBtn {
            z-index: 150 !important;
        }
        
        /* === LAYOUT SYSTEM === */
        .responsive-layout {
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .responsive-header {
            height: clamp(60px, 8vh, 80px);
            flex-shrink: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 100;
        }

        .responsive-main {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }        .game-grid {
            height: 100%;
            display: grid;
            grid-template-rows: 1fr auto;
            grid-template-columns: 1fr;
            overflow: hidden;
            position: relative;
        }
        
        .metrics-column {
            display: flex;
            flex-direction: column;
            min-height: 0;
            gap: clamp(0.5rem, 1.5vh, 1.5rem);
        }
        
        .slot-machine-column {
            display: flex;
            flex-direction: column;
            justify-content: center;
            min-height: 0;
        }
        
        .lever-column {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 0;
        }
        
        /* Responsive Panels */
        .metrics-panel {
            flex: 1;
            min-height: 0;
            padding: clamp(0.75rem, 2vh, 1.5rem);
            overflow-y: auto;
        }
        
        /* === MAIN CONTAINER === */
        .slot-machine-container {
            padding: clamp(2rem, 4vh, 4rem);
            /* Removed padding-right - analytics overlays naturally */
            height: 100%;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
            gap: clamp(2.5rem, 5vh, 5rem);
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* === SLOT REELS === */
        .slot-reels-container {
            position: relative;
            background: 
                radial-gradient(ellipse at center, rgba(15, 25, 40, 0.95) 0%, rgba(8, 15, 25, 0.98) 70%, rgba(5, 10, 15, 1) 100%),
                linear-gradient(135deg, rgba(108, 44, 156, 0.1) 0%, transparent 30%, rgba(0, 212, 255, 0.1) 70%, transparent 100%);
            border-radius: 24px;
            padding: clamp(2.5rem, 5vh, 4rem);
            box-shadow: 
                /* Premium chrome effect */
                0 0 0 4px rgba(255, 255, 255, 0.1),
                0 0 0 8px rgba(108, 44, 156, 0.3),
                0 0 0 12px rgba(0, 212, 255, 0.2),
                0 0 0 16px rgba(255, 215, 0, 0.15),
                /* Deep shadow */
                0 20px 80px rgba(0, 0, 0, 0.8),
                /* Inner glow */
                inset 0 2px 20px rgba(255, 255, 255, 0.1),
                inset 0 -2px 20px rgba(0, 0, 0, 0.4);
            /* LAPTOP OPTIMIZED DIMENSIONS */
            width: clamp(600px, 75vw, 1000px);
            height: clamp(550px, 65vh, 800px);
            overflow: hidden;
            box-sizing: border-box;
            margin: 0 auto;
        }
        
        .slot-reels-container::before {
            content: '';
            position: absolute;
            top: -12px;
            left: -12px;
            right: -12px;
            bottom: -12px;
            background: conic-gradient(from 0deg, 
                #606060, #F8F8F8, #707070, #FFFFFF, 
                #505050, #E8E8E8, #808080, #F0F0F0,
                #606060, #FAFAFA, #707070, #FFFFFF);
            border-radius: 44px;
            z-index: -2;
            animation: chrome-rotation 8s linear infinite;
        }
        
        .slot-reels-container::after {
            content: '';
            position: absolute;
            top: -8px;
            left: -8px;
            right: -8px;
            bottom: -8px;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.4) 0%,
                rgba(255, 255, 255, 0.1) 25%,
                rgba(0, 0, 0, 0.1) 50%,
                rgba(255, 255, 255, 0.2) 75%,
                rgba(255, 255, 255, 0.3) 100%);
            border-radius: 40px;
            z-index: -1;
            animation: metallic-reflection 6s ease-in-out infinite;
        }

        @keyframes premium-chrome-glow {
            0% { 
                box-shadow: 
                    0 0 0 6px rgba(240, 240, 240, 0.9),
                    0 0 0 12px rgba(160, 160, 160, 0.7),
                    0 0 0 16px rgba(128, 128, 128, 0.5),
                    0 15px 60px rgba(0, 0, 0, 0.9),
                    inset 0 4px 25px rgba(255, 255, 255, 0.15),
                    inset 0 -4px 25px rgba(0, 0, 0, 0.6);
            }
            100% { 
                box-shadow: 
                    0 0 0 6px rgba(248, 248, 248, 1),
                    0 0 0 12px rgba(192, 192, 192, 0.8),
                    0 0 0 16px rgba(160, 160, 160, 0.6),
                    0 20px 80px rgba(0, 0, 0, 1),
                    inset 0 6px 35px rgba(255, 255, 255, 0.25),
                    inset 0 -6px 35px rgba(0, 0, 0, 0.8);
            }
        }
        
        @keyframes chrome-rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes metallic-reflection {
            0%, 100% { 
                background: linear-gradient(135deg, 
                    rgba(255, 255, 255, 0.4) 0%,
                    rgba(255, 255, 255, 0.1) 25%,
                    rgba(0, 0, 0, 0.1) 50%,
                    rgba(255, 255, 255, 0.2) 75%,
                    rgba(255, 255, 255, 0.3) 100%);
            }
            50% { 
                background: linear-gradient(135deg, 
                    rgba(255, 255, 255, 0.6) 0%,
                    rgba(255, 255, 255, 0.2) 25%,
                    rgba(0, 0, 0, 0.05) 50%,
                    rgba(255, 255, 255, 0.4) 75%,
                    rgba(255, 255, 255, 0.5) 100%);
            }
        }
        
        .slot-reels-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: clamp(2rem, 4vw, 3rem);
            background: 
                radial-gradient(ellipse at center, rgba(20, 30, 50, 0.8) 0%, rgba(10, 15, 25, 0.95) 70%),
                linear-gradient(45deg, rgba(108, 44, 156, 0.05) 0%, rgba(0, 212, 255, 0.05) 50%, rgba(255, 215, 0, 0.05) 100%);
            border-radius: 20px;
            padding: clamp(2rem, 4vh, 3rem);
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            /* FILL CONTAINER */
            width: 100%;
            height: 100%;
            box-sizing: border-box;
        }
        
        .slot-reels-grid::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(90deg, transparent 0%, rgba(0, 212, 255, 0.1) 50%, transparent 100%),
                linear-gradient(0deg, transparent 0%, rgba(115, 190, 40, 0.05) 50%, transparent 100%);
            pointer-events: none;
        }
        
        .slot-reel {
            aspect-ratio: 1;
            width: 100%;
            height: 100%;
            min-width: 140px;
            min-height: 140px;
            background: 
                linear-gradient(145deg, rgba(20, 30, 45, 0.98) 0%, rgba(10, 20, 35, 0.99) 50%, rgba(15, 25, 40, 0.98) 100%),
                radial-gradient(ellipse at 30% 30%, rgba(108, 44, 156, 0.15), transparent 60%),
                radial-gradient(ellipse at 70% 70%, rgba(0, 212, 255, 0.1), transparent 60%);
            border: 3px solid;
            border-image: linear-gradient(45deg, rgba(255, 255, 255, 0.5), rgba(108, 44, 156, 0.6), rgba(0, 212, 255, 0.5)) 1;
            border-radius: 20px;
            box-shadow: 
                0 8px 35px rgba(0, 0, 0, 0.8),
                0 0 25px rgba(108, 44, 156, 0.5),
                inset 0 3px 20px rgba(255, 255, 255, 0.2),
                inset 0 -3px 20px rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            transition: border-color 0.4s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(12px);
            transform: none !important;
            scale: none !important;
            box-shadow: 
                /* Crystal depth */
                0 8px 25px rgba(0, 0, 0, 0.4),
                0 4px 10px rgba(0, 0, 0, 0.3),
                /* Inner crystal light */
                inset 0 2px 8px rgba(255, 255, 255, 0.15),
                inset 0 -2px 8px rgba(0, 0, 0, 0.2),
                /* Chrome border highlight */
                inset 0 0 0 1px rgba(255, 255, 255, 0.2);
        }
        
        .slot-reel::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.4), 
                transparent);
            animation: crystal-shimmer 3s ease-in-out infinite;
            z-index: 1;
        }

        @keyframes crystal-shimmer {
            0% { left: -100%; }
            50% { left: -100%; }
            100% { left: 100%; }
        }
        
        .slot-reel:hover {
            border-color: rgba(0, 212, 255, 0.8);
            box-shadow: 
                0 0 20px rgba(0, 212, 255, 0.4),
                0 8px 25px rgba(0, 0, 0, 0.4),
                inset 0 2px 8px rgba(255, 255, 255, 0.25),
                inset 0 -2px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .slot-reel:hover::before {
            animation: rapid-shimmer 0.8s linear infinite;
        }

        @keyframes rapid-shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .slot-reel.spinning {
            border-color: #00D4FF;
            opacity: 0.9;
        }

        .slot-reel.spinning::before {
            animation: rapid-shimmer 0.2s linear infinite;
        }
        
        @keyframes premium-spin-effects {
            0% { 
                box-shadow: 
                    0 0 8px rgba(0, 212, 255, 0.8),
                    0 0 4px rgba(255, 210, 63, 0.6),
                    0 4px 12px rgba(0, 0, 0, 0.4),
                    inset 0 2px 8px rgba(255, 255, 255, 0.3);
            }
            50% { 
                box-shadow: 
                    0 0 12px rgba(0, 212, 255, 1),
                    0 0 6px rgba(255, 210, 63, 0.8),
                    0 4px 12px rgba(0, 0, 0, 0.4),
                    inset 0 3px 12px rgba(255, 255, 255, 0.4);
            }
            100% { 
                box-shadow: 
                    0 0 8px rgba(0, 212, 255, 0.8),
                    0 0 4px rgba(255, 210, 63, 0.6),
                    0 4px 12px rgba(0, 0, 0, 0.4),
                    inset 0 2px 8px rgba(255, 255, 255, 0.3);
            }
        }
        
        .slot-symbol img {
            width: clamp(70px, 14vw, 140px) !important;
            height: clamp(70px, 14vw, 140px) !important;
            filter: drop-shadow(0 0 18px rgba(115, 190, 40, 0.8));
            transition: all 0.3s ease;
        }
        
        .slot-reel:hover .slot-symbol img {
            filter: drop-shadow(0 0 25px rgba(115, 190, 40, 1)) brightness(1.3);
            transform: scale(1.1);
        }
        
        /* Enhanced emoji symbol styling */
        .slot-symbol > div {
            text-shadow: 
                0 0 20px rgba(255, 255, 255, 0.9),
                0 0 35px rgba(0, 212, 255, 0.7),
                0 0 45px rgba(108, 44, 156, 0.5),
                2px 2px 4px rgba(0, 0, 0, 0.8);
            filter: brightness(1.1) contrast(1.2);
        }
        
        /* Ensure symbols in div format are also properly sized */
        .slot-symbol div {
            font-size: clamp(3.5rem, 9vw, 7rem) !important;
            font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', 'Android Emoji', 'EmojiOne Color', sans-serif !important;
            line-height: 1;
            font-weight: normal !important;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }
        
        /* Responsive Controls */
        .game-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: clamp(1rem, 3vw, 2rem);
            margin-top: clamp(1rem, 2vh, 1.5rem);
        }
        
        /* Responsive Lever */
        .lever {
            width: clamp(100px, 14vw, 140px);
            height: clamp(200px, 25vh, 250px);
        }
        
        .lever-handle {
            width: clamp(6rem, 12vw, 10rem);
            height: clamp(6rem, 12vw, 10rem);
            border-radius: 50%;
            background: 
                radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.3), transparent 60%),
                linear-gradient(145deg, rgba(255, 215, 0, 1), rgba(218, 165, 32, 0.9));
            box-shadow: 
                0 10px 40px rgba(0, 0, 0, 0.6),
                0 0 30px rgba(255, 215, 0, 0.5),
                inset 0 4px 20px rgba(255, 255, 255, 0.4),
                inset 0 -4px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .side-analytics {
            position: fixed;
            right: clamp(10px, 2vw, 25px);
            top: clamp(120px, 15vh, 180px);
            z-index: 100;
            background: 
                linear-gradient(145deg, rgba(15, 25, 40, 0.95), rgba(20, 30, 48, 0.9));
            color: white;
            padding: clamp(10px, 2vh, 18px);
            border-radius: 12px;
            font-size: clamp(0.75rem, 1.4vw, 0.9rem);
            width: clamp(160px, 18vw, 200px);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(108, 44, 156, 0.4);
            box-shadow: 
                0 6px 25px rgba(0, 0, 0, 0.7),
                0 0 15px rgba(108, 44, 156, 0.3),
                inset 0 2px 8px rgba(255, 255, 255, 0.1);
        }
        
        .main-game-area {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
            position: relative;
            padding: clamp(1rem, 2vh, 2rem);
            box-sizing: border-box;
        }
        
        .controls-area {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: clamp(1rem, 2vh, 2rem);
            background: rgba(21, 21, 21, 0.9);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(108, 44, 156, 0.3);
        }

        /* === CONTROLS & UI === */
        .premium-control-bar {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: clamp(2.5rem, 5vw, 5rem);
            padding: clamp(2rem, 4vh, 3rem);
            background: 
                linear-gradient(145deg, rgba(25, 35, 55, 0.95) 0%, rgba(20, 30, 48, 0.98) 50%, rgba(30, 41, 59, 0.95) 100%),
                radial-gradient(ellipse at center, rgba(108, 44, 156, 0.1) 0%, transparent 70%);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 3px solid;
            border-image: linear-gradient(45deg, 
                rgba(108, 44, 156, 0.8) 0%, 
                rgba(0, 212, 255, 0.6) 33%, 
                rgba(255, 215, 0, 0.7) 66%, 
                rgba(108, 44, 156, 0.8) 100%) 1;
            box-shadow: 
                0 12px 45px rgba(0, 0, 0, 0.6),
                0 0 35px rgba(108, 44, 156, 0.3),
                inset 0 2px 20px rgba(255, 255, 255, 0.1),
                inset 0 -2px 20px rgba(0, 0, 0, 0.3);
            width: clamp(450px, 75vw, 900px);
            max-width: 900px;
            margin: 0 auto;
        }

        /* Autospin Status Bar */
        .autospin-status-bar {
            margin: 0 auto 1rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, rgba(108, 44, 156, 0.2), rgba(0, 212, 255, 0.1));
            backdrop-filter: blur(15px);
            border-radius: 15px;
            border: 1px solid rgba(108, 44, 156, 0.4);
            box-shadow: 0 8px 32px rgba(108, 44, 156, 0.3);
            max-width: 600px;
            animation: autospin-pulse 2s ease-in-out infinite alternate;
        }

        .autospin-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .autospin-counter {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .counter-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }

        .counter-label {
            font-size: 0.75rem;
            color: #94a3b8;
            font-weight: 600;
            letter-spacing: 0.05em;
        }

        .counter-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: #00d4ff;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.6);
            font-family: 'Courier New', monospace;
        }

        .counter-value.wins {
            color: #22c55e;
            text-shadow: 0 0 10px rgba(34, 197, 94, 0.6);
        }

        .counter-value.profit {
            color: #ffd23f;
            text-shadow: 0 0 10px rgba(255, 210, 63, 0.6);
        }

        .counter-total {
            font-size: 1rem;
            color: #64748b;
            font-weight: 600;
        }

        .autospin-progress {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #6c2c9c, #00d4ff);
            border-radius: 2px;
            transition: width 0.5s ease;
            width: 0%;
        }

        @keyframes autospin-pulse {
            0% { box-shadow: 0 8px 32px rgba(108, 44, 156, 0.3); }
            100% { box-shadow: 0 8px 32px rgba(108, 44, 156, 0.5), 0 0 20px rgba(0, 212, 255, 0.3); }
        }

        /* Static Payline Indicator - Only spans middle row of 3x3 grid */
        .payline-indicator {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                transparent 15%,
                rgba(255, 215, 0, 0.9) 20%, 
                rgba(255, 215, 0, 1) 50%, 
                rgba(255, 215, 0, 0.9) 80%,
                transparent 85%, 
                transparent 100%);
            border-radius: 3px;
            box-shadow: 
                0 0 15px rgba(255, 215, 0, 0.8),
                0 0 30px rgba(255, 215, 0, 0.5);
            pointer-events: none;
            z-index: 5;
            opacity: 0;
            transform: translateY(-50%);
            /* Only show on the area where middle row reels are */
            clip-path: polygon(15% 0%, 85% 0%, 85% 100%, 15% 100%);
            transition: opacity 0.3s ease-in-out;
        }

        .payline-indicator.winning {
            opacity: 1;
            animation: payline-glow 1.5s ease-in-out infinite alternate;
        }

        @keyframes payline-glow {
            0% { 
                opacity: 1;
                box-shadow: 
                    0 0 15px rgba(255, 215, 0, 0.8),
                    0 0 30px rgba(255, 215, 0, 0.5);
            }
            100% { 
                opacity: 1;
                box-shadow: 
                    0 0 25px rgba(255, 215, 0, 1),
                    0 0 50px rgba(255, 215, 0, 0.8),
                    0 0 75px rgba(255, 215, 0, 0.4);
            }
        }

        /* Premium Lever */
        .premium-lever {
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .lever-base {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .lever-handle {
            width: clamp(5rem, 10vw, 8rem);
            height: clamp(5rem, 10vw, 8rem);
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 50%;
            background: 
                radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.3), transparent 60%),
                linear-gradient(145deg, rgba(255, 215, 0, 1), rgba(218, 165, 32, 0.9));
            box-shadow: 
                0 8px 35px rgba(0, 0, 0, 0.6),
                0 0 25px rgba(255, 215, 0, 0.5),
                inset 0 3px 15px rgba(255, 255, 255, 0.4),
                inset 0 -3px 15px rgba(0, 0, 0, 0.3);
        }

        .handle-orb {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, #FFD23F, #FFA86B, #FF6B6B);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 
                0 0 20px rgba(255, 210, 63, 0.6),
                0 4px 15px rgba(0, 0, 0, 0.3),
                inset 0 2px 10px rgba(255, 255, 255, 0.3);
            border: 3px solid rgba(255, 255, 255, 0.2);
        }

        .orb-highlight {
            position: absolute;
            top: 15%;
            left: 25%;
            width: 30%;
            height: 30%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.8), transparent);
            border-radius: 50%;
        }

        .orb-symbol {
            font-size: clamp(1.2rem, 2.5vw, 1.6rem);
            color: white;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.8);
            z-index: 1;
        }

        .lever-label {
            font-weight: 900;
            font-size: clamp(0.8rem, 1.5vw, 1rem);
            color: #FFD23F;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255, 210, 63, 0.5);
        }

        .lever-status {
            margin-top: 0.5rem;
        }

        .status-text {
            font-size: clamp(0.6rem, 1.2vw, 0.8rem);
            color: #00D4FF;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .premium-lever:hover .handle-orb {
            transform: scale(1.05);
            box-shadow: 
                0 0 30px rgba(255, 210, 63, 0.8),
                0 6px 20px rgba(0, 0, 0, 0.4),
                inset 0 2px 10px rgba(255, 255, 255, 0.4);
        }

        .premium-lever:active .handle-orb {
            transform: scale(0.95);
        }

        /* Control Sections */
        .control-section, .betting-panel, .info-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-width: 140px;
            flex: 1;
        }

        /* Betting Panel */
        .betting-panel {
            gap: 1rem;
        }

        .bet-selector, .auto-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .bet-label, .auto-label {
            font-size: clamp(0.7rem, 1.3vw, 0.85rem);
            font-weight: 700;
            color: #6C2C9C;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .premium-select {
            background: linear-gradient(145deg, 
                rgba(20, 30, 48, 0.95), 
                rgba(30, 41, 59, 0.9), 
                rgba(40, 51, 69, 0.85)
            );
            border: 3px solid;
            border-image: linear-gradient(45deg, #6C2C9C, #00D4FF, #FFD23F) 1;
            border-radius: 15px;
            color: #FFD23F;
            padding: 1rem 1.25rem;
            font-size: clamp(1rem, 1.8vw, 1.3rem);
            font-weight: 800;
            font-family: 'Orbitron', monospace;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.5),
                0 4px 12px rgba(108, 44, 156, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                inset 0 -1px 0 rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
            text-align: center;
            letter-spacing: 1.5px;
            text-shadow: 
                0 0 10px rgba(255, 210, 63, 0.5),
                0 0 20px rgba(255, 210, 63, 0.3);
            min-width: 120px;
        }

        .premium-select::before {
            content: 'ðŸ’°';
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1.2em;
            opacity: 0.8;
            animation: money-pulse 2s ease-in-out infinite;
        }

        .premium-select::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 210, 63, 0.3), 
                transparent
            );
            transition: left 0.5s;
        }

        .premium-select:hover::after {
            left: 100%;
        }

        .premium-select:hover {
            transform: translateY(-2px);
            border-image: linear-gradient(45deg, #FFD23F, #00D4FF, #6C2C9C) 1;
            box-shadow: 
                0 12px 35px rgba(0, 0, 0, 0.6),
                0 8px 20px rgba(255, 210, 63, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.3),
                inset 0 -1px 0 rgba(0, 0, 0, 0.3);
            text-shadow: 
                0 0 15px rgba(255, 210, 63, 0.8),
                0 0 25px rgba(255, 210, 63, 0.5);
        }

        .premium-select:focus {
            outline: none;
            border-image: linear-gradient(45deg, #00D4FF, #FFD23F, #6C2C9C) 1;
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.7),
                0 0 30px rgba(0, 212, 255, 0.6),
                0 0 50px rgba(0, 212, 255, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            transform: translateY(-3px);
            animation: stake-glow 1.5s ease-in-out infinite alternate;
        }

        .premium-select option {
            background: linear-gradient(145deg, rgba(20, 30, 48, 0.98), rgba(30, 41, 59, 0.95));
            color: #FFD23F;
            font-weight: 700;
            padding: 0.75rem;
            border: none;
            font-family: 'Orbitron', monospace;
            text-align: center;
        }

        .premium-select option:hover,
        .premium-select option:checked {
            background: linear-gradient(145deg, rgba(108, 44, 156, 0.8), rgba(0, 212, 255, 0.3));
            color: white;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }

        @keyframes money-pulse {
            0%, 100% { 
                transform: translateY(-50%) scale(1); 
                opacity: 0.8; 
            }
            50% { 
                transform: translateY(-50%) scale(1.2); 
                opacity: 1; 
            }
        }

        @keyframes stake-glow {
            0% { 
                text-shadow: 
                    0 0 15px rgba(255, 210, 63, 0.8),
                    0 0 25px rgba(255, 210, 63, 0.5);
            }
            100% { 
                text-shadow: 
                    0 0 20px rgba(0, 212, 255, 0.8),
                    0 0 35px rgba(0, 212, 255, 0.5);
            }
        }

        .auto-buttons {
            display: flex;
            gap: 0.5rem;
        }

        .premium-auto-btn, .premium-stop-btn {
            background: linear-gradient(145deg, rgba(108, 44, 156, 0.8), rgba(115, 190, 40, 0.8));
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            color: white;
            padding: 0.6rem 1rem;
            font-size: clamp(0.8rem, 1.4vw, 0.95rem);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 50px;
        }

        .premium-stop-btn {
            background: linear-gradient(145deg, rgba(220, 38, 127, 0.8), rgba(239, 68, 68, 0.8));
        }

        .premium-auto-btn:hover, .premium-stop-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        /* Info Panel */
        .info-panel {
            display: flex;
            align-items: center;
        }

        .premium-info-btn {
            background: linear-gradient(145deg, rgba(0, 212, 255, 0.2), rgba(108, 44, 156, 0.2));
            border: 2px solid rgba(0, 212, 255, 0.4);
            border-radius: 12px;
            color: white;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.25rem;
        }

        .btn-icon {
            font-size: clamp(1.2rem, 2vw, 1.5rem);
        }

        .btn-text {
            font-size: clamp(0.7rem, 1.2vw, 0.85rem);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .premium-info-btn:hover {
            background: linear-gradient(145deg, rgba(0, 212, 255, 0.3), rgba(108, 44, 156, 0.3));
            border-color: #00D4FF;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 212, 255, 0.3);
        }
        
        /* === RESPONSIVE BREAKPOINTS === */
        @media (max-width: 1200px) {
            .slot-machine-container {
                gap: clamp(1.5rem, 3vh, 2.5rem);
                padding: clamp(1rem, 2vh, 2rem);
            }
            
            .slot-reels-container {
                width: min(85vw, 800px);
                height: min(70vh, 700px);
                min-width: 450px;
                min-height: 450px;
                padding: clamp(1.5rem, 3vh, 2.5rem);
            }
            
            .premium-control-bar {
                gap: clamp(1.5rem, 3vw, 3rem);
                padding: clamp(1.25rem, 2.5vh, 2rem);
                width: clamp(320px, 75vw, 700px);
            }
        }
        
        @media (max-width: 1024px) {
            .slot-reels-container {
                width: min(90vw, 700px);
                height: min(65vh, 650px);
                min-width: 400px;
                min-height: 400px;
            }
            
            .slot-reel {
                min-width: 100px;
                min-height: 100px;
            }
            
            .slot-machine-container {
                /* No padding - let analytics overlay naturally */
            }
            
            .side-analytics {
                right: clamp(8px, 1.5vw, 15px);
                top: clamp(100px, 12vh, 150px);
                width: clamp(140px, 16vw, 180px);
                font-size: clamp(0.65rem, 1.2vw, 0.8rem);
            }
            
            #cheatToggleBtn {
                top: 70px !important;
            }

            .premium-control-bar {
                flex-direction: column;
                gap: clamp(1.25rem, 2.5vh, 2rem);
                padding: clamp(1.25rem, 2.5vh, 2rem);
                width: clamp(320px, 75vw, 700px);
            }
            
            .betting-panel {
                flex-direction: row;
                justify-content: space-around;
                width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .slot-reels-container {
                width: clamp(320px, 85vw, 650px);
                height: clamp(320px, 50vh, 550px);
                padding: clamp(1rem, 2vh, 1.75rem);
            }
            
            .slot-reels-grid {
                gap: clamp(0.75rem, 2vw, 1.5rem);
                padding: clamp(0.5rem, 1vw, 1rem);
            }
            
            .premium-control-bar {
                gap: clamp(1rem, 2.5vw, 1.5rem);
                padding: clamp(1rem, 2vh, 1.5rem);
                width: clamp(280px, 85vw, 600px);
            }
        }
        
        @media (max-width: 640px) {
            .slot-machine-container {
                gap: clamp(1rem, 2vh, 1.5rem);
                padding: clamp(0.75rem, 1.5vh, 1.25rem);
            }
            
            .slot-reels-container {
                width: min(95vw, 500px);
                height: min(50vh, 500px);
                min-width: 320px;
                min-height: 320px;
                padding: clamp(1rem, 2vh, 1.5rem);
            }
            
            .slot-reel {
                max-width: clamp(90px, 14vw, 120px);
                min-width: 90px;
            }
            
            .slot-symbol {
                font-size: clamp(1.75rem, 5vw, 2.5rem);
            }
            
            .premium-control-bar {
                gap: clamp(0.75rem, 2vw, 1.25rem);
                padding: clamp(0.75rem, 1.5vh, 1rem);
                flex-wrap: wrap;
                width: clamp(250px, 90vw, 500px);
            }
            
            .lever-handle {
                width: clamp(3rem, 6vw, 4rem);
                height: clamp(3rem, 6vw, 4rem);
            }

            #cheatToggleBtn {
                top: 65px !important;
                left: 8px !important;
                padding: 0.5rem;
            }
        }
        
        /* Ultra-small devices */
        @media (max-width: 480px) {
            .slot-reels-container {
                width: min(98vw, 400px);
                height: min(45vh, 400px);
                min-width: 300px;
                min-height: 300px;
                padding: clamp(0.75rem, 1.5vh, 1.25rem);
            }
            
            .slot-reels-grid {
                gap: clamp(0.75rem, 2vw, 1.25rem);
                padding: clamp(0.5rem, 1vw, 1rem);
            }
            
            .slot-reel {
                min-width: 80px;
                min-height: 80px;
            }
            
            .slot-symbol {
                font-size: clamp(2rem, 5vw, 2.5rem);
            }
        }
        
        /* Ensure perfect visibility on all devices */
        html, body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            max-width: 100vw;
        }
        
        /* Prevent any element from being cut off */
        .slot-machine-container, .slot-reels-container, .premium-control-bar {
            max-width: calc(100vw - 20px);
        }
        
        /* Premium atmosphere enhancements */
        .slots-bg {
            animation: atmosphereShift 20s ease-in-out infinite alternate;
        }
        
        @keyframes atmosphereShift {
            0% {
                background: 
                    radial-gradient(ellipse at 25% 25%, rgba(108, 44, 156, 0.2) 0%, transparent 60%),
                    radial-gradient(ellipse at 75% 75%, rgba(0, 212, 255, 0.15) 0%, transparent 60%),
                    radial-gradient(ellipse at 50% 90%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
                    linear-gradient(135deg, rgba(5, 10, 25, 1) 0%, rgba(10, 20, 40, 0.98) 50%, rgba(3, 8, 20, 1) 100%);
            }
            100% {
                background: 
                    radial-gradient(ellipse at 75% 25%, rgba(0, 212, 255, 0.18) 0%, transparent 60%),
                    radial-gradient(ellipse at 25% 75%, rgba(108, 44, 156, 0.12) 0%, transparent 60%),
                    radial-gradient(ellipse at 50% 10%, rgba(255, 215, 0, 0.06) 0%, transparent 50%),
                    linear-gradient(225deg, rgba(8, 15, 30, 1) 0%, rgba(15, 25, 45, 0.98) 50%, rgba(5, 10, 25, 1) 100%);
            }
        }
    </style>
</head>
<body class="responsive-layout slots-bg text-white font-sans">
    
    <!-- Header -->
    <header class="responsive-header bg-dt-dark/90 backdrop-blur-md border-b border-dt-cyan/20 flex-shrink-0">
        <div class="h-full w-full flex items-center justify-between px-4">
            <div class="flex items-center space-x-4 ml-16">
                <button onclick="window.location.href='lobby.html'" class="bg-dt-gray hover:bg-dt-light-gray text-white px-2 sm:px-4 py-2 rounded-lg font-semibold text-xs sm:text-sm">
                    â† Lobby
                </button>
                <div>
                    <h1 class="text-lg sm:text-xl font-bold bg-gradient-to-r from-dt-cyan via-dt-purple to-dt-green bg-clip-text text-transparent">
                        ðŸŒ Smartscape Slots
                    </h1>
                    <p class="text-xs text-dt-light-gray hidden sm:block">Dynatrace Observatory</p>
                </div>
            </div>
            
            <!-- User info and balance -->
            <div class="flex items-center space-x-4">
                <div class="bg-dt-dark/60 border border-dt-cyan/20 rounded-lg px-3 py-2">
                    <div class="flex items-center space-x-4 text-sm">
                        <div class="flex items-center space-x-2">
                            <div class="w-2 h-2 bg-dt-green rounded-full animate-pulse"></div>
                            <span class="text-dt-cyan">Agent:</span>
                            <span id="agentName" class="font-mono text-white text-xs">Loading...</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="text-dt-cyan">Balance:</span>
                            <span id="balanceDisplay" class="font-mono text-dt-yellow font-semibold">$<span id="balance">1000</span></span>
                        </div>
                        <button onclick="addFunds()" class="bg-dt-green hover:bg-dt-green/80 text-white px-3 py-1 rounded text-xs font-semibold transition-colors">
                            Deposit
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Collapsible Side Panel for Cheat Configuration -->
    <div id="cheatSidePanel" class="fixed left-0 top-0 h-full w-80 max-w-[25vw] side-panel transform -translate-x-full transition-transform duration-300 ease-in-out z-40">
        <div class="p-6 h-full overflow-y-auto">
            <!-- Panel Header -->
            <div class="flex items-center justify-between mb-6 pb-4 border-b border-dt-light-gray/20">
                <div class="flex items-center space-x-3">
                    <div class="w-3 h-3 bg-dt-purple rounded-full animate-pulse"></div>
                    <h3 class="text-lg font-bold text-dt-cyan">âš™ï¸ Configuration Lab</h3>
                </div>
                <button id="closeSidePanel" onclick="toggleCheatSidePanel()" class="text-dt-light-gray hover:text-white transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <!-- Configuration Content -->
            <div class="space-y-6">
                <!-- Demo Methods Section -->
                <div class="bg-dt-darker/60 rounded-lg p-4 border border-dt-purple/30">
                    <div class="text-center mb-4">
                        <h4 class="text-dt-purple font-bold text-md mb-1">Demo Enhancement Methods</h4>
                        <div class="text-xs text-gray-400">Laboratory environment - All methods unlocked</div>
                        <div class="text-xs text-dt-green mt-1 bg-green-900/30 px-2 py-1 rounded">âœ“ Free Testing Mode</div>
                    </div>
                    
                    <div class="space-y-3">
                        <button id="cheatReelSynchronization" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateCheat('reelSynchronization')">
                            <div class="flex items-center justify-between mb-1">
                                <span class="flex items-center space-x-2">
                                    <span>ðŸŒ</span>
                                    <span>Reel Sync Control</span>
                                </span>
                                <span class="text-xs text-green-400 bg-green-900/50 px-2 py-1 rounded">FREE</span>
                            </div>
                            <div class="text-xs text-green-400/70 ml-6">Synchronize reels for optimal symbol alignment (+45% win rate)</div>
                        </button>
                        
                        <button id="cheatSymbolWeighting" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateCheat('symbolWeighting')">
                            <div class="flex items-center justify-between mb-1">
                                <span class="flex items-center space-x-2">
                                    <span>âš–ï¸</span>
                                    <span>Symbol Frequency Boost</span>
                                </span>
                                <span class="text-xs text-green-400 bg-green-900/50 px-2 py-1 rounded">FREE</span>
                            </div>
                            <div class="text-xs text-green-400/70 ml-6">Increase high-value symbol appearance rates (+35% win rate)</div>
                        </button>
                        
                        <button id="cheatPaylineManipulation" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateCheat('paylineManipulation')">
                            <div class="flex items-center justify-between mb-1">
                                <span class="flex items-center space-x-2">
                                    <span>ðŸ“ˆ</span>
                                    <span>Payline Optimization</span>
                                </span>
                                <span class="text-xs text-green-400 bg-green-900/50 px-2 py-1 rounded">FREE</span>
                            </div>
                            <div class="text-xs text-green-400/70 ml-6">Enhance payline detection and matching (+40% win rate)</div>
                        </button>
                        
                        <button id="cheatJackpotTrigger" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateCheat('jackpotTrigger')">
                            <div class="flex items-center justify-between mb-1">
                                <span class="flex items-center space-x-2">
                                    <span>ðŸŽ°</span>
                                    <span>Jackpot Probability Boost</span>
                                </span>
                                <span class="text-xs text-green-400 bg-green-900/50 px-2 py-1 rounded">FREE</span>
                            </div>
                            <div class="text-xs text-green-400/70 ml-6">Increase chances of triggering jackpot combinations (+60% win rate)</div>
                        </button>
                        
                        <button onclick="deactivateCheat()" class="w-full bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white text-sm py-3 px-4 rounded-lg transition-all font-semibold">
                            ðŸ›‘ Reset to Baseline Configuration
                        </button>
                    </div>
                    
                    <div id="cheatStatus" class="text-center text-xs text-gray-400 mt-4 pt-4 border-t border-gray-700/50">
                        ðŸ”¬ Observatory Mode - Baseline Configuration Active
                    </div>
                </div>
                
                <!-- Status Information -->
                <div class="bg-dt-darker/40 rounded-lg p-4 border border-dt-cyan/20">
                    <h4 class="text-dt-cyan font-semibold text-sm mb-2">ðŸ“Š Current Session Status</h4>
                    <div class="space-y-2 text-xs">
                        <div class="flex justify-between">
                            <span class="text-dt-light-gray">Enhancement Active:</span>
                            <span id="sidePanelCheatStatus" class="text-dt-yellow">None</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-dt-light-gray">Performance Boost:</span>
                            <span id="sidePanelBoostLevel" class="text-dt-green">Baseline</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-dt-light-gray">Demo Duration:</span>
                            <span class="text-dt-cyan">30 seconds</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Side Panel Toggle Button -->
    <button id="cheatToggleBtn" onclick="toggleCheatSidePanel()" class="fixed left-4 top-20 config-toggle-btn text-white p-3 rounded-lg shadow-lg transition-all duration-300 z-[150]"
        <div class="flex flex-col items-center space-y-1">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
            </svg>
            <div class="text-xs font-semibold">Enable Cheats</div>
        </div>
    </button>

    <!-- Main Game Area -->
    <main class="responsive-main transition-all duration-300" id="mainGameArea">
        <div class="game-grid">
            
            <!-- Main Game Area - Full Screen -->
            <div class="main-game-area">
                <!-- Side Analytics (Floating) -->
                <div class="side-analytics">
                    <div class="metrics-panel rounded-xl p-4">
                        <div class="flex items-center space-x-2 mb-3">
                            <div class="w-2 h-2 bg-dt-green rounded-full animate-pulse"></div>
                            <h3 class="text-sm font-semibold text-dt-cyan">ðŸŽ¯ Analytics</h3>
                        </div>
                        
                        <div class="space-y-2">
                            <div class="flex justify-between items-center">
                                <span class="text-dt-light-gray text-xs">ðŸŽ² Spins</span>
                                <span class="metric-value text-sm font-bold" id="totalSpins">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-dt-light-gray text-xs">âœ… Wins</span>
                                <span class="metric-value text-sm font-bold" id="totalWins">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-dt-light-gray text-xs">ðŸ“Š Rate</span>
                                <span class="metric-value text-sm font-bold" id="winRate">0%</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-dt-light-gray text-xs">ðŸ† Best</span>
                                <span class="metric-value text-sm font-bold" id="biggestWin">ðŸ’°0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-dt-light-gray text-xs">ðŸ“ˆ Total</span>
                                <span class="metric-value text-sm font-bold" id="sessionProfit">ðŸ’°0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Win Popup Overlay (Hidden by default) -->
                <div id="jackpotBanner" class="jackpot-alert rounded-lg p-3 text-center hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 min-w-80 max-w-md">
                    <div class="text-lg sm:text-2xl font-bold text-white mb-2">ðŸŽ‰ PERFORMANCE BREAKTHROUGH! ðŸŽ‰</div>
                    <div class="text-base sm:text-lg text-white" id="jackpotAmount">ðŸ’°0</div>
                    <div class="text-xs sm:text-sm text-white/80">Full-Stack Observability Achieved!</div>
                </div>

                <!-- Central Slot Machine -->
                <div class="slot-machine-container rounded-xl relative">
                            
                            <!-- Slot Reels Container with Premium Frame -->
                            <div class="slot-reels-container">
                                <!-- Static Payline Indicator -->
                                <div class="payline-indicator"></div>
                                <div class="slot-reels-grid">
                                    <!-- Row 1: Dynatrace Observability Platform -->
                                    <div class="slot-reel" id="reel1-1">
                                        <div class="slot-symbol" id="symbol1-1">
                                            <div style="font-size: clamp(4rem, 10vw, 8rem); text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7), 2px 2px 4px rgba(0,0,0,0.8); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; filter: brightness(1.1) contrast(1.2);">ðŸŒ</div>
                                        </div>
                                    </div>
                                    <div class="slot-reel" id="reel1-2">
                                        <div class="slot-symbol" id="symbol1-2">
                                            <div style="font-size: clamp(4rem, 10vw, 8rem); text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7), 2px 2px 4px rgba(0,0,0,0.8); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; filter: brightness(1.1) contrast(1.2);">ðŸ“±</div>
                                        </div>
                                    </div>
                                    <div class="slot-reel" id="reel1-3">
                                        <div class="slot-symbol" id="symbol1-3">
                                            <div style="font-size: clamp(4rem, 10vw, 8rem); text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7), 2px 2px 4px rgba(0,0,0,0.8); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; filter: brightness(1.1) contrast(1.2);">ðŸ—„ï¸</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 2: Dynatrace Infrastructure Monitoring -->
                                    <div class="slot-reel" id="reel2-1">
                                        <div class="slot-symbol" id="symbol2-1">
                                            <div style="font-size: clamp(4rem, 10vw, 8rem); text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7), 2px 2px 4px rgba(0,0,0,0.8); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; filter: brightness(1.1) contrast(1.2);">ðŸ–¥ï¸</div>
                                        </div>
                                    </div>
                                    <div class="slot-reel" id="reel2-2">
                                        <div class="slot-symbol" id="symbol2-2">
                                            <div style="font-size: clamp(4rem, 10vw, 8rem); text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7), 2px 2px 4px rgba(0,0,0,0.8); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; filter: brightness(1.1) contrast(1.2);">â˜ï¸</div>
                                        </div>
                                    </div>
                                    <div class="slot-reel" id="reel2-3">
                                        <div class="slot-symbol" id="symbol2-3">
                                            <div style="font-size: clamp(4rem, 10vw, 8rem); text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7), 2px 2px 4px rgba(0,0,0,0.8); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; filter: brightness(1.1) contrast(1.2);">ðŸ›¡ï¸</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Row 3: Dynatrace System Analytics -->
                                    <div class="slot-reel" id="reel3-1">
                                        <div class="slot-symbol" id="symbol3-1">
                                            <div style="font-size: clamp(4rem, 10vw, 8rem); text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7), 2px 2px 4px rgba(0,0,0,0.8); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; filter: brightness(1.1) contrast(1.2);">ðŸ“Š</div>
                                        </div>
                                    </div>
                                    <div class="slot-reel" id="reel3-2">
                                        <div class="slot-symbol" id="symbol3-2">
                                            <div style="font-size: clamp(4rem, 10vw, 8rem); text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7), 2px 2px 4px rgba(0,0,0,0.8); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; filter: brightness(1.1) contrast(1.2);">âš™ï¸</div>
                                        </div>
                                    </div>
                                    <div class="slot-reel" id="reel3-3">
                                        <div class="slot-symbol" id="symbol3-3">
                                            <div style="font-size: clamp(4rem, 10vw, 8rem); text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7), 2px 2px 4px rgba(0,0,0,0.8); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', 'Twemoji Mozilla', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; filter: brightness(1.1) contrast(1.2);">ðŸ </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </div>
                            

                            
                        <!-- Result Display -->
                        <div id="resultDisplay" class="text-center mt-6 min-h-[2rem]">
                            <span class="text-dt-light-gray text-lg">ðŸŽ¯ Deploy your observability stack!</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Autospin Status Display (Hidden by default) -->
            <div id="autospinStatus" class="autospin-status-bar hidden">
                <div class="autospin-info">
                    <div class="autospin-counter">
                        <div class="counter-section">
                            <span class="counter-label">SPIN</span>
                            <span id="currentSpinCount" class="counter-value">0</span>
                            <span class="counter-total">/ <span id="totalSpinsTarget">0</span></span>
                        </div>
                        <div class="counter-section">
                            <span class="counter-label">WINS</span>
                            <span id="autospinWins" class="counter-value wins">0</span>
                        </div>
                        <div class="counter-section">
                            <span class="counter-label">PROFIT</span>
                            <span id="autospinProfit" class="counter-value profit">$0</span>
                        </div>
                    </div>
                    <div class="autospin-progress">
                        <div id="autospinProgressBar" class="progress-bar"></div>
                    </div>
                </div>
            </div>

            <!-- Premium Casino Controls Bar -->
            <div class="premium-control-bar">
                <!-- Left Section: Stakes & Auto Spin -->
                <div class="betting-panel">
                    <div class="bet-selector">
                        <div class="bet-label">STAKE</div>
                        <select id="betAmount" class="premium-select">
                            <option value="10">$10</option>
                            <option value="25">$25</option>
                            <option value="50" selected>$50</option>
                            <option value="100">$100</option>
                            <option value="250">$250</option>
                        </select>
                    </div>
                    
                    <div class="auto-controls">
                        <div class="auto-label">AUTO SPIN</div>
                        <div class="auto-buttons">
                            <button id="autoSpin5" class="premium-auto-btn">5Ã—</button>
                            <button id="autoSpin10" class="premium-auto-btn">10Ã—</button>
                            <button id="stopAuto" class="premium-stop-btn hidden">STOP</button>
                        </div>
                    </div>
                </div>

                <!-- Center Section: Spin Lever -->
                <div class="control-section">
                    <div class="premium-lever" id="pullLever">
                        <div class="lever-base">
                            <div class="lever-handle">
                                <div class="handle-orb">
                                    <div class="orb-highlight"></div>
                                    <div class="orb-symbol">âš¡</div>
                                </div>
                            </div>
                            <div class="lever-label">SPIN</div>
                        </div>
                        <div class="lever-status">
                            <div class="status-text" id="leverStatus">READY</div>
                        </div>
                    </div>
                </div>

                <!-- Right Section: Payout Matrix -->
                <div class="info-panel">
                    <button id="payoutInfoBtn" onclick="openPayoutModal()" class="premium-info-btn">
                        <div class="btn-icon">ðŸ“Š</div>
                        <div class="btn-text">PAYOUTS</div>
                    </button>
                </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        console.log('ðŸŒ Smartscape Slots Observatory loading...');
        
        // Enhanced Game state with persistence
        let balance = parseInt(localStorage.getItem('vegasBalance')) || 1000;
        let isSpinning = false;
        let autoSpinCount = 0;
        let autoSpinActive = false;
        let autoSpinTotal = 0;
        let autoSpinWins = 0;
        let autoSpinProfit = 0;
        let autoSpinStartingBalance = 0;
        
        // WebSocket initialization for lockout notifications
        const socket = io();
        let isUserLocked = false;
        
        // Enhanced session stats
        let sessionStats = JSON.parse(localStorage.getItem('vegas.sessionStats')) || {
            totalSpins: 0,
            totalWins: 0,
            biggestWin: 0,
            sessionProfit: 0
        };
        
        // User data from access control form
        let currentUser = localStorage.getItem('vegas.username') || 'Anonymous';
        // Read customer data from individual localStorage keys set by authentication form
        let customerData = {
            customerName: localStorage.getItem('vegas.customerName') || 'Demo User',
            email: localStorage.getItem('vegas.email') || 'demo@dynatrace.com',
            companyName: localStorage.getItem('vegas.companyName') || 'Dynatrace Demo',
            persona: localStorage.getItem('vegas.persona') || 'Slots Player',
            booth: localStorage.getItem('vegas.booth') || 'Demo Booth 1',
            optIn: localStorage.getItem('vegas.optIn') === 'true' || true
        };
        
        // Function to update customer data (called from access control form)
        window.updateCustomerData = function(data) {
            customerData = { ...customerData, ...data };
            // Store both individual keys and combined object for compatibility
            if (data.customerName) localStorage.setItem('vegas.customerName', data.customerName);
            if (data.email) localStorage.setItem('vegas.email', data.email);
            if (data.companyName) localStorage.setItem('vegas.companyName', data.companyName);
            if (data.persona) localStorage.setItem('vegas.persona', data.persona);
            if (data.booth) localStorage.setItem('vegas.booth', data.booth);
            if (data.optIn !== undefined) localStorage.setItem('vegas.optIn', data.optIn.toString());
            
            localStorage.setItem('vegas.customerData', JSON.stringify(customerData));
            console.log('ðŸ“ Customer data updated:', customerData);
        };
        
        // WebSocket event handlers for lockout notifications
        socket.on('connect', () => {
            console.log('ðŸ”Œ Connected to Vegas Casino WebSocket');
            const username = customerData.customerName;
            if (username) {
                socket.emit('user-login', { username });
            }
        });
        
        // Handle user lockout notification
        socket.on('user-lockout', (lockoutData) => {
            if (lockoutData.username === customerData.customerName) {
                console.log('ðŸš¨ User lockout received:', lockoutData);
                showLockoutPopup(lockoutData);
            }
        });
        
        // Check lockout status on page load
        function checkExistingLockout() {
            const username = customerData.customerName;
            if (!username || username === 'Demo User') return;
            
            fetch(`/api/admin/lockout-status/${encodeURIComponent(username)}`)
                .then(response => response.json())
                .then(data => {
                    if (data.locked) {
                        console.log('ðŸ”’ User is locked out on page load:', data);
                        data.fromStatusCheck = true; // Mark as status check to prevent double balance deduction
                        showLockoutPopup(data);
                    } else {
                        console.log('âœ… User is not locked out:', data.status);
                    }
                })
                .catch(error => {
                    console.error('âŒ Error checking lockout status:', error);
                });
        }
        
        // Show lockout popup that locks the UI
        function showLockoutPopup(lockoutData) {
            isUserLocked = true;
            
            // Update balance if provided (only for new lockouts, not when checking existing status)
            if (lockoutData.cheatData && lockoutData.cheatData.winningsConfiscated && !lockoutData.fromStatusCheck) {
                balance -= lockoutData.cheatData.winningsConfiscated;
                localStorage.setItem('vegasBalance', balance);
                updateBalanceDisplay();
            }
            
            // Create lockout modal
            const lockoutModal = document.createElement('div');
            lockoutModal.id = 'lockoutModal';
            lockoutModal.className = 'fixed inset-0 bg-red-900 bg-opacity-90 z-50 flex items-center justify-center p-4';
            lockoutModal.style.backdropFilter = 'blur(10px)';
            
            lockoutModal.innerHTML = `
                <div class="bg-gradient-to-br from-red-800 to-red-900 p-8 rounded-lg shadow-2xl max-w-md w-full text-white border-2 border-red-500">
                    <div class="text-center">
                        <div class="text-6xl mb-4">ðŸš«</div>
                        <h2 class="text-2xl font-bold mb-4 text-red-200">Account Locked</h2>
                        <p class="text-red-300 mb-6">${lockoutData.reason}</p>
                        <div class="bg-red-800 p-4 rounded mb-4">
                            <p class="text-sm"><strong>Violations:</strong> ${lockoutData.cheatData?.violations || 1}</p>
                            <p class="text-sm"><strong>Winnings Confiscated:</strong> $${lockoutData.cheatData?.winningsConfiscated || 0}</p>
                            <p class="text-sm"><strong>New Balance:</strong> $${balance}</p>
                        </div>
                        <p class="text-xs text-red-400">Contact support to unlock your account</p>
                    </div>
                </div>
            `;
            
            // Disable all game interactions
            document.body.style.pointerEvents = 'none';
            lockoutModal.style.pointerEvents = 'auto';
            
            document.body.appendChild(lockoutModal);
            
            // Stop any auto-spin
            autoSpinActive = false;
            isSpinning = false;
        }
        
        // Function to check if user is locked before any game action
        function checkUserLockout() {
            if (isUserLocked) {
                console.log('ðŸš« User is locked, preventing game action');
                return false;
            }
            return true;
        }
        
        // Weighted random symbol selection (Datadog has 5% chance, others share remaining 95%)
        function getRandomSymbol() {
            const random = Math.random() * 100;
            
            // 5% chance for Datadog (overage symbol)
            if (random < 5) {
                return symbols[symbols.length - 1]; // Datadog is last in array
            }
            
            // 95% chance for other symbols (exclude Datadog)
            const regularSymbols = symbols.slice(0, -1);
            return regularSymbols[Math.floor(Math.random() * regularSymbols.length)];
        }

        // Pure Dynatrace Observability Platform Symbols (Core 7 with Dynatrace Logo)
        const symbols = [
            // Special Dynatrace Logo (Ultra Rare)
            { 
                img: '/assets/slot-icons/dynatrace.png',
                name: 'Dynatrace', 
                value: 200, 
                rarity: 'ultra-rare', 
                color: '#6C2C9C' 
            },
            // Dynatrace Observability Platform Icons (Epic Tier)
            { 
                emoji: 'ðŸŒ', 
                name: 'Smartscape', 
                value: 100, 
                rarity: 'legendary', 
                color: '#6C2C9C' 
            },
            { 
                emoji: 'ðŸ“±', 
                name: 'Application', 
                value: 80, 
                rarity: 'epic', 
                color: '#73BE28' 
            },
            { 
                emoji: 'ðŸ—„ï¸', 
                name: 'Database', 
                value: 75, 
                rarity: 'epic', 
                color: '#FFD23F' 
            },
            // Dynatrace Infrastructure Monitoring (Rare Tier)
            { 
                emoji: 'ðŸ–¥ï¸', 
                name: 'Server', 
                value: 60, 
                rarity: 'rare', 
                color: '#00A1C9' 
            },
            { 
                emoji: 'â˜ï¸', 
                name: 'Cloud', 
                value: 55, 
                rarity: 'rare', 
                color: '#FFA86B' 
            },
            { 
                emoji: 'ðŸ›¡ï¸', 
                name: 'Security', 
                value: 50, 
                rarity: 'rare', 
                color: '#FF6B6B' 
            },
            // Special Overage Symbol (1% chance, causes fee deduction)
            { 
                img: '/assets/slot-icons/cat.png',
                name: 'Datadog', 
                value: -100, 
                rarity: 'overage', 
                color: '#632CA6',
                isOverage: true 
            }
        ];
        
        // Pure Dynatrace Observability Platform Payout Matrix
        const payoutMatrix = {
            triple: {
                // All Triples = 10x Bet Amount (7 symbols)
                'Smartscape': { multiplier: 10, name: 'TOPOLOGY MASTERY!' },
                'Application': { multiplier: 10, name: 'APM BREAKTHROUGH!' },
                'Database': { multiplier: 10, name: 'DATA OBSERVABILITY CHAMPION!' },
                'Server': { multiplier: 10, name: 'INFRASTRUCTURE MASTERY!' },
                'Cloud': { multiplier: 10, name: 'CLOUD-NATIVE SUCCESS!' },
                'Security': { multiplier: 10, name: 'SECURITY OBSERVABILITY EXPERT!' }
            },
            double: {
                // All Doubles = 5x Bet Amount (7 symbols)
                'Smartscape': { multiplier: 5, name: 'Topology Discovery!' },
                'Application': { multiplier: 5, name: 'APM Insight!' },
                'Database': { multiplier: 5, name: 'Data Connection!' },
                'Server': { multiplier: 5, name: 'Infrastructure Pair!' },
                'Cloud': { multiplier: 5, name: 'Cloud Duo!' },
                'Security': { multiplier: 5, name: 'Security Alliance!' }
            },
            special: {
                'Dynatrace_Dynatrace_Dynatrace': { multiplier: 50, name: 'DYNATRACE JACKPOT!' }        // Three Dynatrace logos = 50x
            }
        };
        
        // Cheating System
        let cheatState = {
            active: null,
            winRateBoost: 0,
            detectionRisk: 0
        };
        
        const cheatMethods = {
            reelSynchronization: { 
                name: 'Reel Sync Control', 
                winRateBoost: 45, 
                detectionRisk: 20,
                description: 'Synchronize reels for optimal symbol alignment'
            },
            symbolWeighting: { 
                name: 'Symbol Frequency Boost', 
                winRateBoost: 35, 
                detectionRisk: 15,
                description: 'Increase high-value symbol appearance rates'
            },
            paylineManipulation: { 
                name: 'Payline Optimization', 
                winRateBoost: 40, 
                detectionRisk: 25,
                description: 'Enhance payline detection and matching'
            },
            jackpotTrigger: { 
                name: 'Jackpot Probability Boost', 
                winRateBoost: 60, 
                detectionRisk: 30,
                description: 'Increase chances of triggering jackpot combinations'
            }
        };
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… Smartscape Slots Observatory initializing...');
            updateDisplay();
            updateCheatUI();
            
            // Check if user is locked out on page load
            setTimeout(checkExistingLockout, 1000); // Wait 1 second for customer data to load
            
            // Add lever click handler - KEEP THIS SIMPLE AND WORKING
            const lever = document.getElementById('pullLever');
            console.log('ðŸ” Lever element found:', lever);
            if (lever) {
                lever.addEventListener('click', pullLever);
                console.log('âœ… Lever click handler attached');
                
                // Add additional debugging
                lever.addEventListener('click', function(e) {
                    console.log('ðŸŽ¯ Lever clicked! Event:', e);
                });
                
                // Test if element is clickable
                lever.style.border = '2px solid red';
                setTimeout(() => {
                    lever.style.border = '';
                }, 2000);
            }
            
            // Add auto-spin handlers
            const autoSpin5 = document.getElementById('autoSpin5');
            const autoSpin10 = document.getElementById('autoSpin10');
            const stopAuto = document.getElementById('stopAuto');
            
            console.log('ðŸ” Auto-spin buttons found:', {autoSpin5, autoSpin10, stopAuto});
            
            if (autoSpin5) {
                autoSpin5.addEventListener('click', () => {
                    console.log('ðŸŽ¯ AutoSpin5 clicked!');
                    startAutoSpin(5);
                });
            }
            if (autoSpin10) {
                autoSpin10.addEventListener('click', () => {
                    console.log('ðŸŽ¯ AutoSpin10 clicked!');
                    startAutoSpin(10);
                });
            }
            if (stopAuto) {
                stopAuto.addEventListener('click', () => {
                    console.log('ðŸŽ¯ StopAuto clicked!');
                    stopAutoSpin();
                });
            }
            
            // Entrance animations
            if (typeof gsap !== 'undefined') {
                gsap.from('.slot-machine-container', {
                    duration: 1,
                    y: 50,
                    opacity: 0,
                    ease: "power3.out"
                });
                
                gsap.from('.metrics-panel', {
                    duration: 1,
                    x: -50,
                    opacity: 0,
                    ease: "power3.out",
                    delay: 0.2
                });
                
                gsap.from('.lever-container', {
                    duration: 1,
                    x: 50,
                    opacity: 0,
                    ease: "power3.out",
                    delay: 0.4
                });
            }
        });
        
        // Cheat System Functions
        function activateCheat(cheatType) {
            const cheat = cheatMethods[cheatType];
            if (!cheat) return;
            
            cheatState.active = cheatType;
            cheatState.winRateBoost = cheat.winRateBoost;
            cheatState.detectionRisk = cheat.detectionRisk;
            
            updateCheatUI();
            showNotification(`ðŸš€ ${cheat.name} activated! Performance boost: +${cheat.winRateBoost}%`, 'success');
            
            // Auto-deactivate after 30 seconds
            setTimeout(() => {
                if (cheatState.active === cheatType) {
                    deactivateCheat();
                }
            }, 30000);
        }
        
        function deactivateCheat() {
            if (!cheatState.active) return;
            
            cheatState.active = null;
            cheatState.winRateBoost = 0;
            updateCheatUI();
            showNotification('ðŸ”„ Configuration reset to baseline', 'info');
        }
        
        // Side panel toggle for cheat controls
        let sidePanelOpen = false;
        
        function toggleCheatSidePanel() {
            const sidePanel = document.getElementById('cheatSidePanel');
            const mainGameArea = document.getElementById('mainGameArea');
            const toggleBtn = document.getElementById('cheatToggleBtn');
            const header = document.querySelector('header');
            
            if (!sidePanel) return;
            
            sidePanelOpen = !sidePanelOpen;
            
            if (sidePanelOpen) {
                // Show side panel
                sidePanel.classList.add('side-panel-open');
                if (mainGameArea) mainGameArea.classList.add('main-content-shifted');
                if (header) header.classList.add('header-shifted');
                if (toggleBtn) toggleBtn.style.left = '324px'; // 320px panel width + 4px margin
                
                console.log('ðŸŽ¯ Configuration Lab opened');
            } else {
                // Hide side panel
                sidePanel.classList.remove('side-panel-open');
                if (mainGameArea) mainGameArea.classList.remove('main-content-shifted');
                if (header) header.classList.remove('header-shifted');
                if (toggleBtn) toggleBtn.style.left = '16px'; // Reset to original position
                
                console.log('ðŸŽ¯ Configuration Lab closed');
            }
        }
        
        function updateCheatUI() {
            const buttons = ['cheatReelSynchronization', 'cheatSymbolWeighting', 'cheatPaylineManipulation', 'cheatJackpotTrigger'];
            const types = ['reelSynchronization', 'symbolWeighting', 'paylineManipulation', 'jackpotTrigger'];
            
            buttons.forEach((buttonId, index) => {
                const button = document.getElementById(buttonId);
                if (!button) return;
                
                const cheatType = types[index];
                const cheat = cheatMethods[cheatType];
                
                if (cheatState.active === cheatType) {
                    button.classList.add('bg-red-600', 'animate-pulse');
                    button.innerHTML = `
                        <div class="flex items-center justify-between">
                            <span>ðŸ”¥ ACTIVE</span>
                            <span class="text-xs text-red-400">ACTIVE</span>
                        </div>
                        <div class="text-xs text-red-400/70 mt-1">${cheat.name} Running</div>
                    `;
                } else {
                    button.classList.remove('bg-red-600', 'animate-pulse');
                    const icons = ['ðŸŒ', 'âš–ï¸', 'ðŸ“ˆ', 'ðŸ“Š'];
                    button.innerHTML = `
                        <div class="flex items-center justify-between">
                            <span>${icons[index]} ${cheat.name.split(' ')[0]}</span>
                            <span class="text-xs text-green-400">FREE</span>
                        </div>
                        <div class="text-xs text-green-400/70 mt-1">+${cheat.winRateBoost}% performance boost</div>
                    `;
                }
            });
            
            // Update status
            const statusEl = document.getElementById('cheatStatus');
            if (statusEl) {
                if (cheatState.active) {
                    const activeCheat = cheatMethods[cheatState.active];
                    statusEl.innerHTML = `ðŸ”¥ ${activeCheat.name} Active`;
                    statusEl.className = 'text-center text-xs text-red-300 mt-3 pt-3 border-t border-gray-700/50';
                } else {
                    statusEl.innerHTML = 'ðŸŒ Observatory Mode - Baseline Configuration';
                    statusEl.className = 'text-center text-xs text-gray-400 mt-3 pt-3 border-t border-gray-700/50';
                }
            }
            
            // Update side panel status indicators
            const sidePanelCheatStatus = document.getElementById('sidePanelCheatStatus');
            const sidePanelBoostLevel = document.getElementById('sidePanelBoostLevel');
            
            if (sidePanelCheatStatus && sidePanelBoostLevel) {
                if (cheatState.active) {
                    const activeCheat = cheatMethods[cheatState.active];
                    sidePanelCheatStatus.textContent = activeCheat.name;
                    sidePanelCheatStatus.className = 'text-red-400';
                    sidePanelBoostLevel.textContent = `+${activeCheat.winRateBoost}%`;
                    sidePanelBoostLevel.className = 'text-red-400';
                } else {
                    sidePanelCheatStatus.textContent = 'None';
                    sidePanelCheatStatus.className = 'text-dt-yellow';
                    sidePanelBoostLevel.textContent = 'Baseline';
                    sidePanelBoostLevel.className = 'text-dt-green';
                }
            }
        }
        
        function startAutoSpin(count) {
            if (isSpinning) return;
            
            autoSpinCount = count;
            autoSpinTotal = count;
            autoSpinActive = true;
            autoSpinWins = 0;
            autoSpinProfit = 0;
            autoSpinStartingBalance = balance;
            
            // Show and update autospin status bar
            const statusBar = document.getElementById('autospinStatus');
            statusBar.classList.remove('hidden');
            updateAutospinDisplay();
            
            document.getElementById('autoSpin5').classList.add('hidden');
            document.getElementById('autoSpin10').classList.add('hidden');
            document.getElementById('stopAuto').classList.remove('hidden');
            
            autoSpinNext();
        }

        function autoSpinNext() {
            if (!autoSpinActive || autoSpinCount <= 0) {
                stopAutoSpin();
                return;
            }
            
            if (!isSpinning) {
                pullLever();
                autoSpinCount--;
                // Update display after spin animation completes
                setTimeout(() => {
                    if (autoSpinActive) {
                        updateAutospinDisplay();
                    }
                }, 2500); // Update just before next spin
            }
            
            setTimeout(autoSpinNext, 3000);
        }

        function stopAutoSpin() {
            autoSpinActive = false;
            autoSpinCount = 0;
            
            // Hide autospin status bar
            const statusBar = document.getElementById('autospinStatus');
            statusBar.classList.add('hidden');
            
            document.getElementById('autoSpin5').classList.remove('hidden');
            document.getElementById('autoSpin10').classList.remove('hidden');
            document.getElementById('stopAuto').classList.add('hidden');
        }

        function updateAutospinDisplay() {
            if (!autoSpinActive) return;
            
            const currentSpin = autoSpinTotal - autoSpinCount;
            const progress = (currentSpin / autoSpinTotal) * 100;
            autoSpinProfit = balance - autoSpinStartingBalance;
            
            document.getElementById('currentSpinCount').textContent = currentSpin;
            document.getElementById('totalSpinsTarget').textContent = autoSpinTotal;
            document.getElementById('autospinWins').textContent = autoSpinWins;
            document.getElementById('autospinProfit').textContent = autoSpinProfit >= 0 ? `+$${autoSpinProfit}` : `-$${Math.abs(autoSpinProfit)}`;
            document.getElementById('autospinProgressBar').style.width = `${progress}%`;
            
            // Update profit color based on positive/negative
            const profitElement = document.getElementById('autospinProfit');
            if (autoSpinProfit > 0) {
                profitElement.className = 'counter-value profit';
                profitElement.style.color = '#22c55e';
                profitElement.style.textShadow = '0 0 10px rgba(34, 197, 94, 0.6)';
            } else if (autoSpinProfit < 0) {
                profitElement.className = 'counter-value profit';
                profitElement.style.color = '#ef4444';
                profitElement.style.textShadow = '0 0 10px rgba(239, 68, 68, 0.6)';
            } else {
                profitElement.className = 'counter-value profit';
                profitElement.style.color = '#ffd23f';
                profitElement.style.textShadow = '0 0 10px rgba(255, 210, 63, 0.6)';
            }
        }
        
        function pullLever() {
            if (isSpinning) return;
            
            // Check if user is locked
            if (!checkUserLockout()) {
                return;
            }
            
            console.log('ðŸš€ Deploy stack initiated!');
            const betAmount = parseInt(document.getElementById('betAmount').value);
            
            if (betAmount > balance) {
                showMessage('ðŸ’³ Insufficient Dynatrace Credits!', 'error');
                return;
            }
            
            // Deduct bet
            balance -= betAmount;
            isSpinning = true;
            
            updateDisplay();
            showMessage('ðŸš€ Deploying services...', 'info');
            
            // Update status elements if they exist
            const leverStatus = document.getElementById('leverStatus');
            if (leverStatus) leverStatus.textContent = 'Deploying...';
            
            console.log('ðŸŽ° Starting spin with bet amount:', betAmount);
            
            // Start spinning animation
            spin(betAmount);
        }
        
        function spin(betAmount) {
            // Check if user is locked
            if (!checkUserLockout()) {
                return;
            }
            
            console.log('ðŸŽ° Starting spin animation with bet:', betAmount);
            
            // DEBUG: Log container dimensions BEFORE spinning
            const container = document.querySelector('.slot-reels-container');
            const containerRect = container.getBoundingClientRect();
            console.log('ðŸ” BEFORE spin - Container dimensions:', {
                width: containerRect.width,
                height: containerRect.height,
                left: containerRect.left,
                top: containerRect.top
            });
            
            // Hide payline indicator at start of spin
            const paylineIndicator = document.querySelector('.payline-indicator');
            if (paylineIndicator) {
                paylineIndicator.classList.remove('winning');
            }
            
            const reels = document.querySelectorAll('.slot-reel');
            const symbolElements = document.querySelectorAll('.slot-symbol');
            
            console.log('ðŸŽ° Found', reels.length, 'reels and', symbolElements.length, 'symbols');
            
            // Add spinning class
            reels.forEach((reel, index) => {
                reel.classList.add('spinning');
                console.log(`ðŸŽ° Added spinning class to reel ${index + 1}`);
            });
            
            // DEBUG: Log container dimensions AFTER adding spinning class
            setTimeout(() => {
                const containerRectAfter = container.getBoundingClientRect();
                console.log('ðŸ” AFTER spinning class added - Container dimensions:', {
                    width: containerRectAfter.width,
                    height: containerRectAfter.height,
                    left: containerRectAfter.left,
                    top: containerRectAfter.top,
                    widthChange: containerRectAfter.width - containerRect.width,
                    heightChange: containerRectAfter.height - containerRect.height
                });
            }, 100);
            
            let spinCounter = 0;
            const maxSpins = 30;

            console.log('ðŸŽ° Starting spin interval with maxSpins:', maxSpins);

            // Fire a backend spin request so RUM/APM (Dynatrace) can capture it.
            // We don't block the UI; we'll use the server response when the animation ends.
            window.__lastSpinResponse = null;
            fetch('/api/slots/spin', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    Username: currentUser,
                    BetAmount: betAmount,
                    CheatActive: cheatState.active ? true : false,
                    CheatType: cheatState.active || null,
                    // Use customer data from access control form
                    CustomerName: customerData.customerName,
                    Email: customerData.email,
                    CompanyName: customerData.companyName,
                    Persona: customerData.persona,
                    Booth: customerData.booth,
                    OptIn: customerData.optIn,
                    // Session tracking
                    CorrelationId: 'slot-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),
                    DetectionRisk: cheatState.active ? 25 : 0,
                    CheatActivationsToday: cheatState.active ? 1 : 0,
                    CheatDetails: cheatState.active ? cheatMethods[cheatState.active] : null
                })
            }).then(r => r.json())
            .then(data => {
                window.__lastSpinResponse = data;
                console.log('ðŸŽ° Received server spin response:', data);
                console.log('ðŸŽ° Response keys:', Object.keys(data));
                console.log('ðŸŽ° Customer data:', {
                    CustomerName: data.CustomerName,
                    Email: data.Email,
                    CompanyName: data.CompanyName,
                    Persona: data.Persona,
                    CorrelationId: data.CorrelationId,
                    JackpotFlag: data.JackpotFlag,
                    CheatDetails: data.CheatDetails
                });
            }).catch(err => {
                console.error('ðŸŽ° Spin request failed:', err);
            });

            const spinInterval = setInterval(() => {
                // Update each symbol with random symbols during spin
                symbolElements.forEach((symbolEl, index) => {
                    const randomSymbol = getRandomSymbol();
                    
                    if (randomSymbol.html) {
                        symbolEl.innerHTML = randomSymbol.html;
                    } else if (randomSymbol.img) {
                        symbolEl.innerHTML = `<img src="${randomSymbol.img}" alt="${randomSymbol.name}" style="width: 60px; height: 60px;"/>`;
                    } else if (randomSymbol.emoji) {
                        symbolEl.innerHTML = `<div style="font-size: 3rem; text-shadow: 0 0 10px rgba(255,255,255,0.5); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;">${randomSymbol.emoji}</div>`;
                    }
                });

                spinCounter++;

                if (spinCounter >= maxSpins) {
                    console.log(`ðŸŽ° Spin counter reached ${spinCounter}, clearing interval`);
                    clearInterval(spinInterval);
                    // Pass server response if available so we use server-calculated result
                    stopSpin(betAmount, window.__lastSpinResponse);
                }
            }, 100);
        }
        
        function stopSpin(betAmount, serverResponse = null) {
            console.log('ðŸŽ° stopSpin called with betAmount:', betAmount, 'serverResponse:', serverResponse);
            
            const reels = document.querySelectorAll('.slot-reel');
            const symbolElements = document.querySelectorAll('.slot-symbol');
            
            console.log('ðŸŽ° Removing spinning class from', reels.length, 'reels');
            
            // DEBUG: Log container dimensions BEFORE removing spinning class
            const container = document.querySelector('.slot-reels-container');
            const containerRectBefore = container.getBoundingClientRect();
            console.log('ðŸ” BEFORE removing spinning class - Container dimensions:', {
                width: containerRectBefore.width,
                height: containerRectBefore.height
            });
            
            // Remove spinning class
            reels.forEach((reel, index) => {
                reel.classList.remove('spinning');
                console.log(`ðŸŽ° Removed spinning class from reel ${index + 1}`);
            });
            
            // DEBUG: Log container dimensions AFTER removing spinning class
            setTimeout(() => {
                const containerRectAfter = container.getBoundingClientRect();
                console.log('ðŸ” AFTER removing spinning class - Container dimensions:', {
                    width: containerRectAfter.width,
                    height: containerRectAfter.height,
                    widthChange: containerRectAfter.width - containerRectBefore.width,
                    heightChange: containerRectAfter.height - containerRectBefore.height
                });
            }, 100);

            // If server returned a result, use it (preferred) so traces align with backend
            if (serverResponse && Array.isArray(serverResponse.result)) {
                const finalSymbols = [];
                console.log('ðŸŽ° Using server-provided result:', serverResponse.result);
                console.log('ðŸŽ° SERVER WIN DATA:', {
                    WinFlag: serverResponse.WinFlag,
                    WinningAmount: serverResponse.WinningAmount,
                    winAmount: serverResponse.winAmount,
                    win: serverResponse.win,
                    description: serverResponse.description
                });

                // Handle 3x3 grid (9 symbols) - use server result and randomize remaining
                const gridSize = 9;
                for (let i = 0; i < gridSize; i++) {
                    let symbolObj;
                    
                    // Use server result for first 3 positions (center row for compatibility)
                    if (i >= 3 && i <= 5 && serverResponse.result[i - 3]) {
                        const name = serverResponse.result[i - 3];
                        symbolObj = symbols.find(s => s.name && s.name.toLowerCase() === name.toLowerCase());
                        
                        // Enhanced symbol matching - map server names to frontend symbols
                        if (!symbolObj) {
                            const symbolMap = {
                                'dynatrace': symbols.find(s => s.name === 'Dynatrace') || symbols[0],
                                'smartscape': symbols.find(s => s.name === 'Smartscape') || symbols[1],
                                'application': symbols.find(s => s.name === 'Application') || symbols[2],
                                'database': symbols.find(s => s.name === 'Database') || symbols[3],
                                'server': symbols.find(s => s.name === 'Server') || symbols[4],
                                'cloud': symbols.find(s => s.name === 'Cloud') || symbols[5],
                                'shield': symbols.find(s => s.name === 'Security') || symbols[6],  // Server uses "shield", client uses "Security"
                                'security': symbols.find(s => s.name === 'Security') || symbols[6],
                                'datadog': symbols.find(s => s.name === 'Datadog') || symbols[7],
                                // Fallback mappings for any other server symbols
                                'analytics': symbols.find(s => s.name === 'Smartscape') || symbols[1],
                                'services': symbols.find(s => s.name === 'Application') || symbols[2],
                                'host': symbols.find(s => s.name === 'Server') || symbols[4],
                                'process': symbols.find(s => s.name === 'Application') || symbols[2],
                                'cpu': symbols.find(s => s.name === 'Server') || symbols[4],
                                'memory': symbols.find(s => s.name === 'Server') || symbols[4],
                                'network': symbols.find(s => s.name === 'Cloud') || symbols[5]
                            };
                            symbolObj = symbolMap[name.toLowerCase()] || symbols[1]; // Default to Smartscape
                        }
                    } else {
                        // Random symbol for other positions
                        symbolObj = getRandomSymbol();
                    }
                    
                    finalSymbols.push(symbolObj);

                    const symbolEl = symbolElements[i];
                    if (symbolEl && symbolObj) {
                        if (symbolObj.html) {
                            symbolEl.innerHTML = symbolObj.html;
                        } else if (symbolObj.img) {
                            symbolEl.innerHTML = `<img src="${symbolObj.img}" alt="${symbolObj.name}" style="width: 60px; height: 60px;"/>`;
                        } else if (symbolObj.emoji) {
                            symbolEl.innerHTML = `<div style="font-size: 3rem; text-shadow: 0 0 10px rgba(255,255,255,0.5); font-family: 'Segoe UI Emoji', 'Apple Color Emoji', 'Noto Color Emoji', sans-serif; line-height: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%;">${symbolObj.emoji}</div>`;
                        }
                    }
                }

                // DISABLED: Apply server-declared win state - use client logic instead
                // let winAmount = serverResponse.WinningAmount || serverResponse.winAmount || 0;
                // const win = serverResponse.WinFlag === 1 || serverResponse.win || false;
                // const winType = serverResponse.winType || (win ? 'win' : '');
                // let description = serverResponse.description || (win ? 'Winner!' : '');
                
                // Cheat affects win rate, not payout amounts - server handles this
                if (cheatState.active) {
                    console.log(`ðŸŽ¯ Cheat active: ${cheatState.active} - affects win probability, not payout amount`);
                }
                
                // Update balance from server response if provided
                if (serverResponse.Balance !== undefined) {
                    balance = serverResponse.Balance;
                }
                
                // Skip server win logic - use client-side checkWin instead
                console.log('ðŸŽ° Calling checkWin with server symbols...');
                const winAmount = checkWin(finalSymbols, betAmount);
                console.log('ðŸŽ° checkWin returned winAmount:', winAmount);

                // Add to balance if it's a win
                if (winAmount > 0) {
                    balance += winAmount;  // Only add win amount, bet was already deducted in pullLever()
                }
                
                updateDisplay();
                isSpinning = false;

                let leverStatus = document.getElementById('leverStatus');
                if (leverStatus) leverStatus.textContent = 'Ready';

                console.log('ðŸŽ° stopSpin completed using server symbols with client win logic');
                return;
            }

            // Fallback: no server response â€” use existing client-side random generation for 3x3 grid
            // Generate final result for all 9 positions
            const finalSymbols = [];
            console.log('ðŸŽ° Generating final symbols for 3x3 grid (client fallback)...');

            for (let i = 0; i < 9; i++) {
                const randomSymbol = getRandomSymbol();
                finalSymbols.push(randomSymbol);

                console.log(`ðŸŽ° Final symbol ${i + 1}:`, randomSymbol.name);

                const symbolEl = symbolElements[i];
                if (symbolEl && randomSymbol) {
                    if (randomSymbol.html) {
                        symbolEl.innerHTML = randomSymbol.html;
                    } else if (randomSymbol.img) {
                        symbolEl.innerHTML = `<img src="${randomSymbol.img}" alt="${randomSymbol.name}" style="width: 60px; height: 60px;"/>`;
                    } else if (randomSymbol.emoji) {
                        symbolEl.innerHTML = `<div style="font-size: 3rem; text-shadow: 0 0 10px rgba(255,255,255,0.5);">${randomSymbol.emoji}</div>`;
                    }
                }
            }

            console.log('ðŸŽ° Final symbols generated:', finalSymbols.map(s => s.name));

            // Check for wins using existing client logic
            console.log('ðŸŽ° Calling checkWin...');
            checkWin(finalSymbols, betAmount);

            isSpinning = false;
            console.log('ðŸŽ° Set isSpinning to false (fallback)');

            // Update status elements if they exist
            const leverStatus = document.getElementById('leverStatus');
            if (leverStatus) {
                leverStatus.textContent = 'Ready';
                console.log('ðŸŽ° Updated lever status to Ready (fallback)');
            }

            console.log('ðŸŽ° stopSpin completed (fallback)');
        }
        
        function checkWin(finalSymbols, betAmount) {
            console.log('ðŸŽ° Checking win:', finalSymbols);
            
            // Middle row (win line): positions 3, 4, 5 in the 3x3 grid
            const symbol1 = finalSymbols[3];
            const symbol2 = finalSymbols[4];
            const symbol3 = finalSymbols[5];
            
            // Check for Datadog triple overage (all 3 middle positions must be Datadog)
            if (symbol1 && symbol1.isOverage && 
                symbol2 && symbol2.isOverage && 
                symbol3 && symbol3.isOverage) {
                console.log('ðŸš¨ TRIPLE DATADOG OVERAGE DETECTED: All 3 payline positions have Datadog!');
                balance -= 100; // Deduct $100 for overages
                showOverageBanner();
                updateDisplay();
                return 0; // No regular win payout
            }
            
            console.log('ðŸŽ° PAYLINE SYMBOLS:', {
                position1: symbol1?.name || 'undefined',
                position2: symbol2?.name || 'undefined', 
                position3: symbol3?.name || 'undefined'
            });
            
            let winAmount = 0;
            let winMessage = '';
            let winType = '';
            
            // Check for special combinations first
            const sortedNames = [symbol1.name, symbol2.name, symbol3.name].sort().join('_');
            for (const [combo, payout] of Object.entries(payoutMatrix.special)) {
                if (sortedNames === combo.replace(/_/g, '_')) {
                    winAmount = betAmount * payout.multiplier;
                    winMessage = `ðŸ’Ž ${payout.name} $${winAmount}`;
                    winType = 'special';
                    break;
                }
            }
            
            // Check for triple matches
            if (!winAmount && symbol1.name === symbol2.name && symbol2.name === symbol3.name) {
                const payout = payoutMatrix.triple[symbol1.name];
                if (payout) {
                    winAmount = betAmount * payout.multiplier;
                    winMessage = `ðŸŽŠ ${payout.name} $${winAmount}`;
                    winType = 'triple';
                }
            }
            
            // Check for double matches - only first two reels count
            console.log('ðŸŽ° Double check:', symbol1.name, '===', symbol2.name, '?', symbol1.name === symbol2.name);
            if (!winAmount && symbol1.name === symbol2.name) {
                const payout = payoutMatrix.double[symbol1.name];
                console.log('ðŸŽ° Found double payout:', payout);
                if (payout) {
                    winAmount = betAmount * payout.multiplier;
                    winMessage = `âœ¨ ${payout.name} $${winAmount}`;
                    winType = 'double';
                    console.log('ðŸŽ° DOUBLE WIN!', winMessage);
                }
            }
            
            // Cheat affects win rate, not payout amounts - no boost applied to winAmount
            if (cheatState.active) {
                console.log(`ðŸŽ¯ Cheat active: ${cheatState.active} - better win odds used`);
                winMessage += ` (ðŸŽ¯ LUCKY!)`;
            }
            
            // Update game state
            sessionStats.totalSpins++;
            
            if (winAmount > 0) {
                balance += winAmount;
                sessionStats.totalWins++;
                if (winAmount > sessionStats.biggestWin) {
                    sessionStats.biggestWin = winAmount;
                }
                
                // Show enhanced win effects
                if (winAmount >= 1000) {
                    showJackpotBanner(winAmount, winMessage);
                    createCelebrationEffect();
                } else {
                    showMessage(winMessage, 'success');
                }
                
                // Show payline indicator for wins
                const paylineIndicator = document.querySelector('.payline-indicator');
                if (paylineIndicator) {
                    paylineIndicator.classList.add('winning');
                }
                
                // Add winning animation based on win type - ONLY to middle row (payline)
                const middleRowReels = ['reel2-1', 'reel2-2', 'reel2-3'];
                middleRowReels.forEach(reelId => {
                    const reel = document.getElementById(reelId);
                    if (reel) {
                        reel.classList.add('winning-reel');
                        if (winType === 'special' || winAmount >= 1000) {
                            reel.classList.add('mega-win');
                        }
                    }
                });
                
                setTimeout(() => {
                    middleRowReels.forEach(reelId => {
                        const reel = document.getElementById(reelId);
                        if (reel) {
                            reel.classList.remove('winning-reel', 'mega-win');
                        }
                    });
                    // Hide payline indicator after win animation
                    if (paylineIndicator) {
                        paylineIndicator.classList.remove('winning');
                    }
                }, 3000);
                
                } else {
                    showMessage('ðŸ”„ Stack deployment complete. Optimize for better performance!', 'info');
                    // Hide payline indicator for no wins
                    const paylineIndicator = document.querySelector('.payline-indicator');
                    if (paylineIndicator) {
                        paylineIndicator.classList.remove('winning');
                    }
                }            // Update session profit
            sessionStats.sessionProfit += (winAmount - betAmount);
            
            // Save session stats
            localStorage.setItem('vegas.sessionStats', JSON.stringify(sessionStats));
            localStorage.setItem('vegasBalance', String(balance));
            
            updateDisplay();
        }
        
        function showJackpotBanner(amount, message) {
            const banner = document.getElementById('jackpotBanner');
            const amountEl = document.getElementById('jackpotAmount');
            
            if (banner && amountEl) {
                banner.classList.remove('hidden');
                amountEl.innerHTML = `
                    <div class="text-3xl font-bold text-white mb-2">${message}</div>
                    <div class="text-2xl text-white">ðŸ’°${amount.toLocaleString()} Dynatrace Credits</div>
                `;
                
                setTimeout(() => {
                    banner.classList.add('hidden');
                }, 5000);
            }
        }
        
        function createCelebrationEffect() {
            // Create floating celebration particles
            for (let i = 0; i < 15; i++) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: fixed;
                    width: 8px;
                    height: 8px;
                    background: linear-gradient(45deg, #FFD23F, #73BE28, #00D4FF);
                    border-radius: 50%;
                    pointer-events: none;
                    z-index: 1000;
                    left: ${Math.random() * 100}vw;
                    top: 100vh;
                    animation: celebrate 3s ease-out forwards;
                `;
                
                document.body.appendChild(particle);
                
                setTimeout(() => {
                    if (particle.parentNode) {
                        particle.parentNode.removeChild(particle);
                    }
                }, 3000);
            }
        }
        
        function showOverageBanner() {
            // Create overage banner similar to jackpot banner with button close
            const banner = document.createElement('div');
            banner.id = 'overageBanner';
            banner.innerHTML = `
                <div class="fixed top-0 left-0 w-full h-full bg-black bg-opacity-75 flex items-center justify-center z-50">
                    <div class="bg-gradient-to-br from-orange-500 to-red-600 border-4 border-yellow-400 rounded-3xl p-10 text-center shadow-2xl max-w-lg mx-4">
                        <div class="flex items-center justify-center mb-4"><img src="/assets/slot-icons/cat.png" alt="Datadog" class="w-16 h-16 mr-3"/><div class="text-4xl">ðŸ’¸</div></div>
                        <div class="text-3xl font-bold text-white mb-4">Legacy Monitoring Costs</div>
                        <div class="text-lg text-orange-100 mb-4">You have hidden costs from your legacy monitoring platform.</div>
                        <div class="text-lg text-orange-100 mb-6">You have been charged overages.</div>
                        <div class="text-2xl font-bold text-yellow-300 mb-6">$100 deducted from balance</div>
                        <button onclick="document.getElementById('overageBanner').remove()" 
                                class="bg-white text-orange-600 font-bold py-3 px-8 rounded-full text-xl shadow-lg hover:bg-orange-50 transition-colors duration-200">
                            Continue
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(banner);
        }
        
        function showMessage(message, type) {
            const messageEl = document.getElementById('winMessage');
            messageEl.innerHTML = `<span class="text-lg font-semibold ${
                type === 'success' ? 'text-dt-green' : 
                type === 'error' ? 'text-red-400' : 'text-dt-cyan'
            }">${message}</span>`;
        }
        
        function updateDisplay() {
            document.getElementById('balance').textContent = balance;
            document.getElementById('totalSpins').textContent = sessionStats.totalSpins;
            document.getElementById('totalWins').textContent = sessionStats.totalWins;
            document.getElementById('biggestWin').textContent = `ðŸ’°${sessionStats.biggestWin}`;
            document.getElementById('sessionProfit').textContent = `ðŸ’°${sessionStats.sessionProfit}`;
            
            // Update win rate
            const winRateEl = document.getElementById('winRate');
            if (winRateEl) {
                const winRate = sessionStats.totalSpins > 0 ? 
                    ((sessionStats.totalWins / sessionStats.totalSpins) * 100).toFixed(1) : '0.0';
                winRateEl.textContent = `${winRate}%`;
            }
        }
        
        function showMessage(message, type) {
            const messageEl = document.getElementById('resultDisplay');
            if (messageEl) {
                messageEl.innerHTML = `<span class="text-lg font-semibold ${
                    type === 'success' ? 'text-dt-green' : 
                    type === 'error' ? 'text-red-400' : 'text-dt-cyan'
                }">${message}</span>`;
            }
        }
        
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg border backdrop-blur-md ${
                type === 'success' ? 'bg-dt-green/90 border-dt-green text-white' :
                type === 'error' ? 'bg-red-500/90 border-red-500 text-white' :
                'bg-dt-blue/90 border-dt-blue text-white'
            }`;
            
            notification.innerHTML = `
                <div class="flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                    </svg>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            if (typeof gsap !== 'undefined') {
                gsap.from(notification, {
                    duration: 0.3,
                    x: 100,
                    opacity: 0,
                    ease: "power2.out"
                });
                
                setTimeout(() => {
                    gsap.to(notification, {
                        duration: 0.3,
                        x: 100,
                        opacity: 0,
                        ease: "power2.in",
                        onComplete: () => notification.remove()
                    });
                }, 4000);
            } else {
                setTimeout(() => notification.remove(), 4000);
            }
        }
        
        // Enhanced Payout Modal Functions
        function openPayoutModal() {
            // Create modal dynamically if it doesn't exist
            let modal = document.getElementById('payoutModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'payoutModal';
                modal.className = 'fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4';
                modal.innerHTML = createPayoutModalContent();
                document.body.appendChild(modal);
                
                // Add click outside to close
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closePayoutModal();
                    }
                });
            }
            
            // Ensure modal is visible and reset any GSAP transforms
            modal.classList.remove('hidden');
            modal.style.display = '';  // Remove any inline display styling
            
            // Reset any previous transforms and add entrance animation
            if (typeof gsap !== 'undefined') {
                const modalContent = modal.querySelector('.bg-dt-dark');
                if (modalContent) {
                    // Reset transforms first
                    gsap.set(modalContent, { scale: 1, opacity: 1 });
                    // Then apply entrance animation
                    gsap.fromTo(modalContent, 
                        { scale: 0.9, opacity: 0 },
                        { duration: 0.3, scale: 1, opacity: 1, ease: "power2.out" }
                    );
                }
            }
        }
        
        function createPayoutModalContent() {
            // Helper function to get symbol display
            function getSymbolDisplay(symbolName) {
                const symbol = symbols.find(s => s.name === symbolName);
                if (!symbol) return 'â“';
                
                if (symbol.img) {
                    return `<img src="${symbol.img}" alt="${symbol.name}" class="w-6 h-6 inline-block"/>`;
                } else {
                    return `<span style="color: ${symbol.color}">${symbol.emoji}</span>`;
                }
            }
            
            return `
                <div class="bg-dt-dark rounded-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto shadow-2xl border border-dt-cyan/30">
                    <!-- Header -->
                    <div class="sticky top-0 bg-dt-dark rounded-t-xl p-6 border-b border-dt-light-gray/20 backdrop-blur-md">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-gradient-to-br from-dt-yellow to-dt-orange rounded-full flex items-center justify-center">
                                    <span class="text-xl">ðŸ’°</span>
                                </div>
                                <div>
                                    <h2 class="text-2xl font-bold text-dt-yellow">Quantum Slots Payouts</h2>
                                    <p class="text-sm text-dt-light-gray">Complete payout matrix and winning combinations</p>
                                </div>
                            </div>
                            <button onclick="closePayoutModal()" class="text-dt-light-gray hover:text-white transition-colors p-2 hover:bg-dt-gray/50 rounded-lg">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <!-- Clean Payout Overview -->
                        <div class="space-y-6">
                            <!-- Basic Win Rules -->
                            <div class="metrics-panel rounded-lg p-4">
                                <h3 class="text-xl font-bold text-dt-yellow mb-4 text-center">ðŸŽ° Quantum Slots Payouts</h3>
                                
                                <div class="grid md:grid-cols-3 gap-4 mb-4">
                                    <!-- Triple Matches -->
                                    <div class="text-center p-3 bg-dt-yellow/10 rounded-lg">
                                        <div class="text-3xl mb-2">ðŸŒðŸŒðŸŒ</div>
                                        <div class="font-bold text-dt-yellow text-lg">10x</div>
                                        <div class="text-xs text-dt-light-gray">Any Triple Match</div>
                                    </div>
                                    
                                    <!-- Double Matches -->
                                    <div class="text-center p-3 bg-dt-cyan/10 rounded-lg">
                                        <div class="text-3xl mb-2">ðŸ“±ðŸ“±âž•</div>
                                        <div class="font-bold text-dt-cyan text-lg">5x</div>
                                        <div class="text-xs text-dt-light-gray">First Two Match</div>
                                    </div>
                                    
                                    <!-- Special Combos -->
                                    <div class="text-center p-3 bg-dt-purple/10 rounded-lg">
                                        <div class="text-2xl mb-2"><img src="/assets/slot-icons/dynatrace.png" alt="Dynatrace" class="inline-block w-8 h-8 mx-1"/><img src="/assets/slot-icons/dynatrace.png" alt="Dynatrace" class="inline-block w-8 h-8 mx-1"/><img src="/assets/slot-icons/dynatrace.png" alt="Dynatrace" class="inline-block w-8 h-8 mx-1"/></div>
                                        <div class="font-bold text-dt-purple text-lg">50x</div>
                                        <div class="text-xs text-dt-light-gray">Dynatrace Jackpot</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Special Combinations Only -->
                            <div class="metrics-panel rounded-lg p-4">
                                <h3 class="text-lg font-semibold text-dt-purple mb-3 flex items-center justify-center">
                                    <span class="w-6 h-6 bg-dt-purple rounded-full flex items-center justify-center text-xs mr-2">ðŸ’Ž</span>
                                    High-Value Special Combinations
                                </h3>
                                <div class="space-y-3">
                                    ${Object.entries(payoutMatrix.special).map(([combo, payout]) => {
                                        const symbols = combo.split('_');
                                        const displaySymbols = symbols.length === 2 ? 
                                            `â“ ${getSymbolDisplay(symbols[0])} ${getSymbolDisplay(symbols[1])}` :
                                            `${getSymbolDisplay(symbols[0])} ${getSymbolDisplay(symbols[1])} ${getSymbolDisplay(symbols[2])}`;
                                        return `
                                            <div class="flex justify-between items-center py-2 px-3 bg-gradient-to-r from-dt-purple/10 to-dt-purple/5 rounded-lg border border-dt-purple/20">
                                                <div class="flex items-center space-x-2">
                                                    <div class="text-lg">${displaySymbols}</div>
                                                </div>
                                                <div class="text-right">
                                                    <div class="font-bold text-dt-purple text-lg">${payout.multiplier}x</div>
                                                    <div class="text-xs text-dt-green font-medium">${payout.name}</div>
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                            </div>
                            
                            <!-- Game Info & Tips -->
                            <div class="metrics-panel rounded-lg p-4">
                                <div class="grid md:grid-cols-2 gap-4">
                                    <!-- Win Statistics -->
                                    <div>
                                        <h4 class="text-sm font-semibold text-dt-green mb-3">ðŸ“Š Win Statistics</h4>
                                        <div class="space-y-2 text-sm">
                                            <div class="flex justify-between">
                                                <span class="text-dt-light-gray">Base Win Rate:</span>
                                                <span class="text-dt-cyan font-medium">~25%</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-dt-light-gray">With Cheats:</span>
                                                <span class="text-dt-yellow font-medium">~60%</span>
                                            </div>
                                            <div class="flex justify-between">
                                                <span class="text-dt-light-gray">Special Combos:</span>
                                                <span class="text-dt-purple font-medium">~0.5%</span>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Pro Tips -->
                                    <div>
                                        <h4 class="text-sm font-semibold text-dt-orange mb-3">ðŸ’¡ Pro Tips</h4>
                                        <div class="space-y-2 text-xs text-dt-light-gray">
                                            <div class="flex items-start space-x-2">
                                                <span class="text-dt-yellow">â€¢</span>
                                                <span>Doubles only count first two reels</span>
                                            </div>
                                            <div class="flex items-start space-x-2">
                                                <span class="text-dt-purple">â€¢</span>
                                                <span>Three Dynatrace logos = 50x jackpot</span>
                                            </div>
                                            <div class="flex items-start space-x-2">
                                                <span class="text-dt-green">â€¢</span>
                                                <span>Golden payline shows winning combinations</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function closePayoutModal() {
            const modal = document.getElementById('payoutModal');
            if (modal) {
                if (typeof gsap !== 'undefined') {
                    const modalContent = modal.querySelector('.bg-dt-dark');
                    if (modalContent) {
                        gsap.to(modalContent, {
                            duration: 0.2,
                            scale: 0.9,
                            opacity: 0,
                            ease: "power2.in",
                            onComplete: () => {
                                modal.classList.add('hidden');
                                // Reset transforms for next opening
                                gsap.set(modalContent, { scale: 1, opacity: 1 });
                            }
                        });
                    } else {
                        modal.classList.add('hidden');
                    }
                } else {
                    modal.classList.add('hidden');
                    modal.style.display = 'none';
                }
            }
        }

        // Add funds function for deposit button
        function addFunds() {
            const currentBalance = parseInt(localStorage.getItem('vegasBalance') || '1000');
            const newBalance = currentBalance + 1000;
            localStorage.setItem('vegasBalance', String(newBalance));
            
            updateBalanceDisplay();
            console.log(`ðŸ’° Added $1000 credits! New balance: $${newBalance}`);
        }

        // Update balance display
        function updateBalanceDisplay() {
            const balance = localStorage.getItem('vegasBalance') || '1000';
            const balanceElement = document.getElementById('balance');
            if (balanceElement) {
                balanceElement.textContent = balance;
            }
        }

        // Initialize user info
        document.addEventListener('DOMContentLoaded', function() {
            const username = localStorage.getItem('vegas.username') || localStorage.getItem('vegasUser') || 'Agent';
            const agentNameElement = document.getElementById('agentName');
            if (agentNameElement) {
                agentNameElement.textContent = username;
            }
            updateBalanceDisplay();
        });
        
        console.log('âœ… Smartscape Slots Observatory ready!');
    </script>
</body>
</html>