<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynatrace Vegas Casino - SPA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Socket.IO for real-time lockout notifications -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dt-purple': '#6C2C9C',
                        'dt-blue': '#1496FF', 
                        'dt-cyan': '#00D4FF',
                        'dt-green': '#73BE28',
                        'dt-yellow': '#FFD23F',
                        'dt-orange': '#FFA86B',
                        'dt-gray': '#2A2A2A',
                        'dt-dark': '#151515',
                        'dt-light-gray': '#B8B8B8'
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: linear-gradient(135deg, #0A0A0A 0%, #151515 50%, #0A0A0A 100%);
            min-height: 100vh;
        }
        
        .route-transition {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        }
        
        .route-transition.active {
            opacity: 1;
            transform: translateY(0);
        }
        
        .slot-reel {
            position: relative;
            overflow: hidden;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .slot-symbol {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            transition: all 0.1s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .matrix-rain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .matrix-char {
            position: absolute;
            color: #00D4FF;
            font-family: monospace;
            font-size: 14px;
            animation: fall linear infinite;
            opacity: 0.7;
        }
        
        @keyframes fall {
            0% { transform: translateY(-100px); opacity: 1; }
            100% { transform: translateY(calc(100vh + 100px)); opacity: 0; }
        }
        
        /* Slots Game Specific Styles */
        .slots-bg {
            background: 
                radial-gradient(ellipse 800px 400px at 20% 30%, rgba(108, 44, 156, 0.2) 0%, transparent 60%),
                radial-gradient(ellipse 600px 300px at 80% 70%, rgba(0, 212, 255, 0.15) 0%, transparent 60%),
                radial-gradient(ellipse 700px 350px at 50% 10%, rgba(255, 210, 63, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0f 0%, #000000 30%, #0f0a15 70%, #050508 100%);
            animation: casino-atmosphere 12s ease-in-out infinite alternate;
        }
        
        @keyframes casino-atmosphere {
            0%, 100% { 
                background: 
                    radial-gradient(ellipse 800px 400px at 20% 30%, rgba(108, 44, 156, 0.2) 0%, transparent 60%),
                    radial-gradient(ellipse 600px 300px at 80% 70%, rgba(0, 212, 255, 0.15) 0%, transparent 60%),
                    radial-gradient(ellipse 700px 350px at 50% 10%, rgba(255, 210, 63, 0.1) 0%, transparent 50%),
                    linear-gradient(135deg, #0a0a0f 0%, #000000 30%, #0f0a15 70%, #050508 100%);
            }
            50% { 
                background: 
                    radial-gradient(ellipse 900px 450px at 25% 35%, rgba(108, 44, 156, 0.25) 0%, transparent 65%),
                    radial-gradient(ellipse 650px 320px at 75% 65%, rgba(0, 212, 255, 0.18) 0%, transparent 65%),
                    radial-gradient(ellipse 750px 380px at 45% 15%, rgba(255, 210, 63, 0.12) 0%, transparent 55%),
                    linear-gradient(135deg, #0c0c12 0%, #020202 30%, #120a18 70%, #080508 100%);
            }
        }
        
        .reel-symbol.spinning {
            animation: casino-reel-blur 0.1s ease-in-out infinite;
            filter: blur(2px) brightness(1.1);
        }
        
        @keyframes casino-reel-blur {
            0%, 100% { 
                filter: blur(1px) brightness(1);
                opacity: 1;
            }
            50% { 
                filter: blur(3px) brightness(1.2);
                opacity: 0.8;
            }
        }
        

        
        /* New symbols dropping down */
        .reel-symbol.dropping {
            animation: reel-settle 0.3s ease-out;
        }
        
        @keyframes reel-settle {
            0% { 
                opacity: 0;
                filter: blur(1px);
            }
            100% { 
                opacity: 1;
                filter: blur(0px);
            }
        }
        
        .cheat-button {
            transform: scale(1);
            transition: all 0.2s ease;
        }
        
        .cheat-button:hover {
            transform: scale(1.02);
        }
        
        .cheat-button.active {
            background: linear-gradient(135deg, #065f46, #047857) !important;
            border-color: #10b981 !important;
        }
        
        /* 3x3 Slot Grid Styles */
        .slot-reels-container {
            position: relative;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .slot-reels-grid {
            background: linear-gradient(135deg, rgba(21, 21, 21, 0.8), rgba(45, 45, 45, 0.6));
            border-radius: 1rem;
            padding: 1rem;
            border: 2px solid rgba(0, 212, 255, 0.3);
        }
        
        .slot-reel {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 80px;
            transition: all 0.3s ease;
        }
        
        .payline-reel {
            border-color: rgba(255, 210, 63, 0.8) !important;
            box-shadow: 0 0 15px rgba(255, 210, 63, 0.3);
        }
        
        @keyframes payline-glow {
            0% { box-shadow: 0 0 10px #FFD23F, 0 0 20px #FFD23F; }
            100% { box-shadow: 0 0 20px #FFD23F, 0 0 30px #FFD23F, 0 0 40px #FFD23F; }
        }
        
        /* Dice Container with Slots-Style Theme */
        .dice-container {
            width: 100px;
            height: 100px;
            background: linear-gradient(135deg, rgba(21, 21, 21, 0.9), rgba(45, 45, 45, 0.7));
            border: 3px solid rgba(0, 212, 255, 0.6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            color: white;
            text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7);
            box-shadow: 
                0 0 20px rgba(0, 212, 255, 0.3),
                inset 0 0 20px rgba(108, 44, 156, 0.2);
            transition: all 0.3s ease;
            filter: brightness(1.1) contrast(1.2);
        }
        
        .dice-container.animate-spin {
            animation: spin 0.1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* Apply slots-style background to dice game */
        .slots-bg {
            background: 
                radial-gradient(ellipse 800px 400px at 20% 30%, rgba(108, 44, 156, 0.2) 0%, transparent 60%),
                radial-gradient(ellipse 600px 300px at 80% 70%, rgba(0, 212, 255, 0.15) 0%, transparent 60%),
                radial-gradient(ellipse 700px 350px at 50% 10%, rgba(255, 210, 63, 0.1) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0f 0%, #000000 30%, #0f0a15 70%, #050508 100%);
            animation: casino-atmosphere 12s ease-in-out infinite alternate;
        }
        
        /* Dynatrace Smartscape Theme */
        .smartscape-bg {
            background: 
                radial-gradient(circle at 20% 20%, rgba(108, 44, 156, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(20, 150, 255, 0.2) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(0, 212, 255, 0.15) 0%, transparent 40%),
                linear-gradient(135deg, #0a0a0f 0%, #151929 50%, #0f0a15 100%);
            position: relative;
        }
        
        .smartscape-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                linear-gradient(90deg, rgba(0, 212, 255, 0.1) 1px, transparent 1px),
                linear-gradient(rgba(0, 212, 255, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            opacity: 0.3;
            pointer-events: none;
        }
        
        .smartscape-node {
            position: relative;
            background: linear-gradient(135deg, rgba(108, 44, 156, 0.8), rgba(20, 150, 255, 0.6));
            border: 2px solid rgba(0, 212, 255, 0.5);
            box-shadow: 
                0 0 20px rgba(0, 212, 255, 0.3),
                inset 0 0 20px rgba(108, 44, 156, 0.2);
        }
        
        .smartscape-node::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, transparent 30%, rgba(0, 212, 255, 0.6) 50%, transparent 70%);
            border-radius: inherit;
            z-index: -1;
            animation: smartscape-pulse 3s ease-in-out infinite;
        }
        
        @keyframes smartscape-pulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.02); }
        }
        
        .topology-connection {
            position: absolute;
            height: 2px;
            background: linear-gradient(90deg, transparent 0%, rgba(0, 212, 255, 0.8) 50%, transparent 100%);
            animation: data-flow 2s ease-in-out infinite;
        }
        
        @keyframes data-flow {
            0% { transform: scaleX(0); opacity: 0; }
            50% { transform: scaleX(1); opacity: 1; }
            100% { transform: scaleX(0); opacity: 0; }
        }

        @keyframes fadeInUp {
            0% { 
                opacity: 0; 
                transform: translateY(20px) scale(0.8); 
            }
            100% { 
                opacity: 1; 
                transform: translateY(0) scale(1); 
            }
        }
        
        .animate-fadeInUp {
            animation: fadeInUp 0.5s ease-out forwards;
        }
        
        .card-element {
            animation: fadeInUp 0.5s ease-out forwards;
        }
        
        .betting-chip {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .betting-chip:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        
        .betting-chip.selected {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6), 0 0 40px rgba(255, 215, 0, 0.4);
            border: 2px solid #FFD700;
        }
        
        /* 3D Dice Styling */
        .dice-reel {
            width: 120px;
            height: 120px;
            position: relative;
            transform-style: preserve-3d;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            margin: 0 auto;
        }
        
        .dice-cube {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transform: rotateX(-15deg) rotateY(15deg);
            transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        .dice-face {
            position: absolute;
            width: 120px;
            height: 120px;
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border: 3px solid #6c757d;
            border-radius: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            padding: 8px;
            box-sizing: border-box;
            box-shadow: 
                0 12px 24px rgba(0, 0, 0, 0.4),
                inset 0 3px 6px rgba(255, 255, 255, 0.9),
                inset 0 -3px 6px rgba(0, 0, 0, 0.1);
        }
        
        .dice-face.front { transform: rotateY(0deg) translateZ(60px); }
        .dice-face.back { transform: rotateY(180deg) translateZ(60px); }
        .dice-face.right { transform: rotateY(90deg) translateZ(60px); }
        .dice-face.left { transform: rotateY(-90deg) translateZ(60px); }
        .dice-face.top { transform: rotateX(90deg) translateZ(60px); }
        .dice-face.bottom { transform: rotateX(-90deg) translateZ(60px); }
        
        .dice-rolling .dice-cube {
            animation: dice-roll-3d 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }
        
        @keyframes dice-roll-3d {
            0% { 
                transform: rotateX(-15deg) rotateY(15deg) rotateZ(0deg);
            }
            25% { 
                transform: rotateX(180deg) rotateY(90deg) rotateZ(45deg) scale(1.1);
            }
            50% { 
                transform: rotateX(360deg) rotateY(180deg) rotateZ(90deg) scale(1.15);
            }
            75% { 
                transform: rotateX(540deg) rotateY(270deg) rotateZ(135deg) scale(1.1);
            }
            100% { 
                transform: rotateX(705deg) rotateY(375deg) rotateZ(180deg) scale(1);
            }
        }
        
        .dice-dot {
            width: 16px;
            height: 16px;
            background: radial-gradient(circle at 30% 30%, #1a1a1a, #333, #000);
            border-radius: 50%;
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.6),
                inset 0 1px 2px rgba(255, 255, 255, 0.3),
                inset 0 -1px 2px rgba(0, 0, 0, 0.4);
            position: relative;
        }
        
        .dice-dot::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 4px;
            height: 4px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            box-shadow: 0 0 3px rgba(255, 255, 255, 0.6);
        }
        
        /* Dice Face Patterns */
        .face-1 { justify-content: center; align-items: center; }
        .face-2 { justify-content: space-between; align-items: stretch; flex-direction: column; }
        .face-2 .dice-dot:first-child { align-self: flex-start; }
        .face-2 .dice-dot:last-child { align-self: flex-end; }
        .face-3 { justify-content: space-between; align-items: stretch; flex-direction: column; }
        .face-3 .dice-dot:first-child { align-self: flex-start; }
        .face-3 .dice-dot:nth-child(2) { align-self: center; }
        .face-3 .dice-dot:last-child { align-self: flex-end; }
        .face-4 { justify-content: space-between; align-content: space-between; }
        .face-5 { justify-content: space-between; align-content: space-between; }
        .face-5 .dice-dot:nth-child(5) { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .face-6 { justify-content: space-between; align-content: space-between; flex-direction: column; }
        .face-6-row { display: flex; justify-content: space-between; width: 100%; }
        
        .casino-card-placeholder {
            transition: all 0.3s ease;
        }
        
        .casino-card-placeholder:hover {
            transform: scale(1.05);
        }
        
        .card-element {
            position: relative;
            background: linear-gradient(145deg, #f8f9fa 0%, #ffffff 50%, #f1f3f4 100%);
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.3), 
                inset 0 1px 0 rgba(255,255,255,0.8),
                inset 0 -1px 0 rgba(0,0,0,0.1);
        }
        
        .card-element::before {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            bottom: 2px;
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: 6px;
            pointer-events: none;
        }
        
        .slot-symbol {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Matrix Rain Animation for Lockout Screen */
        @keyframes matrixFall {
            0% {
                transform: translateY(-100vh);
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(100vh);
                opacity: 0;
            }
        }
    </style>
</head>
<body class="text-white font-sans">
    
    <div id="app-container" class="min-h-screen route-transition active">
        <!-- Content will be loaded here -->
    </div>

    <!-- Route Templates -->
    <template id="entrance-template">
        <div class="matrix-rain" id="matrixRain"></div>
        <div class="min-h-screen flex items-center justify-center relative z-10 p-4">
            <div class="text-center max-w-4xl w-full">
                <div class="bg-dt-gray/50 rounded-xl p-8 border border-dt-cyan/30">
                    <h1 class="text-3xl font-bold mb-4 text-dt-cyan">üé∞ DYNATRACE VEGAS</h1>
                    <p class="text-dt-light-gray mb-6">Enter your credentials to access the casino</p>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Left Column -->
                        <div class="space-y-4">
                            <!-- Customer Name input -->
                            <div>
                                <label class="block text-sm font-medium text-dt-cyan mb-2">
                                    CUSTOMER NAME
                                </label>
                                <input 
                                    type="text" 
                                    id="usernameInput" 
                                    class="w-full px-4 py-3 rounded-lg bg-dt-dark text-white border border-dt-cyan/30 focus:border-dt-cyan placeholder-dt-light-gray focus:outline-none"
                                    placeholder="Enter customer name..."
                                    maxlength="50"
                                    required
                                >
                            </div>

                            <!-- Email input -->
                            <div>
                                <label class="block text-sm font-medium text-dt-cyan mb-2">
                                    EMAIL ADDRESS
                                </label>
                                <input 
                                    type="email" 
                                    id="emailInput" 
                                    class="w-full px-4 py-3 rounded-lg bg-dt-dark text-white border border-dt-cyan/30 focus:border-dt-cyan placeholder-dt-light-gray focus:outline-none"
                                    placeholder="Enter email address..."
                                    maxlength="100"
                                    required
                                >
                            </div>

                            <!-- Company Name input -->
                            <div>
                                <label class="block text-sm font-medium text-dt-cyan mb-2">
                                    COMPANY NAME
                                </label>
                                <input 
                                    type="text" 
                                    id="companyNameInput" 
                                    class="w-full px-4 py-3 rounded-lg bg-dt-dark text-white border border-dt-cyan/30 focus:border-dt-cyan placeholder-dt-light-gray focus:outline-none"
                                    placeholder="Enter company name..."
                                    maxlength="100"
                                    required
                                >
                            </div>
                        </div>
                        
                        <!-- Right Column -->
                        <div class="space-y-4">
                            <!-- Persona select -->
                            <div>
                                <label class="block text-sm font-medium text-dt-cyan mb-2">
                                    PERSONA
                                </label>
                                <select 
                                    id="personaSelect" 
                                    class="w-full px-4 py-3 rounded-lg bg-dt-dark text-white border border-dt-cyan/30 focus:border-dt-cyan focus:outline-none"
                                    onchange="toggleCustomPersona()"
                                >
                                    <option value="">Select persona...</option>
                                    <option value="Customer">Customer</option>
                                    <option value="Prospect">Prospect</option>
                                    <option value="Partner">Partner</option>
                                    <option value="Other">Other (specify)</option>
                                </select>
                            </div>
                            
                            <!-- Custom persona input (hidden by default) -->
                            <div>
                                <input 
                                    type="text" 
                                    id="customPersonaInput" 
                                    class="w-full px-4 py-3 rounded-lg bg-dt-dark text-white border border-dt-cyan/30 focus:border-dt-cyan placeholder-dt-light-gray focus:outline-none hidden"
                                    placeholder="Enter custom persona..."
                                    maxlength="50"
                                >
                            </div>

                            <!-- Booth/Demo select -->
                            <div>
                                <label class="block text-sm font-medium text-dt-cyan mb-2">
                                    BOOTH/DEMO TYPE
                                </label>
                                <select 
                                    id="boothSelect" 
                                    class="w-full px-4 py-3 rounded-lg bg-dt-dark text-white border border-dt-cyan/30 focus:border-dt-cyan focus:outline-none"
                                >
                                    <option value="Demo Booth 1">Demo Booth 1</option>
                                    <option value="Demo Booth 2">Demo Booth 2</option>
                                    <option value="Demo Booth 3">Demo Booth 3</option>
                                    <option value="Partner Demo">Partner Demo</option>
                                    <option value="Customer Demo">Customer Demo</option>
                                    <option value="Internal Demo">Internal Demo</option>
                                    <option value="Technical Demo">Technical Demo</option>
                                    <option value="POC Demo">POC Demo</option>
                                    <option value="Healthcare Demo">Healthcare Demo</option>
                                    <option value="Financial Demo">Financial Demo</option>
                                </select>
                            </div>

                            <!-- Data consent selection -->
                            <div>
                                <label class="block text-sm font-medium text-dt-cyan mb-2">
                                    DATA CAPTURE CONSENT
                                </label>
                                <div class="space-y-2">
                                    <label class="flex items-center text-sm">
                                        <input 
                                            type="radio" 
                                            id="dataConsentYes"
                                            name="dataConsent" 
                                            value="true" 
                                            class="mr-2 text-dt-cyan focus:ring-dt-cyan"
                                        >
                                        <span class="text-white">Yes, I consent to data capture for demo purposes</span>
                                    </label>
                                    <label class="flex items-center text-sm">
                                        <input 
                                            type="radio" 
                                            name="dataConsent" 
                                            value="false" 
                                            class="mr-2 text-dt-cyan focus:ring-dt-cyan"
                                        >
                                        <span class="text-white">No, I do not consent to data capture</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button 
                        onclick="enterCasino()" 
                        class="w-full mt-6 bg-gradient-to-r from-dt-purple to-dt-blue hover:from-dt-blue hover:to-dt-cyan text-white font-bold py-3 px-6 rounded-lg transition-all duration-300"
                    >
                        üîì ENTER CASINO
                    </button>
                </div>
            </div>
        </div>
    </template>

    <template id="lobby-template">
        <div class="min-h-screen">
            <nav class="bg-dt-dark/90 border-b border-dt-cyan/30 p-4">
                <div class="flex items-center justify-between max-w-6xl mx-auto">
                    <h1 class="text-xl font-bold text-dt-cyan">Dynatrace Vegas</h1>
                    <div class="flex items-center space-x-4">
                        <span id="userWelcome" class="text-dt-light-gray"></span>
                        <span id="userBalance" class="text-dt-yellow font-bold">Balance: $5600</span>
                        <button 
                            onclick="signOut()" 
                            class="bg-gradient-to-r from-red-600 to-red-500 hover:from-red-500 hover:to-red-400 text-white font-medium py-2 px-4 rounded-lg transition-all duration-300 text-sm"
                        >
                            üö™ Sign Out
                        </button>
                    </div>
                </div>
            </nav>
            
            <div class="p-8">
                <h2 class="text-4xl font-bold text-center mb-8 bg-gradient-to-r from-dt-cyan to-dt-blue bg-clip-text text-transparent">
                    Choose Your Game
                </h2>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 max-w-5xl mx-auto justify-items-center">
                    <div class="game-card bg-dt-gray/50 rounded-xl p-8 border border-dt-cyan/20 hover:border-dt-cyan/50 transition-all duration-300 cursor-pointer transform hover:scale-105" 
                         onclick="navigateTo('/slots')">
                        <div class="text-center">
                            <div class="text-6xl mb-6">üé∞</div>
                            <h3 class="text-2xl font-bold text-dt-cyan mb-3">Slots</h3>
                            <p class="text-base text-dt-light-gray">Spin to win big!</p>
                        </div>
                    </div>
                    
                    <div class="game-card bg-dt-gray/50 rounded-xl p-8 border border-dt-cyan/20 hover:border-dt-cyan/50 transition-all duration-300 cursor-pointer transform hover:scale-105" 
                         onclick="navigateTo('/blackjack')">
                        <div class="text-center">
                            <div class="text-6xl mb-6">üÉè</div>
                            <h3 class="text-2xl font-bold text-dt-cyan mb-3">Blackjack</h3>
                            <p class="text-base text-dt-light-gray">Beat the dealer!</p>
                        </div>
                    </div>
                    
                    <div class="game-card bg-dt-gray/50 rounded-xl p-8 border border-dt-cyan/20 hover:border-dt-cyan/50 transition-all duration-300 cursor-pointer transform hover:scale-105" 
                         onclick="navigateTo('/dice')">
                        <div class="text-center">
                            <div class="text-6xl mb-6">üé≤</div>
                            <h3 class="text-2xl font-bold text-dt-cyan mb-3">Dice</h3>
                            <p class="text-base text-dt-light-gray">Roll for luck!</p>
                        </div>
                    </div>
                    
                    <div class="game-card bg-dt-gray/50 rounded-xl p-6 border border-dt-cyan/20 hover:border-dt-cyan/50 transition-all duration-300 cursor-pointer transform hover:scale-105 hidden" 
                         onclick="navigateTo('/roulette')">
                        <div class="text-center">
                            <div class="text-4xl mb-4">üéØ</div>
                            <h3 class="text-xl font-bold text-dt-cyan mb-2">Roulette</h3>
                            <p class="text-sm text-dt-light-gray">Spin the wheel!</p>
                        </div>
                    </div>
                </div>
                
                <!-- Welcome & Summary Section -->
                <div class="mt-16 max-w-4xl mx-auto">
                    <div class="bg-gradient-to-br from-dt-gray/30 to-dt-dark/50 rounded-2xl p-8 border border-dt-cyan/20 backdrop-blur-sm">
                        <div class="text-center mb-8">
                            <h2 class="text-3xl font-bold bg-gradient-to-r from-dt-yellow via-dt-cyan to-dt-blue bg-clip-text text-transparent mb-4">
                                üé∞ Welcome to Dynatrace Vegas Casino! üéØ
                            </h2>
                            <p class="text-lg text-dt-light-gray leading-relaxed">
                                Experience the thrill of Las Vegas right from your browser! Our interactive casino platform 
                                demonstrates advanced <span class="text-dt-cyan font-semibold">Business Observability</span> capabilities 
                                while providing endless entertainment.
                            </p>
                        </div>
                        
                        <div class="grid md:grid-cols-2 gap-8 text-dt-light-gray">
                            <div>
                                <h3 class="text-xl font-bold text-dt-cyan mb-3">üéÆ Gaming Features</h3>
                                <ul class="space-y-2 text-sm">
                                    <li class="flex items-center"><span class="text-dt-yellow mr-2">‚Ä¢</span> Three exciting games: Slots, Blackjack & Dice</li>
                                    <li class="flex items-center"><span class="text-dt-yellow mr-2">‚Ä¢</span> Real-time balance tracking across all games</li>
                                    <li class="flex items-center"><span class="text-dt-yellow mr-2">‚Ä¢</span> Advanced cheat detection and analytics</li>
                                    <li class="flex items-center"><span class="text-dt-yellow mr-2">‚Ä¢</span> Comprehensive game statistics and insights</li>
                                    <li class="flex items-center"><span class="text-dt-yellow mr-2">‚Ä¢</span> Immersive casino atmosphere with animations</li>
                                </ul>
                            </div>
                            
                            <div>
                                <h3 class="text-xl font-bold text-dt-cyan mb-3">üìä Observability Demo</h3>
                                <ul class="space-y-2 text-sm">
                                    <li class="flex items-center"><span class="text-dt-blue mr-2">‚Ä¢</span> Live user journey tracking and analytics</li>
                                    <li class="flex items-center"><span class="text-dt-blue mr-2">‚Ä¢</span> Real-time transaction monitoring</li>
                                    <li class="flex items-center"><span class="text-dt-blue mr-2">‚Ä¢</span> Advanced behavioral pattern detection</li>
                                    <li class="flex items-center"><span class="text-dt-blue mr-2">‚Ä¢</span> Custom business metrics and KPI tracking</li>
                                    <li class="flex items-center"><span class="text-dt-blue mr-2">‚Ä¢</span> Comprehensive customer experience insights</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="mt-8 text-center">
                            <p class="text-sm text-dt-light-gray/80 italic">
                                Built with ‚ù§Ô∏è to showcase Dynatrace's powerful observability platform. 
                                Every click, spin, and win generates valuable business insights!
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <template id="slots-template">
        <div class="min-h-screen slots-bg">
            <nav class="bg-dt-dark/90 border-b border-dt-cyan/30 p-4">
                <div class="flex items-center justify-between max-w-6xl mx-auto">
                    <button onclick="navigateTo('/lobby')" class="text-dt-cyan hover:text-dt-blue">‚Üê Back to Lobby</button>
                    <h1 class="text-xl font-bold text-dt-cyan">üé∞ Smartscape Slots</h1>
                    <div class="flex items-center space-x-4">
                        <span id="slotsUsername" class="text-dt-cyan font-medium">Welcome, Player!</span>
                        <div class="flex items-center space-x-2">
                            <span id="slotsBalance" class="text-dt-yellow font-bold">Balance: $5600</span>
                            <button onclick="addMoney()" class="bg-gradient-to-r from-dt-green to-dt-yellow hover:from-dt-yellow hover:to-dt-green text-white font-bold py-1 px-3 rounded text-sm transition-all duration-300">
                                +$500
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
            
            <!-- Main Slots Container -->
            <div class="p-4 md:p-8">
                <!-- Cheat Toggle Button -->
                <button id="cheatToggleBtn" onclick="toggleCheatSidePanel()" class="fixed left-4 top-20 bg-gradient-to-r from-green-800 to-green-600 hover:from-green-700 hover:to-green-500 text-white p-3 rounded-lg shadow-lg transition-all duration-300 z-30">
                    <div class="flex items-center space-x-2">
                        <span>‚öôÔ∏è</span>
                        <div class="text-xs font-semibold">Enable Cheats</div>
                    </div>
                </button>

                <!-- Cheat Side Panel -->
                <div id="cheatSidePanel" class="fixed left-0 top-0 h-full w-80 max-w-[25vw] bg-gradient-to-b from-dt-dark via-dt-gray to-dt-dark border-r border-dt-cyan/30 transform -translate-x-full transition-transform duration-300 ease-in-out z-40">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-bold text-dt-cyan">Cheat Configuration</h3>
                            <button id="closeSidePanel" onclick="toggleCheatSidePanel()" class="text-dt-light-gray hover:text-white transition-colors">‚úï</button>
                        </div>
                        
                        <div class="space-y-4">
                            <button id="cheatReelSynchronization" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateCheat('reelSynchronization')">
                                <div class="font-bold">üéØ Reel Sync Control</div>
                                <div class="text-xs text-green-400 mt-1">+45% Win Rate | 20% Risk</div>
                                <div class="text-xs text-gray-400 mt-1">Synchronize reels for optimal alignment</div>
                            </button>
                            
                            <button id="cheatSymbolWeighting" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateCheat('symbolWeighting')">
                                <div class="font-bold">‚öñÔ∏è Symbol Frequency Boost</div>
                                <div class="text-xs text-green-400 mt-1">+35% Win Rate | 15% Risk</div>
                                <div class="text-xs text-gray-400 mt-1">Increase favorable symbol frequency</div>
                            </button>
                            
                            <button id="cheatJackpotTrigger" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateCheat('jackpotTrigger')">
                                <div class="font-bold">üíé Jackpot Trigger</div>
                                <div class="text-xs text-green-400 mt-1">+60% Win Rate | 40% Risk</div>
                                <div class="text-xs text-gray-400 mt-1">Force jackpot combinations</div>
                            </button>
                            
                            <button onclick="deactivateCheat()" class="w-full bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white text-sm py-3 px-4 rounded-lg transition-all font-semibold">
                                ‚ùå Deactivate Cheat
                            </button>
                        </div>
                        
                        <div class="text-center text-xs text-gray-400 mt-4 pt-4 border-t border-gray-700/50">
                            <div>Active Cheat: <span id="sidePanelCheatStatus" class="text-dt-yellow">None</span></div>
                        </div>
                    </div>
                </div>

                <!-- Main Game Area -->
                <div class="max-w-7xl mx-auto px-4">
                    <h2 class="text-3xl md:text-5xl font-bold mb-8 text-center bg-gradient-to-r from-dt-cyan via-dt-blue to-dt-purple bg-clip-text text-transparent">
                        üé∞ SMARTSCAPE SLOTS üé∞
                    </h2>
                    
                    <!-- Slot Machine -->
                    <div class="slot-machine-container bg-gradient-to-b from-dt-gray/40 to-dt-dark/60 rounded-2xl p-6 md:p-8 border border-dt-cyan/30 shadow-2xl mb-8 max-w-4xl mx-auto">
                        <!-- 3x3 Slot Reels Grid -->
                        <div class="slot-reels-container mb-8" style="width: 100%; max-width: 500px; margin: 0 auto;">
                            <div class="slot-reels-grid grid grid-cols-3 grid-rows-3 gap-0" style="aspect-ratio: 1; width: 100%; height: 0; padding-bottom: 100%; position: relative;">
                                <!-- Row 1 -->
                                <div class="slot-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 shadow-xl flex items-center justify-center" id="reel1-1" style="position: absolute; width: 33.333%; height: 33.333%; top: 0; left: 0;">
                                    <div class="slot-symbol reel-symbol transition-transform duration-300" id="symbol1-1">
                                        <div class="text-4xl md:text-6xl text-center" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">üåê</div>
                                    </div>
                                </div>
                                <div class="slot-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 shadow-xl flex items-center justify-center" id="reel1-2" style="position: absolute; width: 33.333%; height: 33.333%; top: 0; left: 33.333%;">
                                    <div class="slot-symbol reel-symbol transition-transform duration-300" id="symbol1-2">
                                        <div class="text-4xl md:text-6xl text-center" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">üì±</div>
                                    </div>
                                </div>
                                <div class="slot-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 shadow-xl flex items-center justify-center" id="reel1-3" style="position: absolute; width: 33.333%; height: 33.333%; top: 0; left: 66.666%;">
                                    <div class="slot-symbol reel-symbol transition-transform duration-300" id="symbol1-3">
                                        <div class="text-4xl md:text-6xl text-center" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">üóÑÔ∏è</div>
                                    </div>
                                </div>
                                
                                <!-- Row 2 (PAYLINE) -->
                                <div class="slot-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-yellow/60 shadow-xl payline-reel flex items-center justify-center" id="reel2-1" style="position: absolute; width: 33.333%; height: 33.333%; top: 33.333%; left: 0;">
                                    <div class="slot-symbol reel-symbol transition-transform duration-300" id="symbol2-1">
                                        <div class="text-4xl md:text-6xl text-center" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">üñ•Ô∏è</div>
                                    </div>
                                </div>
                                <div class="slot-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-yellow/60 shadow-xl payline-reel flex items-center justify-center" id="reel2-2" style="position: absolute; width: 33.333%; height: 33.333%; top: 33.333%; left: 33.333%;">
                                    <div class="slot-symbol reel-symbol transition-transform duration-300" id="symbol2-2">
                                        <div class="text-4xl md:text-6xl text-center" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">‚òÅÔ∏è</div>
                                    </div>
                                </div>
                                <div class="slot-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-yellow/60 shadow-xl payline-reel flex items-center justify-center" id="reel2-3" style="position: absolute; width: 33.333%; height: 33.333%; top: 33.333%; left: 66.666%;">
                                    <div class="slot-symbol reel-symbol transition-transform duration-300" id="symbol2-3">
                                        <div class="text-4xl md:text-6xl text-center" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">üõ°Ô∏è</div>
                                    </div>
                                </div>
                                
                                <!-- Row 3 -->
                                <div class="slot-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 shadow-xl flex items-center justify-center" id="reel3-1" style="position: absolute; width: 33.333%; height: 33.333%; top: 66.666%; left: 0;">
                                    <div class="slot-symbol reel-symbol transition-transform duration-300" id="symbol3-1">
                                        <div class="text-4xl md:text-6xl text-center" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">üìä</div>
                                    </div>
                                </div>
                                <div class="slot-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 shadow-xl flex items-center justify-center" id="reel3-2" style="position: absolute; width: 33.333%; height: 33.333%; top: 66.666%; left: 33.333%;">
                                    <div class="slot-symbol reel-symbol transition-transform duration-300" id="symbol3-2">
                                        <div class="text-4xl md:text-6xl text-center" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">‚öôÔ∏è</div>
                                    </div>
                                </div>
                                <div class="slot-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 shadow-xl flex items-center justify-center" id="reel3-3" style="position: absolute; width: 33.333%; height: 33.333%; top: 66.666%; left: 66.666%;">
                                    <div class="slot-symbol reel-symbol transition-transform duration-300" id="symbol3-3">
                                        <div class="text-4xl md:text-6xl text-center" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">üè†</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bet Controls -->
                        <div class="flex flex-col md:flex-row items-center justify-center gap-4 md:gap-6 mb-6">
                            <div class="bg-dt-dark/70 rounded-lg p-4 border border-dt-cyan/30">
                                <label class="block text-dt-cyan text-sm font-bold mb-2">Bet Amount</label>
                                <select id="slotsBetAmount" class="bg-dt-gray text-white rounded px-4 py-2 border border-dt-cyan/30 font-bold">
                                    <option value="5">$5</option>
                                    <option value="10">$10</option>
                                    <option value="25" selected>$25</option>
                                    <option value="50">$50</option>
                                    <option value="100">$100</option>
                                    <option value="250">$250</option>
                                </select>
                            </div>
                            
                            <button id="spinButton" onclick="spinSlots()" 
                                class="bg-gradient-to-r from-dt-purple via-dt-blue to-dt-cyan hover:from-dt-cyan hover:to-dt-purple text-white font-bold py-4 px-8 rounded-xl text-lg md:text-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl border border-dt-cyan/50">
                                üé∞ SPIN REELS üé∞
                            </button>
                        </div>
                        
                        <!-- Results Display -->
                        <div id="slotsResult" class="text-center text-xl md:text-2xl text-dt-cyan font-bold mb-4 min-h-[2rem]"></div>
                        <div id="slotsWin" class="text-center text-2xl md:text-4xl font-bold text-dt-yellow mb-4 min-h-[2rem]"></div>
                        
                        <!-- Cheat Status Display -->
                        <div id="cheatStatusDisplay" class="text-center text-sm text-dt-orange mb-4 min-h-[1rem]"></div>
                    </div>
                    
                    <!-- Payout Information Button -->
                    <div class="text-center mb-8">
                        <button onclick="openPayoutInfoModal()" 
                            class="bg-gradient-to-r from-dt-green to-dt-yellow hover:from-dt-yellow hover:to-dt-green text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 shadow-lg">
                            üìä PAYOUT INFO
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </template>

    <!-- Blackjack Game Template -->
    <template id="blackjack-template">
        <div class="h-screen overflow-y-auto bg-gray-900" style="background: linear-gradient(135deg, #0D1B2A 0%, #1B263B 25%, #2D4354 50%, #1B263B 75%, #0D1B2A 100%);">
            <nav class="bg-dt-dark/90 border-b border-dt-cyan/30 p-4">
                <div class="flex items-center justify-between max-w-6xl mx-auto">
                    <button onclick="navigateTo('/lobby')" class="text-dt-cyan hover:text-dt-blue">‚Üê Back to Lobby</button>
                    <h1 class="text-xl font-bold text-dt-cyan">üÉè Observability Blackjack</h1>
                    <div class="flex items-center space-x-4">
                        <span id="blackjackUsername" class="text-dt-cyan font-medium">Welcome, Player!</span>
                        <div class="flex items-center space-x-2">
                            <span id="blackjackBalanceTop" class="text-dt-yellow font-bold">Balance: $5600</span>
                            <button onclick="addMoney()" class="bg-gradient-to-r from-dt-green to-dt-yellow hover:from-dt-yellow hover:to-dt-green text-white font-bold py-1 px-3 rounded text-sm transition-all duration-300">
                                +$500
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
            
            <!-- Main Blackjack Container -->
            <div class="p-4 md:p-8">
                <!-- Cheat Toggle Button -->
                <button id="blackjackCheatToggleBtn" onclick="toggleBlackjackCheatSidePanel()" class="fixed left-4 top-20 bg-gradient-to-r from-green-800 to-green-600 hover:from-green-700 hover:to-green-500 text-white p-3 rounded-lg shadow-lg transition-all duration-300 z-30">
                    <div class="flex items-center space-x-2">
                        <span>‚öôÔ∏è</span>
                        <div class="text-xs font-semibold">Enable Cheats</div>
                    </div>
                </button>

                <!-- Cheat Side Panel -->
                <div id="blackjackCheatSidePanel" class="fixed left-0 top-0 h-full w-80 bg-gray-900/95 backdrop-blur-sm border-r-2 border-green-500/30 transform -translate-x-full transition-transform duration-300 z-40 overflow-y-auto">
                    <div class="p-6">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="text-lg font-bold text-green-400">üÉè BLACKJACK CHEATS</h3>
                            <button onclick="toggleBlackjackCheatSidePanel()" class="text-gray-400 hover:text-white text-xl">√ó</button>
                        </div>
                        
                        <div class="space-y-4">
                            <button id="cheatCardCounting" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateBlackjackCheat('cardCounting')">
                                <div class="font-bold">üßÆ Card Counting</div>
                                <div class="text-xs text-green-400 mt-1">+40% Win Rate | 25% Risk</div>
                                <div class="text-xs text-gray-400 mt-1">Track remaining high cards</div>
                            </button>
                            
                            <button id="cheatDealerPeek" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateBlackjackCheat('dealerPeek')">
                                <div class="font-bold">üëÅÔ∏è Dealer Hole Card</div>
                                <div class="text-xs text-green-400 mt-1">+50% Win Rate | 30% Risk</div>
                                <div class="text-xs text-gray-400 mt-1">See dealer's hidden card</div>
                            </button>
                            
                            <button id="cheatLuckyCards" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateBlackjackCheat('luckyCards')">
                                <div class="font-bold">üçÄ Lucky Draw</div>
                                <div class="text-xs text-green-400 mt-1">+35% Win Rate | 20% Risk</div>
                                <div class="text-xs text-gray-400 mt-1">Increase favorable card odds</div>
                            </button>
                            
                            <button onclick="deactivateBlackjackCheat()" class="w-full bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white text-sm py-3 px-4 rounded-lg transition-all font-semibold">
                                ‚ùå Deactivate Cheat
                            </button>
                        </div>
                        
                        <div class="text-center text-xs text-gray-400 mt-4 pt-4 border-t border-gray-700/50">
                            <div>Active Cheat: <span id="blackjackSidePanelCheatStatus" class="text-dt-yellow">None</span></div>
                        </div>
                    </div>
                </div>

            <div class="container mx-auto px-4 py-4">
                
                <!-- Game Header -->
                <div class="text-center mb-6">
                    <h1 class="text-4xl md:text-5xl font-bold text-transparent bg-gradient-to-r from-dt-cyan to-dt-green bg-clip-text mb-2">
                        üÉè OBSERVABILITY BLACKJACK üÉè
                    </h1>
                    <p class="text-white text-lg">Beat the Dealer ‚Ä¢ Master Your Monitoring</p>
                </div>

                <!-- Main Game Layout - Table Left, Controls Right -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                    
                    <!-- Casino Table - Left Side (2/3 width) -->
                    <div class="lg:col-span-2">
                        <!-- Fancy Casino Table -->
                <div class="relative bg-gradient-to-br from-green-900 to-green-700 rounded-3xl p-8 mb-6 shadow-2xl" style="background-image: radial-gradient(circle at 30% 20%, rgba(0,100,0,0.3) 0%, transparent 50%), radial-gradient(circle at 70% 80%, rgba(0,80,0,0.2) 0%, transparent 50%); border: 3px solid #8B4513;">
                    
                    <!-- Table Felt Pattern -->
                    <div class="absolute inset-4 rounded-2xl" style="background: linear-gradient(45deg, #2F855A 0%, #38A169 25%, #2F855A 50%, #38A169 75%, #2F855A 100%); background-size: 20px 20px; opacity: 0.1;"></div>
                    
                    <!-- Dealer Section -->
                    <div class="relative text-center mb-8">
                        <div class="bg-black/20 rounded-xl p-4 border border-yellow-600/30">
                            <h3 class="text-xl font-bold text-yellow-300 mb-4">üé© DEALER</h3>
                            <div class="mb-3">
                                <span class="text-yellow-200 text-lg">Total: </span>
                                <span id="dealerTotal" class="text-2xl font-bold text-yellow-300">--</span>
                            </div>
                            
                            <!-- Dealer Cards Container -->
                            <div id="dealerCards" class="flex justify-center items-center gap-2 mb-4 min-h-[140px]">
                                <div class="casino-card-placeholder w-24 h-36 rounded-lg flex items-center justify-center" style="background: linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%); border: 2px dashed rgba(255,215,0,0.3);">
                                    <span class="text-yellow-600/50 text-xs font-bold">DEALER</span>
                                </div>
                                <div class="casino-card-placeholder w-24 h-36 rounded-lg flex items-center justify-center" style="background: linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%); border: 2px dashed rgba(255,215,0,0.3);">
                                    <span class="text-yellow-600/50 text-xs font-bold">CARDS</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Game Status -->
                    <div class="text-center mb-6">
                        <div id="gameStatus" class="text-2xl font-bold text-dt-green min-h-[2rem]">
                            Place your bet to start!
                        </div>
                    </div>

                    <!-- Player Section -->
                    <div class="relative text-center">
                        <div class="bg-black/20 rounded-xl p-4 border border-cyan-600/30">
                            <h3 class="text-xl font-bold text-cyan-300 mb-4">üë§ PLAYER</h3>
                            <div class="mb-3">
                                <span class="text-cyan-200 text-lg">Total: </span>
                                <span id="playerTotal" class="text-2xl font-bold text-cyan-300">--</span>
                            </div>
                            
                            <!-- Player Cards Container -->
                            <div id="playerCards" class="flex justify-center items-center gap-2 mb-6 min-h-[140px]">
                                <div class="casino-card-placeholder w-24 h-36 rounded-lg flex items-center justify-center" style="background: linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%); border: 2px dashed rgba(0,255,255,0.3);">
                                    <span class="text-cyan-600/50 text-xs font-bold">YOUR</span>
                                </div>
                                <div class="casino-card-placeholder w-24 h-36 rounded-lg flex items-center justify-center" style="background: linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%); border: 2px dashed rgba(0,255,255,0.3);">
                                    <span class="text-cyan-600/50 text-xs font-bold">CARDS</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                    </div>
                    
                    <!-- Control Panel - Right Side (1/3 width) -->
                    <div class="lg:col-span-1">
                        
                        <!-- Game Stats -->
                        <div class="bg-gray-800/50 backdrop-blur-sm border border-dt-cyan/30 rounded-xl p-4 mb-6">
                            <h4 class="text-center text-lg font-bold text-dt-cyan mb-4">üìä Game Stats</h4>
                            <div class="space-y-3">
                                <div class="bg-gradient-to-br from-dt-green/20 to-dt-cyan/20 border border-dt-green/30 rounded-lg p-3 text-center">
                                    <div class="text-dt-green text-xl font-bold" id="blackjackBalance">$5600</div>
                                    <div class="text-dt-gray text-sm">Balance</div>
                                </div>
                                <div class="bg-gradient-to-br from-dt-yellow/20 to-dt-orange/20 border border-dt-yellow/30 rounded-lg p-3 text-center">
                                    <div class="text-dt-yellow text-xl font-bold" id="blackjackBet">$0</div>
                                    <div class="text-dt-gray text-sm">Current Bet</div>
                                </div>
                                <div class="bg-gradient-to-br from-dt-purple/20 to-dt-cyan/20 border border-dt-purple/30 rounded-lg p-3 text-center">
                                    <div class="text-dt-purple text-xl font-bold" id="blackjackWins">0</div>
                                    <div class="text-dt-gray text-sm">Wins</div>
                                </div>
                            </div>
                        </div>

                        <!-- Betting Chips -->
                        <div class="bg-gray-800/50 backdrop-blur-sm border border-dt-cyan/30 rounded-xl p-4 mb-6">
                            <h4 class="text-center text-lg font-bold text-dt-yellow mb-4">üí∞ Place Your Bet</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <button onclick="placeBet(25)" class="betting-chip bg-gradient-to-br from-green-600 to-green-800 hover:from-green-500 hover:to-green-700 text-white font-bold py-3 px-4 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-110">
                                    <div class="text-xs">$25</div>
                                    <div class="text-lg">üü¢</div>
                                </button>
                                <button onclick="placeBet(50)" class="betting-chip bg-gradient-to-br from-blue-600 to-blue-800 hover:from-blue-500 hover:to-blue-700 text-white font-bold py-3 px-4 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-110">
                                    <div class="text-xs">$50</div>
                                    <div class="text-lg">üîµ</div>
                                </button>
                                <button onclick="placeBet(100)" class="betting-chip bg-gradient-to-br from-red-600 to-red-800 hover:from-red-500 hover:to-red-700 text-white font-bold py-3 px-4 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-110">
                                    <div class="text-xs">$100</div>
                                    <div class="text-lg">üî¥</div>
                                </button>
                                <button onclick="placeBet(250)" class="betting-chip bg-gradient-to-br from-purple-600 to-purple-800 hover:from-purple-500 hover:to-purple-700 text-white font-bold py-3 px-4 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-110">
                                    <div class="text-xs">$250</div>
                                    <div class="text-lg">üü£</div>
                                </button>
                            </div>
                            <div class="mt-3 flex justify-center">
                                <button onclick="placeBet(500)" class="betting-chip bg-gradient-to-br from-yellow-600 to-yellow-800 hover:from-yellow-500 hover:to-yellow-700 text-white font-bold py-3 px-6 rounded-full transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-110">
                                    <div class="text-xs">$500</div>
                                    <div class="text-lg">üü°</div>
                                </button>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="bg-gray-800/50 backdrop-blur-sm border border-dt-cyan/30 rounded-xl p-4">
                            <h4 class="text-center text-lg font-bold text-dt-green mb-4">üéÆ Game Actions</h4>
                            <div class="space-y-3">
                                <button id="dealBtn" onclick="dealCards()" 
                                    class="w-full bg-gradient-to-r from-dt-green to-dt-cyan hover:from-dt-cyan hover:to-dt-green text-white font-bold py-4 px-6 rounded-lg transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed" 
                                    disabled>
                                    üéØ DEAL CARDS
                                </button>
                                <div class="grid grid-cols-2 gap-2">
                                    <button id="hitBtn" onclick="hitCard()" 
                                        class="bg-gradient-to-r from-dt-yellow to-dt-orange hover:from-dt-orange hover:to-dt-yellow text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed text-sm" 
                                        disabled>
                                        üëä HIT
                                    </button>
                                    <button id="standBtn" onclick="standPlayer()" 
                                        class="bg-gradient-to-r from-dt-purple to-dt-blue hover:from-dt-blue hover:to-dt-purple text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed text-sm" 
                                        disabled>
                                        ‚úã STAND
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </template>

    <!-- Dice Game Template -->
    <template id="dice-template">
        <div class="min-h-screen slots-bg">
            <nav class="bg-dt-dark/90 border-b border-dt-cyan/30 p-4">
                <div class="flex items-center justify-between max-w-6xl mx-auto">
                    <button onclick="navigateTo('/lobby')" class="text-dt-cyan hover:text-dt-blue">‚Üê Back to Lobby</button>
                    <h1 class="text-xl font-bold text-dt-cyan">üé≤ Smartscape Dice</h1>
                    <div class="flex items-center space-x-4">
                        <span id="diceUsername" class="text-dt-cyan font-medium">Welcome, lawro!</span>
                        <div class="flex items-center space-x-2">
                            <span id="diceBalance" class="text-dt-yellow font-bold">Balance: $5600</span>
                            <button onclick="addMoney()" class="bg-gradient-to-r from-dt-green to-dt-yellow hover:from-dt-yellow hover:to-dt-green text-white font-bold py-1 px-3 rounded text-sm transition-all duration-300">
                                +$500
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
            
            <!-- Main Game Area -->
            <div class="p-4 md:p-8">
                <div class="max-w-7xl mx-auto px-4">
                    <h2 class="text-3xl md:text-5xl font-bold mb-8 text-center bg-gradient-to-r from-dt-cyan via-dt-blue to-dt-purple bg-clip-text text-transparent">
                        üé≤ SMARTSCAPE DICE üé≤
                    </h2>
                    
                    <!-- Dice Machine -->
                    <div class="dice-machine-container bg-gradient-to-b from-dt-gray/40 to-dt-dark/60 rounded-2xl p-6 md:p-8 border border-dt-cyan/30 shadow-2xl mb-8 max-w-4xl mx-auto">
                        <!-- Dice Display -->
                        <div class="dice-display-container mb-8" style="width: 100%; max-width: 400px; margin: 0 auto;">
                            <div class="grid grid-cols-3 gap-4 items-center justify-center">
                                <!-- Dice 1 -->
                                <div class="dice-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 shadow-xl flex items-center justify-center" style="aspect-ratio: 1; min-height: 120px;">
                                    <div class="dice-symbol transition-transform duration-300" id="dice1">
                                        <div class="text-4xl md:text-6xl text-center text-white" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">?</div>
                                    </div>
                                </div>
                                
                                <!-- Plus Sign -->
                                <div class="flex items-center justify-center">
                                    <div class="text-4xl font-bold text-dt-cyan" style="text-shadow: 0 0 20px rgba(0,212,255,0.8);">+</div>
                                </div>
                                
                                <!-- Dice 2 -->
                                <div class="dice-reel bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 shadow-xl flex items-center justify-center" style="aspect-ratio: 1; min-height: 120px;">
                                    <div class="dice-symbol transition-transform duration-300" id="dice2">
                                        <div class="text-4xl md:text-6xl text-center text-white" style="text-shadow: 0 0 20px rgba(255,255,255,0.9), 0 0 35px rgba(0,212,255,0.7); filter: brightness(1.1) contrast(1.2);">?</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Result Display -->
                            <div class="mt-6 text-center">
                                <div class="bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-yellow/60 p-4 inline-block">
                                    <div class="text-sm text-dt-cyan mb-2">Total Sum</div>
                                    <div class="text-4xl font-bold text-dt-yellow" id="diceTotal" style="text-shadow: 0 0 20px rgba(255,215,0,0.8);">-</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Bet Controls -->
                        <div class="flex flex-col items-center justify-center gap-4 mb-6">
                            <div class="text-center">
                                <label class="block text-dt-cyan text-lg font-bold mb-4">üí∞ Select Your Bet</label>
                                <div class="flex flex-wrap gap-3 justify-center">
                                    <button class="betting-chip bg-gradient-to-b from-blue-500 to-blue-700 hover:from-blue-400 hover:to-blue-600 text-white p-3 rounded-lg font-bold text-center transition-all transform hover:scale-105 shadow-lg" onclick="setDiceBet(5)">
                                        <div class="text-lg">$5</div>
                                        <div class="text-xs opacity-75">Starter</div>
                                    </button>
                                    <button class="betting-chip bg-gradient-to-b from-green-500 to-green-700 hover:from-green-400 hover:to-green-600 text-white p-3 rounded-lg font-bold text-center transition-all transform hover:scale-105 shadow-lg" onclick="setDiceBet(10)">
                                        <div class="text-lg">$10</div>
                                        <div class="text-xs opacity-75">Safe</div>
                                    </button>
                                    <button class="betting-chip bg-gradient-to-b from-yellow-500 to-yellow-700 hover:from-yellow-400 hover:to-yellow-600 text-white p-3 rounded-lg font-bold text-center transition-all transform hover:scale-105 shadow-lg selected" onclick="setDiceBet(25)">
                                        <div class="text-lg">$25</div>
                                        <div class="text-xs opacity-75">Popular</div>
                                    </button>
                                    <button class="betting-chip bg-gradient-to-b from-red-500 to-red-700 hover:from-red-400 hover:to-red-600 text-white p-3 rounded-lg font-bold text-center transition-all transform hover:scale-105 shadow-lg" onclick="setDiceBet(50)">
                                        <div class="text-lg">$50</div>
                                        <div class="text-xs opacity-75">Bold</div>
                                    </button>
                                    <button class="betting-chip bg-gradient-to-b from-purple-500 to-purple-700 hover:from-purple-400 hover:to-purple-600 text-white p-3 rounded-lg font-bold text-center transition-all transform hover:scale-105 shadow-lg" onclick="setDiceBet(100)">
                                        <div class="text-lg">$100</div>
                                        <div class="text-xs opacity-75">High</div>
                                    </button>
                                    <button class="betting-chip bg-gradient-to-b from-pink-500 to-pink-700 hover:from-pink-400 hover:to-pink-600 text-white p-3 rounded-lg font-bold text-center transition-all transform hover:scale-105 shadow-lg" onclick="setDiceBet(250)">
                                        <div class="text-lg">$250</div>
                                        <div class="text-xs opacity-75">VIP</div>
                                    </button>
                                </div>
                            </div>
                            
                            <button id="rollDiceBtn" onclick="rollDice()" class="bg-gradient-to-r from-dt-purple via-dt-blue to-dt-cyan hover:from-dt-cyan hover:to-dt-purple text-white font-bold py-4 px-8 rounded-xl text-lg md:text-xl transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl border border-dt-cyan/50" disabled="">
                                üé≤ ROLL DICE üé≤
                            </button>
                        </div>
                        
                        <!-- Betting Options -->
                        <div class="betting-options mb-6">
                            <h3 class="text-xl font-bold text-dt-cyan mb-4 text-center">üéØ Betting Options</h3>
                            
                            <!-- Pass Line Bets -->
                            <div class="grid grid-cols-2 gap-3 mb-4">
                                <button id="betPass" class="bet-button bg-gradient-to-b from-green-600 to-green-800 hover:from-green-500 hover:to-green-700 text-white p-3 rounded-lg font-bold transition-all transform hover:scale-105 text-sm" onclick="placeDiceBet('pass', 2)">
                                    <div class="text-base">PASS LINE</div>
                                    <div class="text-xs mt-1">Win on 7 or 11 | Pays 2:1</div>
                                </button>
                                <button id="betDontPass" class="bet-button bg-gradient-to-b from-red-600 to-red-800 hover:from-red-500 hover:to-red-700 text-white p-3 rounded-lg font-bold transition-all transform hover:scale-105 text-sm" onclick="placeDiceBet('dont_pass', 2)">
                                    <div class="text-base">DON'T PASS</div>
                                    <div class="text-xs mt-1">Win on 2 or 3 | Pays 2:1</div>
                                </button>
                            </div>
                            
                            <!-- Field and Number Bets -->
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-3 mb-4">
                                <button id="betField" class="bet-button bg-gradient-to-b from-blue-600 to-blue-800 hover:from-blue-500 hover:to-blue-700 text-white p-3 rounded-lg font-bold transition-all transform hover:scale-105 text-sm" onclick="placeDiceBet('field', 2)">
                                    <div class="text-base">FIELD</div>
                                    <div class="text-xs mt-1">2,3,4,9,10,11,12 | Pays 2:1</div>
                                </button>
                                <button id="betHigh" class="bet-button bg-gradient-to-b from-indigo-600 to-indigo-800 hover:from-indigo-500 hover:to-indigo-700 text-white p-3 rounded-lg font-bold transition-all transform hover:scale-105 text-sm" onclick="placeDiceBet('high', 2)">
                                    <div class="text-base">HIGH (8-12)</div>
                                    <div class="text-xs mt-1">Pays 2:1</div>
                                </button>
                                <button id="betLow" class="bet-button bg-gradient-to-b from-orange-600 to-orange-800 hover:from-orange-500 hover:to-orange-700 text-white p-3 rounded-lg font-bold transition-all transform hover:scale-105 text-sm" onclick="placeDiceBet('low', 2)">
                                    <div class="text-base">LOW (2-6)</div>
                                    <div class="text-xs mt-1">Pays 2:1</div>
                                </button>
                            </div>
                            
                            <!-- Special Bets -->
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                <button id="betSnakeEyes" class="bet-button bg-gradient-to-b from-purple-600 to-purple-800 hover:from-purple-500 hover:to-purple-700 text-white p-3 rounded-lg font-bold transition-all transform hover:scale-105 text-sm" onclick="placeDiceBet('snake_eyes', 30)">
                                    <div class="text-base">SNAKE EYES</div>
                                    <div class="text-xs mt-1">Double 1s | Pays 30:1</div>
                                </button>
                                <button id="betBoxcars" class="bet-button bg-gradient-to-b from-purple-600 to-purple-800 hover:from-purple-500 hover:to-purple-700 text-white p-3 rounded-lg font-bold transition-all transform hover:scale-105 text-sm" onclick="placeDiceBet('boxcars', 30)">
                                    <div class="text-base">BOXCARS</div>
                                    <div class="text-xs mt-1">Double 6s | Pays 30:1</div>
                                </button>
                                <button id="betSevenOut" class="bet-button bg-gradient-to-b from-yellow-600 to-yellow-800 hover:from-yellow-500 hover:to-yellow-700 text-white p-3 rounded-lg font-bold transition-all transform hover:scale-105 text-sm" onclick="placeDiceBet('seven_out', 4)">
                                    <div class="text-base">SEVEN OUT</div>
                                    <div class="text-xs mt-1">Sum equals 7 | Pays 4:1</div>
                                </button>
                                <button id="betDoubles" class="bet-button bg-gradient-to-b from-teal-600 to-teal-800 hover:from-teal-500 hover:to-teal-700 text-white p-3 rounded-lg font-bold transition-all transform hover:scale-105 text-sm" onclick="placeDiceBet('doubles', 6)">
                                    <div class="text-base">ANY DOUBLES</div>
                                    <div class="text-xs mt-1">Matching pairs | Pays 6:1</div>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Results Display -->
                        <div id="diceResult" class="text-center text-xl md:text-2xl text-dt-cyan font-bold mb-4 min-h-[2rem]"></div>
                        <div id="diceWin" class="text-center text-2xl md:text-4xl font-bold text-dt-yellow mb-4 min-h-[2rem]"></div>
                        
                        <!-- Current Bet Display -->
                        <div class="text-center mb-4">
                            <div class="bg-dt-dark/70 rounded-lg p-3 border border-dt-cyan/30 inline-block">
                                <div class="text-sm text-dt-cyan">Current Bet: $<span id="currentDiceBet">0</span></div>
                                <div class="text-xs text-gray-400">Type: <span id="currentBetType">None</span></div>
                            </div>
                        </div>
                        
                        <!-- Cheat Status Display -->
                        <div id="diceCheatStatusDisplay" class="text-center text-sm text-dt-orange mb-4 min-h-[1rem]"></div>
                    </div>
                    
                    
                    <!-- Payout Information Button -->
                    <div class="text-center mb-8">
                        <button onclick="openDicePayoutInfoModal()" class="bg-gradient-to-r from-dt-green to-dt-yellow hover:from-dt-yellow hover:to-dt-green text-white font-bold py-3 px-6 rounded-lg transition-all duration-300 shadow-lg">
                            üìä PAYOUT INFO
                        </button>
                    </div>
                    
                </div>
            </div>
            
            <!-- Cheat Toggle Button -->
            <button id="diceCheatToggleBtn" onclick="toggleDiceCheatPanel()" class="fixed left-4 top-20 bg-gradient-to-r from-green-800 to-green-600 hover:from-green-700 hover:to-green-500 text-white p-3 rounded-lg shadow-lg transition-all duration-300 z-30">
                <div class="flex items-center space-x-2">
                    <span>‚öôÔ∏è</span>
                    <div class="text-xs font-semibold">Enable Cheats</div>
                </div>
            </button>

            <!-- Cheat Side Panel -->
            <div id="diceCheatSidePanel" class="fixed left-0 top-0 h-full w-80 max-w-[25vw] bg-gradient-to-b from-dt-dark via-dt-gray to-dt-dark border-r border-dt-cyan/30 transform -translate-x-full transition-transform duration-300 ease-in-out z-40">
                <div class="p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-bold text-dt-cyan">üéØ Dice Cheats</h3>
                        <button id="diceCloseSidePanel" onclick="toggleDiceCheatPanel()" class="text-dt-light-gray hover:text-white transition-colors">‚úï</button>
                    </div>
                    
                    <div class="space-y-4">
                        <button id="diceCheatLoadedDice" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateDiceCheat('loadedDice')">
                            <div class="font-bold">‚öñÔ∏è Loaded Dice</div>
                            <div class="text-xs text-green-400 mt-1">+85% Win Rate | 25% Risk</div>
                            <div class="text-xs text-gray-400 mt-1">Generally favorable dice outcomes</div>
                        </button>
                        
                        <button id="diceCheatDoubleDown" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateDiceCheat('doubleDown')">
                            <div class="font-bold">üéØ Double Down</div>
                            <div class="text-xs text-green-400 mt-1">+60% Win Rate | 35% Risk</div>
                            <div class="text-xs text-gray-400 mt-1">Double winnings on wins</div>
                        </button>
                        
                        <button id="diceCheatLuckyRolls" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateDiceCheat('luckyRolls')">
                            <div class="font-bold">üçÄ Lucky Rolls</div>
                            <div class="text-xs text-green-400 mt-1">+45% Win Rate | 20% Risk</div>
                            <div class="text-xs text-gray-400 mt-1">Force favorable number combinations</div>
                        </button>
                        
                        <button onclick="deactivateDiceCheat()" class="w-full bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white text-sm py-3 px-4 rounded-lg transition-all font-semibold">
                            ‚ùå Deactivate Cheat
                        </button>
                    </div>
                    
                    <!-- Risk Meter -->
                    <div class="mt-6 p-4 bg-red-900/20 rounded-lg border border-red-500/30">
                        <div class="text-sm text-red-300 mb-2">Detection Risk</div>
                        <div class="w-full bg-gray-700 rounded-full h-2">
                            <div id="diceRiskMeter" class="bg-red-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <div class="text-xs text-red-400 mt-1">Higher risk = Higher rewards</div>
                    </div>
                    
                    <div class="text-center text-xs text-gray-400 mt-4 pt-4 border-t border-gray-700/50">
                        <div>Active Cheat: <span id="diceSidePanelCheatStatus" class="text-dt-yellow">None</span></div>
                    </div>
                </div>
            </div>
            
        </div>
    </template>

    <!-- ===== ROULETTE TEMPLATE ===== -->
    <template id="roulette-template">
        <div class="min-h-screen bg-gradient-to-b from-dt-dark via-dt-dark to-dt-gray p-6">
            <!-- Top Navigation -->
            <div class="flex items-center justify-between mb-8">
                <div class="flex items-center space-x-4">
                    <button onclick="navigateTo('/lobby')" class="bg-gradient-to-r from-dt-purple to-dt-blue px-4 py-2 rounded-lg text-white font-semibold hover:shadow-lg transition-all">
                        ‚Üê Lobby
                    </button>
                    <div class="text-dt-light-gray">Welcome, <span id="rouletteUsername" class="text-dt-yellow font-bold">Player</span></div>
                </div>
                <div class="text-right">
                    <div class="flex items-center space-x-4">
                        <span id="rouletteBalance" class="text-dt-yellow font-bold">Balance: $5600</span>
                        <button onclick="toggleRouletteCheatPanel()" class="bg-red-800/60 hover:bg-red-700/70 px-3 py-1 rounded text-sm text-white transition-colors">
                            üéØ Cheats
                        </button>
                    </div>
                </div>
            </div>

            <!-- Game Title -->
            <div class="text-center mb-8">
                <h2 class="text-4xl md:text-6xl font-bold text-transparent bg-gradient-to-r from-dt-yellow via-dt-cyan to-dt-yellow bg-clip-text">
                    üé∞ SMARTSCAPE ROULETTE üéØ
                </h2>
            </div>

            <!-- Main Game Area -->
            <div class="max-w-7xl mx-auto">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Left Side: Roulette Wheel -->
                    <div class="order-2 lg:order-1">
                        <div class="mb-8">
                            <div class="relative mx-auto w-80 h-80 md:w-96 md:h-96">
                                <!-- Wheel Background with Proper Pockets -->
                                <div id="rouletteWheel" class="w-full h-full rounded-full border-8 border-yellow-500 relative transition-transform duration-4000 ease-out bg-gradient-to-br from-amber-800 to-amber-900 shadow-2xl">
                                    <!-- Outer Ring with Number Pockets -->
                                    <div class="absolute inset-2 rounded-full overflow-hidden">
                                        <!-- Green 0 Pocket -->
                                        <div class="absolute w-full h-full">
                                            <div class="absolute w-8 h-4 bg-green-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(0deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">0</div>
                                            </div>
                                            <!-- Red/Black alternating pockets -->
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(9.73deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">32</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(19.46deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">15</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(29.19deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">19</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(38.92deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">4</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(48.65deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">21</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(58.38deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">2</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(68.11deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">25</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(77.84deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">17</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(87.57deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">34</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(97.3deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">6</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(107.03deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">27</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(116.76deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">13</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(126.49deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">36</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(136.22deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">11</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(145.95deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">30</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(155.68deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">8</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(165.41deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">23</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(175.14deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">10</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(184.87deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">5</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(194.6deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">24</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(204.33deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">16</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(214.06deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">33</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(223.79deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">1</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(233.52deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">20</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(243.25deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">14</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(252.98deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">31</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(262.71deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">9</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(272.44deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">22</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(282.17deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">18</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(291.9deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">29</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(301.63deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">7</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(311.36deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">28</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(321.09deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">12</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(330.82deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">35</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-red-600 border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(340.55deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">3</div>
                                            </div>
                                            <div class="absolute w-8 h-4 bg-black border border-yellow-400" style="top: 2px; left: 50%; transform: translateX(-50%) rotate(350.28deg); transform-origin: center 150px;">
                                                <div class="text-white text-xs font-bold text-center leading-4">26</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Center Result Display -->
                                    <div class="absolute inset-0 rounded-full flex items-center justify-center">
                                        <div class="w-20 h-20 bg-dt-dark/90 rounded-full border-4 border-dt-yellow flex items-center justify-center shadow-xl">
                                            <div id="rouletteResult" class="text-3xl font-bold text-dt-yellow">?</div>
                                        </div>
                                    </div>
                                    
                                    <!-- Ball -->
                                    <div id="rouletteBall" class="absolute w-3 h-3 bg-white rounded-full shadow-lg transition-all duration-4000" style="top: 8px; left: 50%; transform: translateX(-50%);"></div>
                                </div>
                                <!-- Pointer -->
                                <div class="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-2">
                                    <div class="w-0 h-0 border-l-6 border-r-6 border-b-10 border-transparent border-b-dt-yellow drop-shadow-lg"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Basic Betting Options -->
                        <div class="bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 p-6">
                            <h3 class="text-xl font-bold text-dt-cyan mb-4 text-center">Quick Bets</h3>
                            
                            <!-- Bet Amount Selection -->
                            <div class="mb-4 text-center">
                                <label class="block text-dt-light-gray text-sm mb-2">Chip Value</label>
                                <select id="rouletteChipAmount" class="bg-dt-gray border border-dt-cyan/50 text-white px-4 py-2 rounded-lg">
                                    <option value="5">$5</option>
                                    <option value="10">$10</option>
                                    <option value="25" selected>$25</option>
                                    <option value="50">$50</option>
                                    <option value="100">$100</option>
                                </select>
                            </div>

                            <!-- Outside Bets -->
                            <div class="grid grid-cols-2 gap-3 mb-4">
                                <button onclick="placeBet('red')" class="bet-button bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white px-3 py-2 rounded-lg transition-all text-sm">
                                    <div class="font-bold">üî¥ Red</div>
                                    <div class="text-xs">Pays 1:1</div>
                                </button>
                                <button onclick="placeBet('black')" class="bet-button bg-gray-800/60 hover:bg-gray-700/70 border border-gray-500/50 text-white px-3 py-2 rounded-lg transition-all text-sm">
                                    <div class="font-bold">‚ö´ Black</div>
                                    <div class="text-xs">Pays 1:1</div>
                                </button>
                                <button onclick="placeBet('even')" class="bet-button bg-blue-800/60 hover:bg-blue-700/70 border border-blue-500/50 text-white px-3 py-2 rounded-lg transition-all text-sm">
                                    <div class="font-bold">Even</div>
                                    <div class="text-xs">Pays 1:1</div>
                                </button>
                                <button onclick="placeBet('odd')" class="bet-button bg-green-800/60 hover:bg-green-700/70 border border-green-500/50 text-white px-3 py-2 rounded-lg transition-all text-sm">
                                    <div class="font-bold">Odd</div>
                                    <div class="text-xs">Pays 1:1</div>
                                </button>
                                <button onclick="placeBet('low')" class="bet-button bg-purple-800/60 hover:bg-purple-700/70 border border-purple-500/50 text-white px-3 py-2 rounded-lg transition-all text-sm">
                                    <div class="font-bold">1-18</div>
                                    <div class="text-xs">Pays 1:1</div>
                                </button>
                                <button onclick="placeBet('high')" class="bet-button bg-indigo-800/60 hover:bg-indigo-700/70 border border-indigo-500/50 text-white px-3 py-2 rounded-lg transition-all text-sm">
                                    <div class="font-bold">19-36</div>
                                    <div class="text-xs">Pays 1:1</div>
                                </button>
                            </div>

                            <!-- Spin Button -->
                            <div class="text-center">
                                <button id="spinRouletteBtn" onclick="spinRoulette()" disabled class="bg-gradient-to-r from-dt-purple to-dt-blue px-6 py-3 rounded-xl text-white font-bold hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                                    üé∞ SPIN WHEEL üé∞
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Right Side: Betting Table -->
                    <div class="order-1 lg:order-2">
                        <div class="bg-gradient-to-b from-dt-dark to-dt-gray/80 rounded-xl border-2 border-dt-cyan/40 p-4">
                            <h3 class="text-xl font-bold text-dt-cyan mb-4 text-center">Betting Table</h3>
                            
                            <!-- Green Numbers (0, 00) -->
                            <div class="mb-4">
                                <div class="grid grid-cols-2 gap-2">
                                    <div class="number-cell bg-green-800/60 hover:bg-green-700/70 border-2 border-green-500/50 text-white p-3 rounded-lg text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('0')" data-number="0">
                                        <div class="text-lg">0</div>
                                        <div class="text-xs">35:1</div>
                                        <div class="bet-chips absolute -top-2 -right-2"></div>
                                    </div>
                                    <div class="number-cell bg-green-800/60 hover:bg-green-700/70 border-2 border-green-500/50 text-white p-3 rounded-lg text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('00')" data-number="00">
                                        <div class="text-lg">00</div>
                                        <div class="text-xs">35:1</div>
                                        <div class="bet-chips absolute -top-2 -right-2"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Main Number Grid -->
                            <div class="mb-4">
                                <div class="grid grid-cols-3 gap-1" id="numberGrid">
                                    <!-- First Row -->
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border-2 border-red-500/50 text-white p-2 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('3')" data-number="3">
                                        <div>3</div>
                                        <div class="bet-chips absolute -top-1 -right-1 text-xs"></div>
                                    </div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border-2 border-gray-500/50 text-white p-2 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('6')" data-number="6">
                                        <div>6</div>
                                        <div class="bet-chips absolute -top-1 -right-1 text-xs"></div>
                                    </div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border-2 border-red-500/50 text-white p-2 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('9')" data-number="9">
                                        <div>9</div>
                                        <div class="bet-chips absolute -top-1 -right-1 text-xs"></div>
                                    </div>
                                    
                                    <!-- Second Row -->
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border-2 border-gray-500/50 text-white p-2 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('2')" data-number="2">
                                        <div>2</div>
                                        <div class="bet-chips absolute -top-1 -right-1 text-xs"></div>
                                    </div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border-2 border-red-500/50 text-white p-2 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('5')" data-number="5">
                                        <div>5</div>
                                        <div class="bet-chips absolute -top-1 -right-1 text-xs"></div>
                                    </div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border-2 border-gray-500/50 text-white p-2 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('8')" data-number="8">
                                        <div>8</div>
                                        <div class="bet-chips absolute -top-1 -right-1 text-xs"></div>
                                    </div>
                                    
                                    <!-- Third Row -->
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border-2 border-red-500/50 text-white p-2 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('1')" data-number="1">
                                        <div>1</div>
                                        <div class="bet-chips absolute -top-1 -right-1 text-xs"></div>
                                    </div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border-2 border-gray-500/50 text-white p-2 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('4')" data-number="4">
                                        <div>4</div>
                                        <div class="bet-chips absolute -top-1 -right-1 text-xs"></div>
                                    </div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border-2 border-red-500/50 text-white p-2 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('7')" data-number="7">
                                        <div>7</div>
                                        <div class="bet-chips absolute -top-1 -right-1 text-xs"></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Extended Number Grid (10-36) -->
                            <div class="mb-4">
                                <div class="grid grid-cols-6 gap-1 text-xs">
                                    <!-- Numbers 10-36 in grid format -->
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('10')" data-number="10">10<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('11')" data-number="11">11<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('12')" data-number="12">12<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('13')" data-number="13">13<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('14')" data-number="14">14<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('15')" data-number="15">15<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('16')" data-number="16">16<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('17')" data-number="17">17<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('18')" data-number="18">18<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('19')" data-number="19">19<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('20')" data-number="20">20<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('21')" data-number="21">21<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('22')" data-number="22">22<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('23')" data-number="23">23<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('24')" data-number="24">24<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('25')" data-number="25">25<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('26')" data-number="26">26<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('27')" data-number="27">27<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('28')" data-number="28">28<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('29')" data-number="29">29<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('30')" data-number="30">30<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('31')" data-number="31">31<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('32')" data-number="32">32<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('33')" data-number="33">33<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('34')" data-number="34">34<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-black/60 hover:bg-gray-700/70 border border-gray-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('35')" data-number="35">35<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                    <div class="number-cell bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white p-1 rounded text-center font-bold cursor-pointer transition-all relative" onclick="placeNumberBet('36')" data-number="36">36<div class="bet-chips absolute -top-1 -right-1"></div></div>
                                </div>
                            </div>

                            <!-- Current Bets Display -->
                            <div class="mb-4 p-3 bg-dt-dark/50 rounded-lg">
                                <div class="text-sm text-dt-light-gray mb-2">Active Bets</div>
                                <div id="rouletteActiveBets" class="text-dt-yellow text-sm">No bets placed</div>
                                <div class="text-xs text-dt-light-gray mt-2">
                                    Total Bet: $<span id="rouletteTotalBet">0</span>
                                </div>
                            </div>

                            <!-- Clear Bets Button -->
                            <div class="text-center">
                                <button onclick="clearAllBets()" class="bg-red-800/60 hover:bg-red-700/70 px-4 py-2 rounded-lg text-white text-sm transition-all">
                                    üóëÔ∏è Clear All Bets
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Game Status -->
                <div class="text-center mb-6">
                    <div id="rouletteStatus" class="text-lg font-semibold text-dt-green">Place your bet to start spinning!</div>
                    <div id="rouletteWin" class="text-xl font-bold text-dt-yellow mt-2"></div>
                </div>

                <!-- Cheat Status Display -->
                <div class="text-center">
                    <div id="rouletteCheatStatusDisplay" class="text-sm font-medium text-yellow-400"></div>
                </div>
            </div>

            <!-- Cheat Panel -->
            <div id="rouletteCheatPanel" class="fixed top-0 right-0 w-80 h-full bg-dt-dark/95 border-l border-dt-cyan/30 backdrop-blur-sm transform translate-x-full transition-transform duration-300 z-50">
                <div class="p-6 h-full overflow-y-auto">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-bold text-dt-cyan">üéØ Roulette Cheats</h3>
                        <button id="rouletteCloseSidePanel" onclick="toggleRouletteCheatPanel()" class="text-dt-light-gray hover:text-white transition-colors">‚úï</button>
                    </div>
                    
                    <div class="space-y-4">
                        <button id="rouletteCheatMagnet" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateRouletteCheat('magnet')">
                            <div class="font-bold">üß≤ Magnetic Ball</div>
                            <div class="text-xs text-green-400 mt-1">+70% Win Rate | 30% Risk</div>
                            <div class="text-xs text-gray-400 mt-1">Ball attracted to your bet</div>
                        </button>
                        
                        <button id="rouletteCheatWheelControl" class="w-full cheat-button bg-green-900/30 hover:bg-green-800/50 border border-green-500/50 text-green-300 px-4 py-3 rounded-lg text-sm font-semibold transition-all text-left" onclick="activateRouletteCheat('wheelControl')">
                            <div class="font-bold">‚öôÔ∏è Wheel Control</div>
                            <div class="text-xs text-green-400 mt-1">+85% Win Rate | 45% Risk</div>
                            <div class="text-xs text-gray-400 mt-1">Control wheel mechanics</div>
                        </button>
                        
                        <button onclick="deactivateRouletteCheat()" class="w-full bg-red-800/60 hover:bg-red-700/70 border border-red-500/50 text-white text-sm py-3 px-4 rounded-lg transition-all font-semibold">
                            ‚ùå Deactivate Cheat
                        </button>
                    </div>
                    
                    <!-- Risk Meter -->
                    <div class="mt-6 p-4 bg-red-900/20 rounded-lg border border-red-500/30">
                        <div class="text-sm text-red-300 mb-2">Detection Risk</div>
                        <div class="w-full bg-gray-700 rounded-full h-2">
                            <div id="rouletteRiskMeter" class="bg-red-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
                        </div>
                        <div class="text-xs text-red-400 mt-1">Higher risk = Higher rewards</div>
                    </div>
                    
                    <div class="text-center text-xs text-gray-400 mt-4 pt-4 border-t border-gray-700/50">
                        <div>Active Cheat: <span id="rouletteSidePanelCheatStatus" class="text-dt-yellow">None</span></div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <!-- ===== LOCKOUT TEMPLATE ===== -->
    <template id="lockout-template">
        <div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-red-900 via-red-800 to-red-900 relative overflow-hidden">
            <!-- Matrix Rain Background -->
            <div id="lockoutMatrixRain" class="absolute inset-0 opacity-20"></div>
            
            <!-- Lockout Content -->
            <div class="relative z-10 max-w-2xl mx-auto p-8 text-center">
                <div class="bg-red-950/80 backdrop-blur-sm border-2 border-red-500 rounded-2xl p-8 shadow-2xl">
                    <!-- Warning Icon -->
                    <div class="mb-6">
                        <div class="text-8xl text-red-400 mb-4">üö®</div>
                        <h1 class="text-4xl font-bold text-red-300 mb-2">ACCOUNT LOCKED</h1>
                        <div class="h-1 bg-gradient-to-r from-transparent via-red-500 to-transparent rounded mx-auto"></div>
                    </div>
                    
                    <!-- Lockout Details -->
                    <div class="bg-red-900/50 rounded-lg p-6 mb-6 border border-red-600">
                        <h2 class="text-xl font-bold text-red-300 mb-4">Security Violation Detected</h2>
                        <div class="text-left space-y-3 text-red-200">
                            <div class="flex justify-between">
                                <span class="font-semibold">User:</span>
                                <span id="lockoutUsername" class="text-red-300">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Reason:</span>
                                <span id="lockoutReason" class="text-red-300">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Time:</span>
                                <span id="lockoutTime" class="text-red-300">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Violations:</span>
                                <span id="lockoutViolations" class="text-red-300">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Winnings Confiscated:</span>
                                <span id="lockoutConfiscated" class="text-red-300">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="font-semibold">Balance Adjustment:</span>
                                <span id="lockoutBalanceAdjustment" class="text-red-300">-</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Additional Info -->
                    <div class="text-sm text-red-400 leading-relaxed">
                        <p class="mb-4">
                            Your account has been automatically locked due to suspicious gaming activity. 
                            All fraudulent winnings have been confiscated and your balance has been adjusted.
                        </p>
                        <p class="mb-6">
                            This action was triggered by Dynatrace's advanced fraud detection system. 
                            For appeals, contact the casino administrator.
                        </p>
                    </div>
                    
                    <!-- Status Indicator -->
                    <div class="flex items-center justify-center space-x-2 text-red-300">
                        <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                        <span class="text-sm font-mono">SYSTEM LOCKED</span>
                        <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                    </div>
                </div>
            </div>
        </div>
    </template>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <script>
        console.log('üöÄ Vegas Casino SPA Starting...');
        
        // Initialize Socket.IO connection for lockout notifications
        const socket = io();
        
        // Lockout state management
        let isUserLocked = false;
        let lockoutData = null;
        
        // Slots Game Data - Dynatrace Observability Platform Symbols
        const slotSymbols = [
            { name: 'Smartscape', emoji: 'üåê', color: '#6C2C9C', rarity: 'common' },
            { name: 'Application', emoji: 'üì±', color: '#1496FF', rarity: 'common' },
            { name: 'Database', emoji: 'üóÑÔ∏è', color: '#73BE28', rarity: 'common' },
            { name: 'Server', emoji: 'üñ•Ô∏è', color: '#FFD23F', rarity: 'common' },
            { name: 'Cloud', emoji: '‚òÅÔ∏è', color: '#00D4FF', rarity: 'common' },
            { name: 'Security', emoji: 'üõ°Ô∏è', color: '#FFA86B', rarity: 'common' },
            { name: 'Analytics', emoji: 'üìä', color: '#73BE28', rarity: 'common' },
            { name: 'Infrastructure', emoji: '‚öôÔ∏è', color: '#FFD23F', rarity: 'common' },
            { name: 'Monitoring', emoji: 'üè†', color: '#00D4FF', rarity: 'common' }
        ];
        
        const dynatraceSymbol = { name: 'Dynatrace', emoji: 'DT', color: '#6C2C9C', rarity: 'legendary' };
        
        // Payout Matrix
        const payoutMatrix = {
            triple: {
                'Smartscape': { multiplier: 10, name: 'TOPOLOGY MASTERY!' },
                'Application': { multiplier: 10, name: 'APM BREAKTHROUGH!' },
                'Database': { multiplier: 10, name: 'DATA OBSERVABILITY CHAMPION!' },
                'Server': { multiplier: 10, name: 'INFRASTRUCTURE MASTERY!' },
                'Cloud': { multiplier: 10, name: 'CLOUD-NATIVE SUCCESS!' },
                'Security': { multiplier: 10, name: 'SECURITY OBSERVABILITY EXPERT!' },
                'Dynatrace': { multiplier: 50, name: 'DYNATRACE MEGA JACKPOT!' }
            },
            double: {
                'Smartscape': { multiplier: 5, name: 'Topology Discovery!' },
                'Application': { multiplier: 5, name: 'APM Insight!' },
                'Database': { multiplier: 5, name: 'Data Connection!' },
                'Server': { multiplier: 5, name: 'Infrastructure Pair!' },
                'Cloud': { multiplier: 5, name: 'Cloud Duo!' },
                'Security': { multiplier: 5, name: 'Security Alliance!' }
            }
        };
        
        // Cheat System
        let cheatState = {
            active: null,
            winRateBoost: 0,
            detectionRisk: 0
        };
        
        const cheatMethods = {
            reelSynchronization: { 
                name: 'Reel Sync Control', 
                winRateBoost: 45, 
                detectionRisk: 20,
                description: 'Synchronize reels for optimal symbol alignment'
            },
            symbolWeighting: { 
                name: 'Symbol Frequency Boost', 
                winRateBoost: 35, 
                detectionRisk: 15,
                description: 'Increase favorable symbol frequency'
            },
            jackpotTrigger: { 
                name: 'Jackpot Trigger', 
                winRateBoost: 60, 
                detectionRisk: 40,
                description: 'Force jackpot combinations'
            }
        };
        
        // Cheat Functions
        function toggleCheatSidePanel() {
            const panel = document.getElementById('cheatSidePanel');
            const isVisible = panel.style.transform === 'translateX(0px)';
            
            if (isVisible) {
                panel.style.transform = 'translateX(-100%)';
            } else {
                panel.style.transform = 'translateX(0px)';
            }
        }
        
        function activateCheat(cheatType) {
            if (cheatMethods[cheatType]) {
                cheatState.active = cheatType;
                cheatState.winRateBoost = cheatMethods[cheatType].winRateBoost;
                cheatState.detectionRisk = cheatMethods[cheatType].detectionRisk;
                
                // Update UI
                document.querySelectorAll('.cheat-button').forEach(btn => btn.classList.remove('active'));
                document.getElementById(`cheat${cheatType.charAt(0).toUpperCase() + cheatType.slice(1)}`).classList.add('active');
                document.getElementById('sidePanelCheatStatus').textContent = cheatMethods[cheatType].name;
                
                console.log(`üéØ Cheat activated: ${cheatMethods[cheatType].name} (+${cheatState.winRateBoost}% win rate, ${cheatState.detectionRisk}% risk)`);
            }
        }
        
        function deactivateCheat() {
            cheatState.active = null;
            cheatState.winRateBoost = 0;
            cheatState.detectionRisk = 0;
            
            // Update UI
            document.querySelectorAll('.cheat-button').forEach(btn => btn.classList.remove('active'));
            document.getElementById('sidePanelCheatStatus').textContent = 'None';
            
            console.log('‚ùå Cheat deactivated');
        }
        
        // Payout Info Modal Functions
        function openPayoutInfoModal() {
            // Remove any existing modal
            const existingModal = document.getElementById('payoutInfoModal');
            if (existingModal) {
                existingModal.remove();
            }

            // Create the modal
            const modal = document.createElement('div');
            modal.id = 'payoutInfoModal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4';
            
            modal.innerHTML = `
                <div class="bg-dt-dark rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl border border-dt-cyan/30">
                    <!-- Header -->
                    <div class="sticky top-0 bg-dt-dark rounded-t-xl p-6 border-b border-dt-cyan/30 backdrop-blur-md">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center space-x-3">
                                <div class="w-10 h-10 bg-gradient-to-br from-dt-green to-dt-yellow rounded-full flex items-center justify-center">
                                    <span class="text-xl">üìä</span>
                                </div>
                                <div>
                                    <h2 class="text-2xl font-bold text-dt-cyan">üí∞ Slots Payout Matrix</h2>
                                    <p class="text-sm text-dt-light-gray">Complete winning combinations and payouts</p>
                                </div>
                            </div>
                            <button onclick="closePayoutInfoModal()" class="text-dt-light-gray hover:text-white transition-colors p-2 hover:bg-dt-gray/50 rounded-lg">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Content -->
                    <div class="p-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- Triple Matches -->
                            <div class="bg-gradient-to-br from-dt-green/10 to-dt-green/5 rounded-lg p-4 border border-dt-green/30">
                                <h4 class="text-lg font-bold text-dt-green mb-3 flex items-center">
                                    <span class="w-6 h-6 bg-dt-green rounded-full flex items-center justify-center text-xs mr-2">üéä</span>
                                    TRIPLE MATCHES (10x)
                                </h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üè¢üè¢üè¢</span>
                                            <span class="text-sm">Smartscape Triple</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">10x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üì±üì±üì±</span>
                                            <span class="text-sm">Application Triple</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">10x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üóÑÔ∏èüóÑÔ∏èüóÑÔ∏è</span>
                                            <span class="text-sm">Database Triple</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">10x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üñ•Ô∏èüñ•Ô∏èüñ•Ô∏è</span>
                                            <span class="text-sm">Server Triple</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">10x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>‚òÅÔ∏è‚òÅÔ∏è‚òÅÔ∏è</span>
                                            <span class="text-sm">Cloud Triple</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">10x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üõ°Ô∏èüõ°Ô∏èüõ°Ô∏è</span>
                                            <span class="text-sm">Security Triple</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">10x bet</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Double Matches -->
                            <div class="bg-gradient-to-br from-dt-blue/10 to-dt-blue/5 rounded-lg p-4 border border-dt-blue/30">
                                <h4 class="text-lg font-bold text-dt-blue mb-3 flex items-center">
                                    <span class="w-6 h-6 bg-dt-blue rounded-full flex items-center justify-center text-xs mr-2">üéØ</span>
                                    DOUBLE MATCHES (5x)
                                </h4>
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üè¢üè¢</span>
                                            <span class="text-sm">Smartscape Pair</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">5x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üì±üì±</span>
                                            <span class="text-sm">Application Pair</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">5x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üóÑÔ∏èüóÑÔ∏è</span>
                                            <span class="text-sm">Database Pair</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">5x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üñ•Ô∏èüñ•Ô∏è</span>
                                            <span class="text-sm">Server Pair</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">5x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>‚òÅÔ∏è‚òÅÔ∏è</span>
                                            <span class="text-sm">Cloud Pair</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">5x bet</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 px-3 bg-dt-dark/30 rounded-lg">
                                        <span class="flex items-center space-x-2">
                                            <span>üõ°Ô∏èüõ°Ô∏è</span>
                                            <span class="text-sm">Security Pair</span>
                                        </span>
                                        <span class="text-dt-yellow font-bold">5x bet</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Special Jackpot -->
                        <div class="mt-6 bg-gradient-to-r from-dt-purple/20 to-dt-cyan/20 rounded-lg p-6 border border-dt-purple/50">
                            <h4 class="text-xl font-bold text-dt-purple text-center mb-3 flex items-center justify-center">
                                <span class="w-8 h-8 bg-dt-purple rounded-full flex items-center justify-center text-lg mr-3">üíé</span>
                                MEGA JACKPOT
                            </h4>
                            <div class="text-center">
                                <div class="text-lg mb-2">
                                    <span class="text-dt-cyan font-semibold flex items-center justify-center space-x-1">
                                        <img src="/assets/slot-icons/dynatrace.png" alt="Dynatrace" class="inline-block w-6 h-6"/>
                                        <img src="/assets/slot-icons/dynatrace.png" alt="Dynatrace" class="inline-block w-6 h-6"/>
                                        <img src="/assets/slot-icons/dynatrace.png" alt="Dynatrace" class="inline-block w-6 h-6"/>
                                        <span class="ml-2">DYNATRACE MEGA JACKPOT</span>
                                    </span>
                                </div>
                                <div class="text-2xl">
                                    <span class="text-dt-yellow font-bold bg-dt-yellow/20 px-4 py-2 rounded-lg">50x BET!</span>
                                </div>
                                <div class="text-xs text-dt-light-gray mt-2">
                                    <span class="bg-dt-purple/20 px-2 py-1 rounded">Ultra Rare - 1% Chance</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Tips Section -->
                        <div class="mt-6 bg-gradient-to-r from-dt-gray/20 to-dt-dark/20 rounded-lg p-4 border border-dt-light-gray/20">
                            <h4 class="text-lg font-bold text-dt-orange mb-3">üí° Pro Tips</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-dt-light-gray">
                                <div class="flex items-center space-x-2">
                                    <span class="text-dt-green">‚Ä¢</span>
                                    <span>Doubles only count first two symbols</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span class="text-dt-purple">‚Ä¢</span>
                                    <span>Mega jackpot has only 1% chance</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span class="text-dt-cyan">‚Ä¢</span>
                                    <span>Higher multipliers take priority</span>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <span class="text-dt-yellow">‚Ä¢</span>
                                    <span>Bet more to win more!</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Add click outside to close
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closePayoutInfoModal();
                }
            });
            
            // Entrance animation
            const modalContent = modal.querySelector('.bg-dt-dark');
            modalContent.style.transform = 'scale(0.9)';
            modalContent.style.opacity = '0';
            
            setTimeout(() => {
                modalContent.style.transition = 'all 0.3s ease-out';
                modalContent.style.transform = 'scale(1)';
                modalContent.style.opacity = '1';
            }, 10);
        }
        
        function closePayoutInfoModal() {
            const modal = document.getElementById('payoutInfoModal');
            if (modal) {
                const modalContent = modal.querySelector('.bg-dt-dark');
                modalContent.style.transition = 'all 0.2s ease-in';
                modalContent.style.transform = 'scale(0.9)';
                modalContent.style.opacity = '0';
                
                setTimeout(() => {
                    modal.remove();
                }, 200);
            }
        }
        
        // SPA Router
        class VegasRouter {
            constructor() {
                this.routes = {
                    '/': 'entrance',
                    '/lobby': 'lobby',
                    '/slots': 'slots',
                    '/blackjack': 'blackjack',
                    '/dice': 'dice',
                    '/roulette': 'roulette'
                };
                this.currentRoute = '/';
                this.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            }
            
            init() {
                window.addEventListener('hashchange', () => this.handleRoute());
                this.handleRoute();
                this.createMatrixRain();
            }
            
            handleRoute() {
                const hash = window.location.hash.slice(1) || '/';
                const template = this.routes[hash] || 'entrance';
                this.loadTemplate(template);
            }
            
            loadTemplate(templateName) {
                const container = document.getElementById('app-container');
                const template = document.getElementById(`${templateName}-template`);
                
                if (template) {
                    container.innerHTML = template.innerHTML;
                    container.classList.remove('active');
                    setTimeout(() => {
                        container.classList.add('active');
                        this.initializeTemplate(templateName);
                    }, 50);
                }
            }
            
            initializeTemplate(templateName) {
                switch(templateName) {
                    case 'entrance':
                        this.createMatrixRain();
                        break;
                    case 'lobby':
                        this.updateUserDisplay();
                        break;
                    case 'slots':
                        // Initialize balance from localStorage to ensure it displays
                        this.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
                        console.log('üé∞ Slots initialized with balance:', this.balance, 'localStorage:', localStorage.getItem('vegasBalance'));
                        this.updateBalance('slotsBalance');
                        // Update username display
                        this.updateUsername('slotsUsername');
                        // Also ensure the initial symbols are visible
                        setTimeout(() => {
                            const reelSymbols = document.querySelectorAll('.reel-symbol');
                            reelSymbols.forEach(symbol => {
                                symbol.style.opacity = '1';
                                symbol.style.transform = 'translateY(0) scale(1)';
                            });
                        }, 100);
                        break;
                    case 'blackjack':
                        // Initialize blackjack game state with global balance
                        this.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
                        blackjackGame.balance = this.balance;
                        initializeDeck();
                        updateBlackjackUI();
                        updateGameStatus('Place your bet to start!', 'text-dt-green');
                        enableGameButtons(false);
                        document.getElementById('dealBtn').disabled = true;
                        // Update username and balance in top nav
                        this.updateUsername('blackjackUsername');
                        this.updateBalance('blackjackBalanceTop');
                        break;
                    case 'dice':
                        // Initialize dice game state with global balance
                        this.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
                        initializeDiceGame();
                        console.log('üé≤ Dice game loaded');
                        break;
                    case 'roulette':
                        // Initialize roulette game state with global balance
                        this.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
                        initializeRouletteGame();
                        console.log('üéØ Roulette game loaded');
                        break;
                }
            }
            
            updateUserDisplay() {
                const username = localStorage.getItem('vegasUsername') || 'Player';
                const welcomeEl = document.getElementById('userWelcome');
                const balanceEl = document.getElementById('userBalance');
                
                if (welcomeEl) welcomeEl.textContent = `Welcome, ${username}!`;
                if (balanceEl) balanceEl.textContent = `Balance: $${this.balance}`;
            }
            
            updateBalance(elementId) {
                const balanceEl = document.getElementById(elementId);
                if (balanceEl) balanceEl.textContent = `Balance: $${this.balance}`;
            }
            
            updateUsername(elementId) {
                const username = localStorage.getItem('vegasUsername') || 'Player';
                const usernameEl = document.getElementById(elementId);
                if (usernameEl) usernameEl.textContent = `Welcome, ${username}!`;
            }
            
            createMatrixRain() {
                const container = document.getElementById('matrixRain');
                if (!container) return;
                
                container.innerHTML = '';
                const chars = '01„Ç¢„Ç´„Çµ„Çø„Éä„Éè„Éû„É§„É©„ÉØ';
                const columns = Math.floor(window.innerWidth / 20);
                
                for (let i = 0; i < columns; i++) {
                    const char = document.createElement('div');
                    char.className = 'matrix-char';
                    char.style.left = `${i * 20}px`;
                    char.style.animationDelay = `${Math.random() * 2}s`;
                    char.style.animationDuration = `${3 + Math.random() * 2}s`;
                    char.textContent = chars[Math.floor(Math.random() * chars.length)];
                    container.appendChild(char);
                }
            }
        }
        
        // ===== LOCKOUT SYSTEM =====
        
        // Socket.IO event listeners for lockout notifications
        socket.on('connect', () => {
            console.log('üîå Connected to Vegas Casino server');
        });
        
        socket.on('user-lockout', (lockoutInfo) => {
            console.log('üö® Received lockout notification:', lockoutInfo);
            
            // Check if this lockout is for the current user
            const currentUser = localStorage.getItem('vegasUsername');
            if (lockoutInfo.username === currentUser) {
                console.log(`üîí Current user ${currentUser} has been locked out`);
                showLockoutScreen(lockoutInfo);
            }
        });
        
        socket.on('disconnect', () => {
            console.log('üì° Disconnected from Vegas Casino server');
        });
        
        // Show lockout screen
        function showLockoutScreen(lockoutInfo) {
            console.log('üö® Displaying lockout screen for:', lockoutInfo);
            
            isUserLocked = true;
            lockoutData = lockoutInfo;
            
            // Switch to lockout template
            const appContainer = document.getElementById('app');
            const lockoutTemplate = document.getElementById('lockout-template');
            
            if (appContainer && lockoutTemplate) {
                appContainer.innerHTML = lockoutTemplate.innerHTML;
                
                // Populate lockout data
                updateLockoutDisplay(lockoutInfo);
                
                // Create matrix rain effect for lockout screen
                createLockoutMatrixRain();
            }
        }
        
        // Update lockout display with data
        function updateLockoutDisplay(lockoutInfo) {
            const elements = {
                username: document.getElementById('lockoutUsername'),
                reason: document.getElementById('lockoutReason'),
                time: document.getElementById('lockoutTime'),
                violations: document.getElementById('lockoutViolations'),
                confiscated: document.getElementById('lockoutConfiscated'),
                balanceAdjustment: document.getElementById('lockoutBalanceAdjustment')
            };
            
            if (elements.username) elements.username.textContent = lockoutInfo.username || 'Unknown';
            if (elements.reason) elements.reason.textContent = lockoutInfo.reason || 'Security violation detected';
            if (elements.time) elements.time.textContent = new Date(lockoutInfo.timestamp).toLocaleString();
            
            // Handle cheat-specific data
            if (lockoutInfo.cheatData) {
                if (elements.violations) elements.violations.textContent = lockoutInfo.cheatData.violations || lockoutInfo.cheatData.totalViolations || 'Unknown';
                if (elements.confiscated) elements.confiscated.textContent = `$${lockoutInfo.cheatData.winningsConfiscated || lockoutInfo.cheatData.totalWinningsConfiscated || '0'}`;
                if (elements.balanceAdjustment) elements.balanceAdjustment.textContent = lockoutInfo.cheatData.balanceAdjustment || 'Unknown';
            } else {
                if (elements.violations) elements.violations.textContent = 'Unknown';
                if (elements.confiscated) elements.confiscated.textContent = '$0';
                if (elements.balanceAdjustment) elements.balanceAdjustment.textContent = 'Unknown';
            }
        }
        
        // Create matrix rain effect for lockout screen
        function createLockoutMatrixRain() {
            const matrixContainer = document.getElementById('lockoutMatrixRain');
            if (!matrixContainer) return;
            
            matrixContainer.innerHTML = ''; // Clear existing rain
            
            const characters = '01ÔΩ±ÔΩ≤ÔΩ≥ÔΩ¥ÔΩµÔΩ∂ÔΩ∑ÔΩ∏ÔΩπÔΩ∫ÔΩªÔΩºÔΩΩÔΩæÔΩøÔæÄÔæÅÔæÇÔæÉÔæÑÔæÖÔæÜÔæáÔæàÔæâÔæäÔæãÔæåÔæçÔæéÔæèÔæêÔæëÔæíÔæìÔæîÔæïÔæñÔæóÔæòÔæôÔæöÔæõÔæúÔæùüö®üíÄ‚ö†Ô∏èüîí';
            
            for (let i = 0; i < 30; i++) {
                const column = document.createElement('div');
                column.style.position = 'absolute';
                column.style.top = '0';
                column.style.left = Math.random() * 100 + '%';
                column.style.color = '#ff4444';
                column.style.fontSize = '14px';
                column.style.fontFamily = 'monospace';
                column.style.lineHeight = '1.2';
                column.style.animation = `matrixFall ${(Math.random() * 10 + 10)}s linear infinite`;
                column.style.animationDelay = Math.random() * 20 + 's';
                
                let columnText = '';
                for (let j = 0; j < 20; j++) {
                    columnText += characters[Math.floor(Math.random() * characters.length)] + '<br>';
                }
                column.innerHTML = columnText;
                
                matrixContainer.appendChild(column);
            }
        }
        
        // Check lockout status on page load
        function checkLockoutStatus() {
            const currentUser = localStorage.getItem('vegasUsername');
            if (!currentUser) return;
            
            // Check server for lockout status
            fetch(`/api/admin/lockout-status/${currentUser}`)
                .then(response => response.json())
                .then(data => {
                    console.log('üîç Lockout status check:', data);
                    if (data.locked) {
                        console.log('üö® User is already locked, showing lockout screen');
                        showLockoutScreen(data);
                    }
                })
                .catch(error => {
                    console.warn('‚ö†Ô∏è Failed to check lockout status:', error);
                });
        }
        
        // Global functions
        function navigateTo(route) {
            window.location.hash = route;
        }
        
        function enterCasino() {
            // Get form values
            const username = document.getElementById('usernameInput').value.trim();
            const email = document.getElementById('emailInput').value.trim();
            const companyName = document.getElementById('companyNameInput').value.trim();
            const personaSelect = document.getElementById('personaSelect').value;
            const customPersona = document.getElementById('customPersonaInput').value.trim();
            const booth = document.getElementById('boothSelect').value;
            const dataConsentRadio = document.querySelector('input[name="dataConsent"]:checked');
            
            // Basic validation
            if (!username) {
                alert('ERROR: CUSTOMER NAME REQUIRED');
                return;
            }
            
            if (username.length < 2) {
                alert('ERROR: CUSTOMER NAME TOO SHORT');
                return;
            }

            if (!email) {
                alert('ERROR: EMAIL ADDRESS REQUIRED');
                return;
            }

            // Email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                alert('ERROR: INVALID EMAIL FORMAT');
                return;
            }

            if (!companyName) {
                alert('ERROR: COMPANY NAME REQUIRED');
                return;
            }

            // Data consent validation
            if (!dataConsentRadio) {
                alert('ERROR: DATA CAPTURE CONSENT SELECTION REQUIRED');
                return;
            }
            
            const dataConsent = dataConsentRadio.value === 'true';

            // Determine final persona value
            const finalPersona = personaSelect === 'Other' ? customPersona : personaSelect;
            if (personaSelect === 'Other' && !customPersona) {
                alert('ERROR: CUSTOM PERSONA REQUIRED');
                return;
            }
            
            // Store user data
            const userData = {
                name: username,
                email: email,
                companyName: companyName,
                persona: finalPersona,
                booth: booth,
                dataConsent: dataConsent,
                registeredAt: new Date().toISOString()
            };
            
            localStorage.setItem('vegasUserData', JSON.stringify(userData));
            localStorage.setItem('vegasUsername', username);
            
            // Navigate to lobby
            navigateTo('/lobby');
        }
        
        function toggleCustomPersona() {
            const personaSelect = document.getElementById('personaSelect');
            const customPersonaInput = document.getElementById('customPersonaInput');
            
            if (personaSelect && customPersonaInput) {
                if (personaSelect.value === 'Other') {
                    customPersonaInput.classList.remove('hidden');
                    customPersonaInput.focus();
                } else {
                    customPersonaInput.classList.add('hidden');
                    customPersonaInput.value = '';
                }
            }
        }
        
        function signOut() {
            // Clear user data
            localStorage.removeItem('vegasUserData');
            localStorage.removeItem('vegasUsername');
            localStorage.removeItem('vegasBalance');
            
            // Reset balance
            router.balance = 5600;
            
            // Navigate back to entrance
            navigateTo('/');
        }
        
        function addMoney() {
            // Add $500 to balance
            router.balance += 500;
            localStorage.setItem('vegasBalance', router.balance.toString());
            
            // Update balance display based on current game
            if (window.location.hash.includes('slots')) {
                router.updateBalance('slotsBalance');
            } else if (window.location.hash.includes('blackjack')) {
                // Update blackjack game balance and UI
                blackjackGame.balance = router.balance;
                updateBlackjackUI();
                router.updateBalance('blackjackBalanceTop');
            }
            
            // Show visual feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = 'üí∞ Added!';
            button.style.background = 'linear-gradient(to right, #10B981, #34D399)';
            
            setTimeout(() => {
                button.textContent = originalText;
                button.style.background = '';
            }, 1000);
        }
        
        function spinSlots() {
            const betAmount = parseInt(document.getElementById('slotsBetAmount').value);
            
            // Sync balance from localStorage to ensure accuracy
            router.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            console.log('üé∞ Spin started with balance:', router.balance, 'Bet:', betAmount);
            
            if (router.balance < betAmount) {
                document.getElementById('slotsResult').textContent = 'Insufficient balance!';
                return;
            }
            
            // Disable spin button during spin
            const spinButton = document.getElementById('spinButton');
            spinButton.disabled = true;
            spinButton.textContent = 'üé∞ SPINNING...';
            
            // Clear previous results
            document.getElementById('slotsResult').textContent = '';
            document.getElementById('slotsWin').textContent = '';
            document.getElementById('cheatStatusDisplay').textContent = '';
            
            // Start reel animations - symbols moving down
            const reelSymbols = document.querySelectorAll('.reel-symbol');
            reelSymbols.forEach(symbol => {
                symbol.classList.add('spinning');
            });
            
            // Generate results after enhanced animation
            setTimeout(() => {
                const results = generateSlotResults();
                
                // Remove spinning animation and add drop-in effect
                reelSymbols.forEach(symbol => {
                    symbol.classList.remove('spinning');
                    symbol.classList.add('dropping');
                });
                
                // Update 3x3 grid display with new symbols dropping in
                for (let row = 1; row <= 3; row++) {
                    for (let col = 1; col <= 3; col++) {
                        const symbolIndex = (row - 1) * 3 + (col - 1);
                        const symbolElement = document.querySelector(`#symbol${row}-${col} div`);
                        if (symbolElement && results.grid[symbolIndex]) {
                            const symbol = results.grid[symbolIndex];
                            if (symbol.name === 'Dynatrace') {
                                // Special display for Dynatrace logo - using actual PNG image
                                symbolElement.innerHTML = '<img src="assets/slot-icons/dynatrace.png" alt="Dynatrace" style="width: 50px; height: 50px; object-fit: contain; filter: drop-shadow(0 0 10px rgba(108,44,156,0.8));">';
                            } else {
                                symbolElement.textContent = symbol.emoji;
                            }
                        }
                    }
                }
                
                // Remove drop-in animation after completion
                setTimeout(() => {
                    reelSymbols.forEach(symbol => {
                        symbol.classList.remove('dropping');
                    });
                }, 800);
                
                // Calculate and display results
                const winResult = calculateSlotWin(results.payline, betAmount);
                
                // Calculate new balance
                const originalBalance = router.balance;
                const newBalance = originalBalance - betAmount + winResult.winAmount;
                
                // Update balance
                router.balance = newBalance;
                localStorage.setItem('vegasBalance', newBalance.toString());
                
                console.log('üé∞ Balance Calculation Debug:', {
                    originalBalance: originalBalance,
                    betAmount: betAmount,
                    winAmount: winResult.winAmount,
                    calculatedNewBalance: newBalance,
                    routerBalance: router.balance,
                    localStorageBalance: localStorage.getItem('vegasBalance')
                });
                
                // Display results
                if (winResult.winAmount > 0) {
                    document.getElementById('slotsResult').textContent = winResult.message;
                    document.getElementById('slotsWin').textContent = `üéâ WON: $${winResult.winAmount} üéâ`;
                } else {
                    document.getElementById('slotsResult').textContent = 'Try again!';
                    document.getElementById('slotsWin').textContent = '';
                }
                
                // Show cheat status if active
                if (cheatState.active) {
                    document.getElementById('cheatStatusDisplay').textContent = 
                        `‚ö†Ô∏è Cheat Active: ${cheatMethods[cheatState.active].name}`;
                }
                
                // Update balance display
                router.updateBalance('slotsBalance');
                
                // Re-enable spin button
                spinButton.disabled = false;
                spinButton.textContent = 'üé∞ SPIN REELS üé∞';
                
                // Send to server (simulate) - use the calculated newBalance
                sendSlotResult(results.payline, betAmount, winResult.winAmount, newBalance, originalBalance);
                
            }, 1500);
        }
        
        function generateSlotResults() {
            // Apply cheat logic if active
            if (cheatState.active && Math.random() * 100 < cheatState.winRateBoost) {
                return generateWinningCombination();
            }
            
            // Normal random results - generate 3x3 grid
            const grid = [];
            for (let i = 0; i < 9; i++) {
                const randomSymbol = slotSymbols[Math.floor(Math.random() * slotSymbols.length)];
                grid.push(randomSymbol);
            }
            
            // Extract payline (middle row: positions 3, 4, 5)
            const payline = [grid[3], grid[4], grid[5]];
            
            return { grid, payline };
        }
        
        function generateWinningCombination() {
            // Generate 3x3 grid with winning payline
            const grid = [];
            
            // Fill non-payline positions with random symbols
            for (let i = 0; i < 9; i++) {
                if (i === 3 || i === 4 || i === 5) {
                    // Payline positions - will be set below
                    grid.push(null);
                } else {
                    grid.push(slotSymbols[Math.floor(Math.random() * slotSymbols.length)]);
                }
            }
            
            // Generate winning payline
            const rand = Math.random();
            let payline;
            
            if (rand < 0.1) {
                // 10% chance for jackpot
                payline = [dynatraceSymbol, dynatraceSymbol, dynatraceSymbol];
            } else if (rand < 0.4) {
                // 30% chance for triple
                const symbol = slotSymbols[Math.floor(Math.random() * slotSymbols.length)];
                payline = [symbol, symbol, symbol];
            } else {
                // 60% chance for double
                const symbol = slotSymbols[Math.floor(Math.random() * slotSymbols.length)];
                const other = slotSymbols[Math.floor(Math.random() * slotSymbols.length)];
                payline = [symbol, symbol, other];
            }
            
            // Set payline positions in grid
            grid[3] = payline[0];
            grid[4] = payline[1];
            grid[5] = payline[2];
            
            return { grid, payline };
        }
        
        function calculateSlotWin(payline, betAmount) {
            // Check for Dynatrace Jackpot first
            if (payline[0].name === 'Dynatrace' && payline[1].name === 'Dynatrace' && payline[2].name === 'Dynatrace') {
                return {
                    winAmount: betAmount * 50,
                    message: 'üíé DYNATRACE MEGA JACKPOT! üíé',
                    isWin: true
                };
            }
            
            // Check for triple matches
            if (payline[0].name === payline[1].name && payline[1].name === payline[2].name) {
                const payout = payoutMatrix.triple[payline[0].name];
                if (payout) {
                    return {
                        winAmount: betAmount * payout.multiplier,
                        message: `üéä ${payout.name}`,
                        isWin: true
                    };
                }
            }
            
            // Check for double matches
            if (payline[0].name === payline[1].name || payline[1].name === payline[2].name || payline[0].name === payline[2].name) {
                const matchingSymbol = payline[0].name === payline[1].name ? payline[0] :
                                     payline[1].name === payline[2].name ? payline[1] : payline[0];
                const payout = payoutMatrix.double[matchingSymbol.name];
                if (payout) {
                    return {
                        winAmount: betAmount * payout.multiplier,
                        message: `üéØ ${payout.name}`,
                        isWin: true
                    };
                }
            }
            
            return { winAmount: 0, message: '', isWin: false };
        }
        
        function sendSlotResult(payline, betAmount, winAmount, newBalance, originalBalance) {
            // Send game result to server
            const userData = JSON.parse(localStorage.getItem('vegas.customerData') || '{}');
            
            console.log('üé∞ SendSlotResult Debug:', {
                betAmount,
                winAmount, 
                newBalance,
                originalBalance,
                'calculation check': `${originalBalance} - ${betAmount} + ${winAmount} = ${originalBalance - betAmount + winAmount}`
            });
            
            const payload = {
                game: 'slots',
                action: 'spin',
                betAmount: betAmount,
                winAmount: winAmount,
                payline: payline.map(s => s.name),
                cheat: cheatState.active ? {
                    type: cheatState.active,
                    boost: cheatState.winRateBoost,
                    risk: cheatState.detectionRisk
                } : null,
                customerName: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                balance: originalBalance, // Original balance before bet
                newBalance: newBalance, // New balance after win/loss calculation
                // Add required fields for server logging
                Username: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                CustomerName: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                Email: userData.email || 'user@demo.com',
                CompanyName: userData.companyName || 'Demo Company',
                Persona: userData.persona || 'Demo User',
                Booth: userData.booth || 'UI Demo',
                OptIn: userData.optIn !== false,
                Balance: newBalance, // New balance after calculation
                BetAmount: betAmount,
                correlationId: 'ui_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                CheatActive: cheatState.active ? true : false,
                CheatType: cheatState.active || null,
                CheatDetails: cheatState.active ? {
                    winBoost: cheatState.winRateBoost / 100,
                    frequency: cheatState.detectionRisk / 100
                } : null
            };
            
            // Send to actual server API
            fetch('/api/slots/spin', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'User-Agent': 'Vegas-Casino-UI'
                },
                body: JSON.stringify(payload)
            }).then(response => response.json())
            .then(data => {
                console.log('üé∞ Slots Result sent to server:', data);
            }).catch(error => {
                console.error('‚ùå Error sending slots result:', error);
                // Fallback log
                console.log('üé∞ Slots Result (local):', payload);
            });
        }

        // ===== BLACKJACK CHEAT SYSTEM =====
        
        let blackjackCheatState = {
            active: null,
            winRateBoost: 0,
            detectionRisk: 0
        };
        
        const blackjackCheatMethods = {
            cardCounting: { 
                name: 'Card Counting', 
                winRateBoost: 40, 
                detectionRisk: 25,
                description: 'Track remaining high cards in deck'
            },
            dealerPeek: { 
                name: 'Dealer Hole Card', 
                winRateBoost: 50, 
                detectionRisk: 30,
                description: 'See dealer\'s hidden card'
            },
            luckyCards: { 
                name: 'Lucky Draw', 
                winRateBoost: 35, 
                detectionRisk: 20,
                description: 'Increase favorable card odds'
            }
        };
        
        function toggleBlackjackCheatSidePanel() {
            const panel = document.getElementById('blackjackCheatSidePanel');
            const btn = document.getElementById('blackjackCheatToggleBtn');
            
            if (panel.classList.contains('-translate-x-full')) {
                panel.classList.remove('-translate-x-full');
                btn.style.left = '320px';
            } else {
                panel.classList.add('-translate-x-full');
                btn.style.left = '1rem';
            }
        }
        
        function activateBlackjackCheat(cheatType) {
            const cheat = blackjackCheatMethods[cheatType];
            if (!cheat) return;
            
            // Implement specific cheat functionality
            if (cheatType === 'cardCounting') {
                activateCardCounting();
            } else if (cheatType === 'dealerPeek') {
                activateDealerPeek();
            } else if (cheatType === 'luckyCards') {
                activateLuckyDraw();
            }
            
            blackjackCheatState = {
                active: cheatType,
                winRateBoost: cheat.winRateBoost,
                detectionRisk: cheat.detectionRisk
            };
            
            // Update UI
            document.getElementById('blackjackSidePanelCheatStatus').textContent = cheat.name;
            document.getElementById('blackjackSidePanelCheatStatus').className = 'text-green-400';
            
            // Update button states
            document.querySelectorAll('#blackjackCheatSidePanel .cheat-button').forEach(btn => {
                btn.classList.remove('bg-green-600/60', 'border-green-400/70');
                btn.classList.add('bg-green-900/30', 'border-green-500/50');
            });
            
            const activeBtn = document.getElementById(`cheat${cheatType.charAt(0).toUpperCase() + cheatType.slice(1)}`);
            if (activeBtn) {
                activeBtn.classList.remove('bg-green-900/30', 'border-green-500/50');
                activeBtn.classList.add('bg-green-600/60', 'border-green-400/70');
            }
            
            logBlackjackAction('cheat-activated', { cheatType, winRateBoost: cheat.winRateBoost });
        }
        
        // Card Counting - Shows next 2 cards that will be dealt
        function activateCardCounting() {
            if (blackjackGame.deck.length >= 2) {
                const next1 = blackjackGame.deck[blackjackGame.deck.length - 1];
                const next2 = blackjackGame.deck[blackjackGame.deck.length - 2];
                
                // Create or update card counting preview
                let previewDiv = document.getElementById('cardCountingPreview');
                if (!previewDiv) {
                    previewDiv = document.createElement('div');
                    previewDiv.id = 'cardCountingPreview';
                    previewDiv.className = 'fixed top-20 right-4 bg-black/90 text-cyan-400 p-4 rounded-lg border-2 border-cyan-500 z-50 animate-pulse';
                    document.body.appendChild(previewDiv);
                }
                
                previewDiv.innerHTML = `
                    <div class="text-sm font-bold mb-3 text-center">üßÆ CARD COUNT PREVIEW</div>
                    <div class="flex space-x-4">
                        <div class="text-center bg-cyan-900/50 p-2 rounded">
                            <div class="text-2xl font-bold">${next1.value}${next1.suit}</div>
                            <div class="text-xs">Next Card</div>
                        </div>
                        <div class="text-center bg-cyan-900/50 p-2 rounded">
                            <div class="text-2xl font-bold">${next2.value}${next2.suit}</div>
                            <div class="text-xs">After That</div>
                        </div>
                    </div>
                    <div class="text-xs text-cyan-300 mt-2 text-center">Cards coming from deck</div>
                `;
                
                console.log(`üßÆ CARD COUNTING: Next cards are ${next1.value}${next1.suit} then ${next2.value}${next2.suit}`);
                
                // Remove after 8 seconds
                setTimeout(() => {
                    if (previewDiv) previewDiv.remove();
                }, 8000);
            }
        }
        
        // Dealer Peek - Shows dealer's hole card for 2 seconds
        function activateDealerPeek() {
            if (blackjackGame.gameState !== 'playing' || blackjackGame.dealerHand.length < 2) {
                updateGameStatusAnimated('‚ùå Dealer peek only works during play!', 'text-red-400');
                return;
            }
            
            const holeCard = blackjackGame.dealerHand[1];
            const dealerTotal = calculateHandValue(blackjackGame.dealerHand);
            
            // Create dealer peek display
            let peekDiv = document.getElementById('dealerPeekDisplay');
            if (!peekDiv) {
                peekDiv = document.createElement('div');
                peekDiv.id = 'dealerPeekDisplay';
                peekDiv.className = 'fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-red-900/95 text-white p-8 rounded-xl border-3 border-red-400 z-50 text-center animate-pulse shadow-2xl';
                document.body.appendChild(peekDiv);
            }
            
            peekDiv.innerHTML = `
                <div class="text-2xl font-bold mb-4">üëÅÔ∏è DEALER'S HOLE CARD</div>
                <div class="text-6xl mb-4 font-bold text-red-300">${holeCard.value}${holeCard.suit}</div>
                <div class="text-xl mb-2">Dealer Total: <span class="text-yellow-400">${dealerTotal}</span></div>
                <div class="text-sm text-red-200">Disappearing in 2 seconds...</div>
                <div class="mt-4 bg-red-800/50 p-2 rounded text-xs">
                    üîç CHEAT ACTIVATED
                </div>
            `;
            
            console.log(`üëÅÔ∏è DEALER PEEK: Hole card is ${holeCard.value}${holeCard.suit}, Total: ${dealerTotal}`);
            
            // Hide after 2 seconds
            setTimeout(() => {
                if (peekDiv) {
                    peekDiv.style.opacity = '0';
                    setTimeout(() => peekDiv.remove(), 300);
                }
            }, 2000);
        }
        
        // Lucky Draw - Increases odds of hitting 21
        function activateLuckyDraw() {
            // Visual feedback that lucky draw is now active
            let feedbackDiv = document.getElementById('luckyDrawFeedback');
            if (!feedbackDiv) {
                feedbackDiv = document.createElement('div');
                feedbackDiv.id = 'luckyDrawFeedback';
                feedbackDiv.className = 'fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-green-900/90 text-green-300 px-6 py-3 rounded-lg border-2 border-green-500 z-50 animate-bounce';
                document.body.appendChild(feedbackDiv);
            }
            
            feedbackDiv.innerHTML = `
                <div class="text-center">
                    <div class="text-lg font-bold">üçÄ LUCKY DRAW ACTIVATED!</div>
                    <div class="text-sm">Better odds of getting helpful cards</div>
                </div>
            `;
            
            console.log('üçÄ LUCKY DRAW: Activated - increased odds of hitting 21');
            
            // Remove feedback after 3 seconds
            setTimeout(() => {
                if (feedbackDiv) {
                    feedbackDiv.style.opacity = '0';
                    setTimeout(() => feedbackDiv.remove(), 300);
                }
            }, 3000);
        }
        
        function deactivateBlackjackCheat() {
            blackjackCheatState = {
                active: null,
                winRateBoost: 0,
                detectionRisk: 0
            };
            
            document.getElementById('blackjackSidePanelCheatStatus').textContent = 'None';
            document.getElementById('blackjackSidePanelCheatStatus').className = 'text-dt-yellow';
            
            // Reset button states
            document.querySelectorAll('#blackjackCheatSidePanel .cheat-button').forEach(btn => {
                btn.classList.remove('bg-green-600/60', 'border-green-400/70');
                btn.classList.add('bg-green-900/30', 'border-green-500/50');
            });
            
            logBlackjackAction('cheat-deactivated', {});
        }
        
        function applyBlackjackCheatBonus(baseOutcome) {
            if (!blackjackCheatState.active) return baseOutcome;
            
            const cheat = blackjackCheatMethods[blackjackCheatState.active];
            const boostChance = cheat.winRateBoost / 100;
            
            // Apply cheat logic based on type
            switch(blackjackCheatState.active) {
                case 'cardCounting':
                    // Improve player's odds of getting good cards
                    if (Math.random() < boostChance) {
                        return 'cheat-boosted-win';
                    }
                    break;
                case 'dealerPeek':
                    // Show dealer's hole card (implemented in UI)
                    if (Math.random() < boostChance) {
                        return 'cheat-peek-advantage';
                    }
                    break;
                case 'luckyCards':
                    // Better card draws
                    if (Math.random() < boostChance) {
                        return 'cheat-lucky-draw';
                    }
                    break;
            }
            
            return baseOutcome;
        }
        
        // ===== END BLACKJACK CHEAT SYSTEM =====
        
        // ===== BLACKJACK GAME LOGIC =====
        
        // Blackjack Game State
        let blackjackGame = {
            deck: [],
            playerHand: [],
            dealerHand: [],
            playerTotal: 0,
            dealerTotal: 0,
            currentBet: 0,
            balance: 1000, // This will be synced with global balance
            gameState: 'betting', // betting, playing, dealer-turn, game-over
            wins: 0,
            // Cheat previews
            nextCardsPeek: [],
            dealerPeekActive: false
        };
        
        // Card suits and values for observability-themed blackjack
        const suits = ['‚ô†Ô∏è', '‚ô•Ô∏è', '‚ô¶Ô∏è', '‚ô£Ô∏è'];
        const cardValues = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];
        const observabilityThemes = {
            'A': { name: 'APM', color: '#1496FF', icon: 'üì±' },
            '2': { name: 'Logs', color: '#73BE28', icon: 'üìù' },
            '3': { name: 'Metrics', color: '#FFD23F', icon: 'üìä' },
            '4': { name: 'Traces', color: '#FFA86B', icon: 'üîó' },
            '5': { name: 'Cloud', color: '#00D4FF', icon: '‚òÅÔ∏è' },
            '6': { name: 'Server', color: '#6C2C9C', icon: 'üñ•Ô∏è' },
            '7': { name: 'Database', color: '#73BE28', icon: 'üóÑÔ∏è' },
            '8': { name: 'Security', color: '#FFA86B', icon: 'üõ°Ô∏è' },
            '9': { name: 'Network', color: '#00D4FF', icon: 'üåê' },
            '10': { name: 'Alerts', color: '#FF6B6B', icon: 'üö®' },
            'J': { name: 'DevOps', color: '#FFD23F', icon: '‚öôÔ∏è' },
            'Q': { name: 'SRE', color: '#6C2C9C', icon: 'üëë' },
            'K': { name: 'Dynatrace', color: '#6C2C9C', icon: 'DT' }
        };
        
        function initializeDeck() {
            blackjackGame.deck = [];
            for (let suit of suits) {
                for (let value of cardValues) {
                    blackjackGame.deck.push({ value, suit, theme: observabilityThemes[value] });
                }
            }
            shuffleDeck();
        }
        
        function shuffleDeck() {
            for (let i = blackjackGame.deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [blackjackGame.deck[i], blackjackGame.deck[j]] = [blackjackGame.deck[j], blackjackGame.deck[i]];
            }
        }
        
        function drawCard() {
            if (blackjackGame.deck.length < 10) {
                initializeDeck(); // Reshuffle when deck is low
            }
            
            let card = blackjackGame.deck.pop();
            
            // Apply lucky draw cheat - increases odds of hitting 21
            if (blackjackCheatState.active === 'luckyCards' && blackjackGame.gameState === 'playing') {
                const playerTotal = blackjackGame.playerTotal;
                const needed = 21 - playerTotal;
                
                // 55% chance to get a helpful card when lucky draw is active
                if (Math.random() < 0.55 && needed > 0 && needed <= 11) {
                    const helpfulCards = blackjackGame.deck.filter(c => {
                        const cardValue = getCardValue(c, playerTotal);
                        return cardValue === needed || (needed > cardValue && cardValue > 0);
                    });
                    
                    if (helpfulCards.length > 0) {
                        const helpfulCard = helpfulCards[Math.floor(Math.random() * helpfulCards.length)];
                        const helpfulIndex = blackjackGame.deck.indexOf(helpfulCard);
                        if (helpfulIndex !== -1) {
                            blackjackGame.deck.splice(helpfulIndex, 1);
                            blackjackGame.deck.push(card); // Put original card back
                            card = helpfulCard;
                            logBlackjackAction('cheat-lucky-card', { originalCard: card, betterCard: helpfulCard });
                        }
                    }
                }
            }
            
            console.log('üÉè DEBUG - Drew card:', card.value + card.suit, 'Value:', getCardValue(card));
            return card;
        }
        
        function getCardValue(card) {
            if (['J', 'Q', 'K'].includes(card.value)) return 10;
            if (card.value === 'A') return 11; // Aces handled separately
            return parseInt(card.value);
        }
        
        function calculateHandValue(hand) {
            let value = 0;
            let aces = 0;
            
            for (let card of hand) {
                if (card.value === 'A') {
                    aces++;
                    value += 11;
                } else {
                    value += getCardValue(card);
                }
            }
            
            // Adjust for aces
            while (value > 21 && aces > 0) {
                value -= 10;
                aces--;
            }
            
            return value;
        }
        
        function placeBet(amount) {
            if (blackjackGame.gameState !== 'betting') return;
            
            // Sync with global balance
            blackjackGame.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            
            if (amount > blackjackGame.balance) {
                updateGameStatus('Insufficient balance!', 'text-red-500');
                return;
            }
            
            // Add to current bet (accumulate bets)
            blackjackGame.currentBet += amount;
            blackjackGame.balance -= amount;
            
            // Check if total bet exceeds balance
            if (blackjackGame.currentBet > parseInt(localStorage.getItem('vegasBalance') || '5600')) {
                // Revert the bet if it would exceed original balance
                blackjackGame.currentBet -= amount;
                blackjackGame.balance += amount;
                updateGameStatus('Total bet would exceed balance!', 'text-red-500');
                return;
            }
            
            // Update global balance
            router.balance = blackjackGame.balance;
            localStorage.setItem('vegasBalance', router.balance.toString());
            
            updateBlackjackUI();
            router.updateBalance('blackjackBalanceTop'); // Update top nav balance
            updateGameStatus(`Total bet: $${blackjackGame.currentBet}. Deal cards to start!`, 'text-dt-green');
            
            // Enable deal button
            document.getElementById('dealBtn').disabled = false;
        }
        
        function dealCards() {
            if (blackjackGame.currentBet === 0) return;
            
            // Send deal request to server
            sendBlackjackDeal();
            
            initializeDeck();
            blackjackGame.playerHand = [];
            blackjackGame.dealerHand = [];
            blackjackGame.gameState = 'playing';

            // Deal initial cards
            blackjackGame.playerHand.push(drawCard());
            blackjackGame.dealerHand.push(drawCard());
            blackjackGame.playerHand.push(drawCard());
            blackjackGame.dealerHand.push(drawCard()); // Hidden card

            // Calculate totals properly
            blackjackGame.playerTotal = calculateHandValue(blackjackGame.playerHand);
            blackjackGame.dealerTotal = calculateHandValue([blackjackGame.dealerHand[0]]); // Only first card for display

            // Update UI and render cards
            updateBlackjackUI();
            renderCards();

            console.log('üÉè DEBUG - Player hand:', blackjackGame.playerHand, 'Total:', blackjackGame.playerTotal);
            console.log('üÉè DEBUG - Dealer visible card:', blackjackGame.dealerHand[0], 'Visible total:', blackjackGame.dealerTotal);

            // Check for blackjack (natural 21 with 2 cards)
            if (blackjackGame.playerTotal === 21 && blackjackGame.playerHand.length === 2) {
                updateGameStatus('BLACKJACK! üÉè', 'text-dt-yellow');
                endGame('blackjack');
            } else {
                updateGameStatus('Your turn! Hit or Stand?', 'text-dt-cyan');
                enableGameButtons(true);
            }
            
            document.getElementById('dealBtn').disabled = true;
            
            // Log the game start
            logBlackjackAction('deal', { 
                bet: blackjackGame.currentBet, 
                playerTotal: blackjackGame.playerTotal,
                playerCards: blackjackGame.playerHand.map(c => c.value + c.suit),
                dealerCard: blackjackGame.dealerHand[0].value + blackjackGame.dealerHand[0].suit
            });
        }
        
        function hitCard() {
            if (blackjackGame.gameState !== 'playing') return;
            
            updateGameStatusAnimated('Drawing card...', 'text-dt-cyan');
            
            setTimeout(() => {
                const card = drawCard();
                blackjackGame.playerHand.push(card);
                blackjackGame.playerTotal = calculateHandValue(blackjackGame.playerHand);
                
                console.log('üÉè DEBUG - Hit card:', card.value + card.suit, 'New total:', blackjackGame.playerTotal);
                
                renderCards();
                updateBlackjackUI();
                
                setTimeout(() => {
                    if (blackjackGame.playerTotal > 21) {
                        updateGameStatusAnimated('üíî BUST! You went over 21! üíî', 'text-red-400 animate-pulse');
                        endGame('bust');
                    } else if (blackjackGame.playerTotal === 21) {
                        updateGameStatusAnimated('üåü Perfect 21! Standing automatically üåü', 'text-yellow-400 animate-pulse');
                        setTimeout(() => standPlayer(), 1500);
                    } else {
                        updateGameStatusAnimated(`You have ${blackjackGame.playerTotal}. Hit or Stand?`, 'text-dt-cyan');
                    }
                }, 800);
            }, 400);
            
            logBlackjackAction('hit', { 
                playerTotal: blackjackGame.playerTotal,
                cardDrawn: card.value + card.suit,
                handSize: blackjackGame.playerHand.length
            });
        }
        
        function standPlayer() {
            if (blackjackGame.gameState !== 'playing') return;
            
            blackjackGame.gameState = 'dealer-turn';
            enableGameButtons(false);
            
            // Reveal dealer's hidden card
            blackjackGame.dealerTotal = calculateHandValue(blackjackGame.dealerHand);
            
            // Show dealer peek cheat if active
            if (blackjackCheatState.active === 'dealerPeek') {
                updateGameStatus(`üïµÔ∏è CHEAT: Dealer has ${blackjackGame.dealerHand[1].value}${blackjackGame.dealerHand[1].suit} (Total: ${blackjackGame.dealerTotal})`, 'text-green-400');
                setTimeout(() => updateGameStatus('Dealer\'s turn...', 'text-dt-orange'), 2000);
            } else {
                updateGameStatus('Dealer\'s turn...', 'text-dt-orange');
            }
            
            // Dealer hits on 16 or less
            setTimeout(() => dealerPlay(), 1000);
            
            logBlackjackAction('stand', { playerTotal: blackjackGame.playerTotal, dealerTotal: blackjackGame.dealerTotal, cheatActive: blackjackCheatState.active });
        }
        
        function dealerPlay() {
            updateGameStatus('Revealing dealer\'s card...', 'text-dt-orange');
            
            // Animate dealer card reveal
            setTimeout(() => {
                renderCards(true); // Show dealer's hidden card
                updateBlackjackUI();
                
                setTimeout(() => {
                    // Continue dealer play
                    dealerDrawCards();
                }, 1000);
            }, 500);
        }
        
        function dealerDrawCards() {
            if (blackjackGame.dealerTotal < 17) {
                updateGameStatus(`Dealer has ${blackjackGame.dealerTotal}, drawing card...`, 'text-dt-orange');
                
                setTimeout(() => {
                    const card = drawCard();
                    blackjackGame.dealerHand.push(card);
                    blackjackGame.dealerTotal = calculateHandValue(blackjackGame.dealerHand);
                    
                    renderCards(true);
                    updateBlackjackUI();
                    
                    // Continue drawing if needed
                    setTimeout(() => dealerDrawCards(), 1200);
                }, 800);
            } else {
                // Dealer is done, determine winner
                setTimeout(() => {
                    if (blackjackGame.dealerTotal > 21) {
                        updateGameStatus('Dealer BUST! You win! üéâ', 'text-dt-green');
                        endGame('dealer-bust');
                    } else if (blackjackGame.dealerTotal > blackjackGame.playerTotal) {
                        updateGameStatus('Dealer wins üòû', 'text-red-500');
                        endGame('dealer-win');
                    } else if (blackjackGame.playerTotal > blackjackGame.dealerTotal) {
                        updateGameStatus('You win! üéâ', 'text-dt-green');
                        endGame('player-win');
                    } else {
                        updateGameStatus('Push! It\'s a tie ü§ù', 'text-dt-yellow');
                        endGame('push');
                    }
                }, 1000);
            }
        }
        
        function endGame(result) {
            blackjackGame.gameState = 'game-over';
            enableGameButtons(false);
            
            let winAmount = 0;
            let resultMessage = '';
            let resultColor = '';
            
            switch (result) {
                case 'blackjack':
                    winAmount = Math.floor(blackjackGame.currentBet * 2.5);
                    blackjackGame.wins++;
                    resultMessage = `üéâ BLACKJACK! You win $${winAmount}! üéâ`;
                    resultColor = 'text-yellow-400';
                    break;
                case 'player-win':
                    winAmount = blackjackGame.currentBet * 2;
                    blackjackGame.wins++;
                    resultMessage = `üéä YOU WIN! +$${winAmount} üéä`;
                    resultColor = 'text-green-400';
                    break;
                case 'dealer-bust':
                    winAmount = blackjackGame.currentBet * 2;
                    blackjackGame.wins++;
                    resultMessage = `üí• DEALER BUST! You win $${winAmount}! üí•`;
                    resultColor = 'text-green-400';
                    break;
                case 'push':
                    winAmount = blackjackGame.currentBet;
                    resultMessage = `ü§ù PUSH! Bet returned: $${winAmount} ü§ù`;
                    resultColor = 'text-blue-400';
                    break;
                case 'bust':
                    winAmount = 0;
                    resultMessage = `üíî BUST! You lose $${blackjackGame.currentBet} üíî`;
                    resultColor = 'text-red-400';
                    break;
                default:
                    winAmount = 0;
                    resultMessage = `üòû DEALER WINS! You lose $${blackjackGame.currentBet} üòû`;
                    resultColor = 'text-red-400';
                    break;
            }
            
            blackjackGame.balance += winAmount;
            
            // Calculate amounts for server reporting
            const finalWinAmount = winAmount > blackjackGame.currentBet ? winAmount - blackjackGame.currentBet : 0;
            const lossAmount = winAmount === 0 ? blackjackGame.currentBet : 0;
            
            // Send result to server
            let serverResult = result;
            if (result === 'player-win' || result === 'dealer-bust') serverResult = 'win';
            if (result === 'bust' || result === 'dealer-win') serverResult = 'lose';
            sendBlackjackResult(serverResult, finalWinAmount, lossAmount);
            
            // Update global balance
            router.balance = blackjackGame.balance;
            localStorage.setItem('vegasBalance', router.balance.toString());
            
            // Show result with animation
            updateGameStatus(resultMessage, resultColor);
            
            // Add celebration effect for wins
            if (['blackjack', 'player-win', 'dealer-bust'].includes(result)) {
                const statusElement = document.getElementById('gameStatus');
                statusElement.style.animation = 'pulse 0.5s ease-in-out 3';
            }
            
            updateBlackjackUI();
            router.updateBalance('blackjackBalanceTop'); // Update top nav balance
            
            
            // Show results for 4 seconds, then reset
            setTimeout(() => {
                updateGameStatus('Preparing new hand...', 'text-dt-cyan');
                
                // Animate cards out
                const allCards = document.querySelectorAll('.card-element');
                allCards.forEach((card, index) => {
                    setTimeout(() => {
                        card.style.transition = 'all 0.3s ease-in';
                        card.style.opacity = '0';
                        card.style.transform = 'translateY(20px) scale(0.8)';
                    }, index * 50);
                });
                
                // Reset game state after cards animate out
                setTimeout(() => {
                    blackjackGame.gameState = 'betting';
                    blackjackGame.currentBet = 0;
                    blackjackGame.playerHand = [];
                    blackjackGame.dealerHand = [];
                    blackjackGame.playerTotal = 0;
                    blackjackGame.dealerTotal = 0;
                    
                    // Clear the table with smooth transition
                    document.getElementById('playerCards').innerHTML = `
                        <div class="casino-card-placeholder w-24 h-36 rounded-lg flex items-center justify-center animate-fadeInUp" style="background: linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%); border: 2px dashed rgba(0,255,255,0.3);">
                            <span class="text-cyan-600/50 text-xs font-bold">YOUR</span>
                        </div>
                        <div class="casino-card-placeholder w-24 h-36 rounded-lg flex items-center justify-center animate-fadeInUp" style="background: linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%); border: 2px dashed rgba(0,255,255,0.3);">
                            <span class="text-cyan-600/50 text-xs font-bold">CARDS</span>
                        </div>
                    `;
                    
                    document.getElementById('dealerCards').innerHTML = `
                        <div class="casino-card-placeholder w-24 h-36 rounded-lg flex items-center justify-center animate-fadeInUp" style="background: linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%); border: 2px dashed rgba(255,215,0,0.3);">
                            <span class="text-yellow-600/50 text-xs font-bold">DEALER</span>
                        </div>
                        <div class="casino-card-placeholder w-24 h-36 rounded-lg flex items-center justify-center animate-fadeInUp" style="background: linear-gradient(135deg, #1a1a1a 0%, #333 50%, #1a1a1a 100%); border: 2px dashed rgba(255,215,0,0.3);">
                            <span class="text-yellow-600/50 text-xs font-bold">CARDS</span>
                        </div>
                    `;
                    
                    document.getElementById('dealBtn').disabled = true;
                    enableGameButtons(false);
                    updateBlackjackUI();
                    updateGameStatus('Place your bet to start a new hand!', 'text-dt-green');
                }, 800);
            }, 4000);
            
            logBlackjackAction('game-end', { result, winAmount, finalBalance: blackjackGame.balance });
        }
        
        function renderCards(showDealerHidden = false) {
            // Render player cards with staggered animation
            const playerCardsContainer = document.getElementById('playerCards');
            playerCardsContainer.innerHTML = '';
            
            blackjackGame.playerHand.forEach((card, index) => {
                const cardElement = createCardElement(card);
                cardElement.style.opacity = '0';
                cardElement.style.transform = 'translateY(-20px) scale(0.8)';
                cardElement.style.animationDelay = `${index * 0.3}s`;
                playerCardsContainer.appendChild(cardElement);
                
                // Animate card in
                setTimeout(() => {
                    cardElement.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
                    cardElement.style.opacity = '1';
                    cardElement.style.transform = 'translateY(0) scale(1)';
                }, index * 300 + 100);
            });
            
            // Render dealer cards with staggered animation
            const dealerCardsContainer = document.getElementById('dealerCards');
            dealerCardsContainer.innerHTML = '';
            
            blackjackGame.dealerHand.forEach((card, index) => {
                let cardElement;
                if (index === 1 && !showDealerHidden && blackjackGame.gameState === 'playing') {
                    // Hidden card
                    cardElement = createHiddenCard();
                } else {
                    cardElement = createCardElement(card);
                }
                
                cardElement.style.opacity = '0';
                cardElement.style.transform = 'translateY(-20px) scale(0.8)';
                cardElement.style.animationDelay = `${index * 0.3}s`;
                dealerCardsContainer.appendChild(cardElement);
                
                // Animate card in
                setTimeout(() => {
                    cardElement.style.transition = 'all 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
                    cardElement.style.opacity = '1';
                    cardElement.style.transform = 'translateY(0) scale(1)';
                }, index * 300 + 50);
            });
        }
        
        function createCardElement(card) {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'card-element w-24 h-36 rounded-lg border border-gray-800 flex flex-col items-center justify-between text-black font-bold transition-all duration-300 hover:scale-105 animate-fadeInUp shadow-lg';
            
            // Realistic card background
            cardDiv.style.background = 'linear-gradient(145deg, #f8f9fa 0%, #ffffff 50%, #f1f3f4 100%)';
            cardDiv.style.border = '2px solid #333';
            cardDiv.style.boxShadow = '0 4px 8px rgba(0,0,0,0.3), inset 0 1px 0 rgba(255,255,255,0.8)';
            
            // Determine card color
            const isRed = card.suit === '‚ô•Ô∏è' || card.suit === '‚ô¶Ô∏è';
            const cardColor = isRed ? '#dc2626' : '#000000';
            
            cardDiv.innerHTML = `
                <div class="text-left text-xs font-bold p-1 self-start" style="color: ${cardColor}; line-height: 1;">
                    <div>${card.value}</div>
                    <div style="margin-top: -2px;">${card.suit}</div>
                </div>
                <div class="text-center flex-1 flex items-center justify-center">
                    <div class="text-2xl" style="color: ${cardColor};">${card.suit}</div>
                </div>
                <div class="text-right text-xs font-bold p-1 self-end transform rotate-180" style="color: ${cardColor}; line-height: 1;">
                    <div>${card.value}</div>
                    <div style="margin-top: -2px;">${card.suit}</div>
                </div>
            `;
            
            return cardDiv;
        }
        
        function createHiddenCard() {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'card-element w-24 h-36 rounded-lg border border-gray-800 flex items-center justify-center animate-fadeInUp shadow-lg';
            cardDiv.style.background = 'linear-gradient(45deg, #1e40af 0%, #3b82f6 25%, #1e40af 50%, #3b82f6 75%, #1e40af 100%)';
            cardDiv.style.backgroundSize = '20px 20px';
            cardDiv.style.border = '2px solid #333';
            cardDiv.style.boxShadow = '0 4px 8px rgba(0,0,0,0.3)';
            cardDiv.innerHTML = `
                <div class="text-white text-lg font-bold">üÉè</div>
            `;
            return cardDiv;
        }
        
        function updateBlackjackUI() {
            // Sync with global balance first
            blackjackGame.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            
            console.log('üÉè DEBUG - Updating UI with totals:', {
                playerTotal: blackjackGame.playerTotal,
                dealerTotal: blackjackGame.dealerTotal,
                gameState: blackjackGame.gameState,
                playerHand: blackjackGame.playerHand
            });
            
            document.getElementById('blackjackBalance').textContent = `$${blackjackGame.balance}`;
            document.getElementById('blackjackBet').textContent = `$${blackjackGame.currentBet}`;
            document.getElementById('blackjackWins').textContent = blackjackGame.wins;
            document.getElementById('playerTotal').textContent = blackjackGame.playerTotal || '--';
            
            // Update top navigation balance as well
            const topBalanceEl = document.getElementById('blackjackBalanceTop');
            if (topBalanceEl) {
                topBalanceEl.textContent = `Balance: $${blackjackGame.balance}`;
            }
            
            // Only show dealer total if game is over or dealer is playing
            if (blackjackGame.gameState === 'dealer-turn' || blackjackGame.gameState === 'game-over') {
                document.getElementById('dealerTotal').textContent = blackjackGame.dealerTotal;
            } else {
                document.getElementById('dealerTotal').textContent = blackjackGame.gameState === 'playing' ? blackjackGame.dealerTotal : '--';
            }
        }
        
        function updateGameStatus(message, className = 'text-dt-green') {
            const statusElement = document.getElementById('gameStatus');
            if (statusElement) {
                statusElement.textContent = message;
                statusElement.className = `text-2xl font-bold ${className} min-h-[2rem] transition-all duration-300 drop-shadow-lg`;
            }
        }
        
        // Enhanced status update with animation
        function updateGameStatusAnimated(message, className = 'text-dt-green', showTime = 3000) {
            const statusElement = document.getElementById('gameStatus');
            if (statusElement) {
                // Fade out current message
                statusElement.style.opacity = '0.3';
                statusElement.style.transform = 'scale(0.95)';
                
                setTimeout(() => {
                    statusElement.textContent = message;
                    statusElement.className = `text-2xl font-bold ${className} min-h-[2rem] transition-all duration-500 drop-shadow-lg`;
                    
                    // Fade in with scale effect
                    statusElement.style.opacity = '1';
                    statusElement.style.transform = 'scale(1)';
                    
                    // Add glow effect for special messages
                    if (className.includes('yellow') || className.includes('green') || className.includes('red')) {
                        statusElement.style.textShadow = '0 0 15px currentColor';
                        statusElement.style.animation = 'pulse 0.6s ease-in-out 2';
                        
                        setTimeout(() => {
                            statusElement.style.textShadow = '2px 2px 6px rgba(0,0,0,0.7)';
                            statusElement.style.animation = 'none';
                        }, showTime);
                    }
                }, 200);
            }
        }
        
        function enableGameButtons(enabled) {
            document.getElementById('hitBtn').disabled = !enabled;
            document.getElementById('standBtn').disabled = !enabled;
        }
        
        function logBlackjackAction(action, data) {
            const logEntry = `[${new Date().toLocaleTimeString()}] ${action.toUpperCase()}: ${JSON.stringify(data)}`;
            
            const logContainer = document.getElementById('blackjackLog');
            const logElement = document.createElement('div');
            logElement.className = 'text-xs text-dt-gray mb-1';
            logElement.textContent = logEntry;
            
            logContainer.appendChild(logElement);
            logContainer.scrollTop = logContainer.scrollHeight;
            
            // Send to server for logging
            sendBlackjackResult(action, data);
        }
        
        function sendBlackjackResult(action, data) {
            const user = JSON.parse(localStorage.getItem('vegasUser') || '{}');
            const timestamp = new Date().toISOString();
            
            const payload = {
                timestamp,
                game: 'blackjack',
                action,
                player: user.username || 'guest',
                email: user.email || 'guest@vegas.com',
                company: user.companyName || 'Vegas Casino',
                persona: user.persona || 'High Roller',
                booth: user.booth || 'VIP',
                balance: blackjackGame.balance,
                currentBet: blackjackGame.currentBet,
                ...data
            };
            
            fetch('/api/blackjack/action', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'User-Agent': 'Vegas-Casino-UI'
                },
                body: JSON.stringify(payload)
            }).then(response => response.json())
            .then(data => {
                console.log('üÉè Blackjack action logged:', data);
            }).catch(error => {
                console.error('‚ùå Error logging blackjack action:', error);
            });
        }

        // Send blackjack deal request to server
        function sendBlackjackDeal() {
            const userData = JSON.parse(localStorage.getItem('vegas.customerData') || '{}');
            
            const payload = {
                Username: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                CustomerName: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                Email: userData.email || 'user@demo.com',
                CompanyName: userData.companyName || 'Demo Company',
                Persona: userData.persona || 'Demo User',
                Booth: userData.booth || 'UI Demo',
                OptIn: userData.optIn !== false,
                BetAmount: blackjackGame.currentBet,
                balance: blackjackGame.balance, // Send current balance
                Balance: blackjackGame.balance,
                Game: 'Vegas Blackjack',
                Action: 'Deal',
                GameState: 'Started',
                Device: 'Browser-UI',
                CheatActive: false,
                CheatType: null,
                CheatDetails: null,
                correlationId: 'ui_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9)
            };

            console.log('üÉè Sending blackjack deal request:', payload);

            fetch('/api/blackjack/deal', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'User-Agent': 'Vegas-Casino-UI'
                },
                body: JSON.stringify(payload)
            }).then(response => response.json())
            .then(data => {
                console.log('üÉè Blackjack deal response:', data);
            }).catch(error => {
                console.error('‚ùå Error sending blackjack deal:', error);
            });
        }

        // Send blackjack result to server
        function sendBlackjackResult(result, winAmount = 0, lossAmount = 0) {
            const userData = JSON.parse(localStorage.getItem('vegas.customerData') || '{}');
            
            const payload = {
                Username: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                CustomerName: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                Email: userData.email || 'user@demo.com',
                CompanyName: userData.companyName || 'Demo Company',
                Persona: userData.persona || 'Demo User',
                Booth: userData.booth || 'UI Demo',
                OptIn: userData.optIn !== false,
                BetAmount: blackjackGame.currentBet,
                balance: blackjackGame.balance - winAmount + lossAmount, // Original balance before win/loss
                newBalance: blackjackGame.balance,
                Balance: blackjackGame.balance,
                Game: 'Vegas Blackjack',
                Action: 'GameResult',
                GameState: 'Completed',
                Result: result, // 'win', 'lose', 'push', 'blackjack'
                PlayerTotal: blackjackGame.playerTotal,
                DealerTotal: calculateHandValue(blackjackGame.dealerHand),
                WinAmount: winAmount,
                LossAmount: lossAmount,
                WinFlag: winAmount > 0 ? 1 : 0,
                LossFlag: lossAmount > 0 ? 1 : 0,
                BlackjackFlag: result === 'blackjack' ? 1 : 0,
                PushFlag: result === 'push' ? 1 : 0,
                Device: 'Browser-UI',
                CheatActive: false,
                CheatType: null,
                CheatDetails: null,
                correlationId: 'ui_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                timestamp: new Date().toISOString()
            };

            console.log('üÉè Sending blackjack result:', payload);

            fetch('/api/blackjack/deal', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'User-Agent': 'Vegas-Casino-UI'
                },
                body: JSON.stringify(payload)
            }).then(response => response.json())
            .then(data => {
                console.log('üÉè Blackjack result response:', data);
            }).catch(error => {
                console.error('‚ùå Error sending blackjack result:', error);
            });
        }
        
        // Initialize blackjack when template loads
        document.addEventListener('DOMContentLoaded', () => {
            // Load blackjack state from localStorage if available
            const savedState = localStorage.getItem('blackjackGameState');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                blackjackGame.wins = parsed.wins || 0;
                // Don't load balance from saved state - use global balance instead
            }
            
            // Sync with global balance
            blackjackGame.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            updateBlackjackUI();
        });
        
        // Save blackjack state periodically (but not balance - that's handled globally)
        setInterval(() => {
            localStorage.setItem('blackjackGameState', JSON.stringify({
                wins: blackjackGame.wins
                // Note: balance is handled by global vegasBalance in localStorage
            }));
        }, 5000);
        
        // ===== END BLACKJACK GAME LOGIC =====
        
        // ==================== DICE GAME FUNCTIONALITY ====================
        
        // Dice Game State
        let diceGame = {
            balance: 1000,
            currentBet: 0,
            betType: null,
            payout: 0,
            dice1: 0,
            dice2: 0,
            total: 0,
            totalRolls: 0,
            totalWins: 0,
            totalWon: 0,
            isRolling: false
        };
        
        // Dice Cheat Methods
        const diceCheatMethods = {
            luckyRolls: { 
                name: 'Lucky Rolls', 
                winRateBoost: 0.7, 
                detectionRisk: 0.3,
                description: 'Generally favorable dice outcomes'
            },
            loadedDice: { 
                name: 'Loaded Dice', 
                winRateBoost: 0.85, 
                detectionRisk: 0.7,
                description: 'Biases dice toward higher numbers'
            },
            doubleDown: { 
                name: 'Double Down', 
                winRateBoost: 0, 
                detectionRisk: 0.5,
                multiplier: 2,
                description: 'Doubles all winnings'
            }
        };
        
        let diceCheatState = {
            active: null,
            winRateBoost: 0,
            detectionRisk: 0
        };
        
        // Initialize Dice Game
        function initializeDiceGame() {
            diceGame.balance = router.balance;
            updateDiceUI();
            updateDiceGameStatus('Choose your bet and roll the dice!', 'text-dt-cyan');
            
            // Update top navigation
            document.getElementById('diceUsernameTop').textContent = router.username;
            document.getElementById('diceBalanceTop').textContent = router.balance;
            
            console.log('üé≤ Dice game initialized');
        }
        
        // Toggle Dice Cheat Panel
        function toggleDiceCheatPanel() {
            const panel = document.getElementById('diceCheatSidePanel');
            const isOpen = panel.style.transform === 'translateX(0px)';
            
            if (isOpen) {
                panel.style.transform = 'translateX(-100%)';
            } else {
                panel.style.transform = 'translateX(0px)';
            }
        }
        
        // Activate Dice Cheat
        function activateDiceCheat(cheatType) {
            const cheat = diceCheatMethods[cheatType];
            if (!cheat) return;
            
            // Apply specific cheat effects
            switch(cheatType) {
                case 'luckyRolls':
                    activateLuckyRolls();
                    break;
                case 'loadedDice':
                    activateLoadedDice();
                    break;
                case 'doubleDown':
                    activateDoubleDown();
                    break;
            }
            
            diceCheatState = {
                active: cheatType,
                winRateBoost: cheat.winRateBoost,
                detectionRisk: cheat.detectionRisk
            };
            
            // Update UI
            document.getElementById('diceCheatStatus').textContent = cheat.name;
            document.getElementById('diceCheatStatus').className = 'text-green-400';
            
            // Update risk meter
            const riskMeter = document.getElementById('diceRiskMeter');
            riskMeter.style.width = `${cheat.detectionRisk * 100}%`;
            
            // Update button states
            document.querySelectorAll('#diceCheatSidePanel .cheat-button').forEach(btn => {
                btn.classList.remove('bg-green-600/60', 'border-green-400/70');
                btn.classList.add('bg-green-900/30', 'border-green-500/50');
            });
            
            const activeBtn = document.getElementById(`cheat${cheatType.charAt(0).toUpperCase() + cheatType.slice(1)}`);
            if (activeBtn) {
                activeBtn.classList.remove('bg-green-900/30', 'border-green-500/50');
                activeBtn.classList.add('bg-green-600/60', 'border-green-400/70');
            }
            
            console.log(`üéØ Dice cheat activated: ${cheat.name}`);
        }
        
        // Lucky Rolls Cheat - Better outcomes
        function activateLuckyRolls() {
            updateDiceGameStatus('üçÄ Network optimization activated - Enhanced metric patterns!', 'text-green-400');
            setTimeout(() => {
                updateDiceGameStatus('Configure your prediction parameters and analyze!', 'text-dt-cyan');
            }, 2000);
        }
        
        // Loaded Dice Cheat - Higher numbers
        function activateLoadedDice() {
            updateDiceGameStatus('‚öñÔ∏è Performance boost enabled - Elevated metrics!', 'text-yellow-400');
            setTimeout(() => {
                updateDiceGameStatus('Configure your prediction parameters and analyze!', 'text-dt-cyan');
            }, 2000);
        }
        
        // Double Down Cheat - Double winnings
        function activateDoubleDown() {
            updateDiceGameStatus('üéØ Resource multiplier active - 2x returns!', 'text-purple-400');
            setTimeout(() => {
                updateDiceGameStatus('Configure your prediction parameters and analyze!', 'text-dt-cyan');
            }, 2000);
        }
        
        // Add bet amount to current bet
        function addDiceBet(amount) {
            if (diceGame.isRolling) return;
            
            diceGame.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            
            if (diceGame.balance >= amount) {
                diceGame.currentBet += amount;
                updateDiceUI();
                updateDiceGameStatus(`Current bet: $${diceGame.currentBet}. Choose bet type!`, 'text-dt-yellow');
            } else {
                updateDiceGameStatus('Insufficient balance!', 'text-red-500');
            }
        }
        
        // Clear current bet
        function clearDiceBet() {
            if (diceGame.isRolling) return;
            
            diceGame.currentBet = 0;
            diceGame.betType = null;
            diceGame.payout = 0;
            updateDiceUI();
            updateDiceGameStatus('Configure your prediction parameters and analyze!', 'text-dt-cyan');
            
            // Clear bet button highlights
            document.querySelectorAll('.bet-button').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-white');
            });
        }
        
        // Set dice bet amount (for betting chips)
        function setDiceBet(amount) {
            if (diceGame.isRolling) return;
            
            diceGame.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            
            if (diceGame.balance >= (diceGame.currentBet + amount)) {
                diceGame.currentBet += amount;
                
                updateDiceUI();
                updateDiceGameStatus(`Bet increased by $${amount}. Total bet: $${diceGame.currentBet}. Choose bet type!`, 'text-dt-yellow');
            } else {
                updateDiceGameStatus('Insufficient balance!', 'text-red-500');
            }
        }
        
        // Place a specific bet type
        function placeDiceBet(betType, payoutRatio) {
            if (diceGame.currentBet === 0) {
                updateDiceGameStatus('Place a bet first!', 'text-red-500');
                return;
            }
            
            diceGame.betType = betType;
            diceGame.payout = payoutRatio;
            
            // Highlight selected bet
            document.querySelectorAll('.bet-button').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-white');
            });
            
            const betButton = document.getElementById(`bet${betType.charAt(0).toUpperCase() + betType.slice(1)}`);
            if (betButton) {
                betButton.classList.add('ring-4', 'ring-white');
            }
            
            updateDiceUI();
            updateDiceGameStatus(`Network prediction set: $${diceGame.currentBet} on ${betType.toUpperCase()}. Ready to analyze!`, 'text-dt-green');
            
            // Enable roll button
            document.getElementById('rollDiceBtn').disabled = false;
        }
        
        // Roll the dice
        function rollDice() {
            if (diceGame.currentBet === 0 || !diceGame.betType || diceGame.isRolling) return;
            
            diceGame.isRolling = true;
            document.getElementById('rollDiceBtn').disabled = true;
            
            // Send dice roll request to server
            sendDiceRoll();
            
            // Animate dice rolling
            const dice1Element = document.getElementById('dice1');
            const dice2Element = document.getElementById('dice2');
            
            dice1Element.classList.add('animate-spin');
            dice2Element.classList.add('animate-spin');
            
            let rollCount = 0;
            const rollInterval = setInterval(() => {
                dice1Element.textContent = Math.floor(Math.random() * 6) + 1;
                dice2Element.textContent = Math.floor(Math.random() * 6) + 1;
                rollCount++;
                
                if (rollCount > 10) {
                    clearInterval(rollInterval);
                    finalizeDiceRoll();
                }
            }, 100);
        }
        
        // Finalize dice roll with cheat effects
        function finalizeDiceRoll() {
            // Generate base roll
            let dice1 = Math.floor(Math.random() * 6) + 1;
            let dice2 = Math.floor(Math.random() * 6) + 1;
            
            // Apply cheat effects
            if (diceCheatState.active === 'loadedDice') {
                // Bias toward higher numbers
                if (Math.random() < 0.85) {
                    dice1 = Math.max(dice1, Math.floor(Math.random() * 3) + 4); // 4-6
                    dice2 = Math.max(dice2, Math.floor(Math.random() * 3) + 4); // 4-6
                }
            }
            
            if (diceCheatState.active === 'luckyRolls') {
                // General luck boost - increase chances of getting favorable numbers
                if (Math.random() < 0.7) {
                    // Favor more common winning combinations
                    const luckyOutcomes = [
                        [3, 4], [4, 3], [2, 5], [5, 2], [1, 6], [6, 1], // Total 7 (most common)
                        [4, 4], [3, 3], [5, 5], [2, 2], [6, 6], [1, 1], // Doubles
                        [4, 5], [5, 4], [3, 6], [6, 3], [2, 6], [6, 2]  // Other good combinations
                    ];
                    const luckyRoll = luckyOutcomes[Math.floor(Math.random() * luckyOutcomes.length)];
                    dice1 = luckyRoll[0];
                    dice2 = luckyRoll[1];
                }
            }
            
            diceGame.dice1 = dice1;
            diceGame.dice2 = dice2;
            diceGame.total = dice1 + dice2;
            diceGame.totalRolls++;
            
            // Display final result
            document.getElementById('dice1').textContent = dice1;
            document.getElementById('dice2').textContent = dice2;
            document.getElementById('diceTotal').textContent = diceGame.total;
            
            // Remove spinning animation
            document.getElementById('dice1').classList.remove('animate-spin');
            document.getElementById('dice2').classList.remove('animate-spin');
            
            // Check for win
            setTimeout(() => {
                checkDiceResult();
            }, 1000);
        }
        
        // Check if bet won
        function checkDiceWin(betType, total, dice1, dice2) {
            switch(betType) {
                // Range bets
                case 'high': return total >= 8 && total <= 12;
                case 'low': return total >= 2 && total <= 6;
                case 'odd': return total % 2 === 1;
                case 'even': return total % 2 === 0;
                
                // Specific sum bets
                case 'sum2': return total === 2;
                case 'sum3': return total === 3;
                case 'sum4': return total === 4;
                case 'sum5': return total === 5;
                case 'sum6': return total === 6;
                case 'sum7': case 'seven': return total === 7;
                case 'sum8': return total === 8;
                case 'sum9': return total === 9;
                case 'sum10': return total === 10;
                case 'sum11': return total === 11;
                case 'sum12': return total === 12;
                
                // Doubles bets
                case 'doubles': return dice1 === dice2;
                case 'double1': return dice1 === 1 && dice2 === 1;
                case 'double2': return dice1 === 2 && dice2 === 2;
                case 'double3': return dice1 === 3 && dice2 === 3;
                case 'double4': return dice1 === 4 && dice2 === 4;
                case 'double5': return dice1 === 5 && dice2 === 5;
                case 'double6': return dice1 === 6 && dice2 === 6;
                
                // Field bet (2,3,4,9,10,11,12)
                case 'field': return [2,3,4,9,10,11,12].includes(total);
                
                default: return false;
            }
        }
        
        // Check dice result and handle winnings
        function checkDiceResult() {
            const won = checkDiceWin(diceGame.betType, diceGame.total, diceGame.dice1, diceGame.dice2);
            
            if (won) {
                let winAmount = diceGame.currentBet * diceGame.payout;
                
                // Apply double down cheat
                if (diceCheatState.active === 'doubleDown') {
                    winAmount *= 2;
                }
                
                diceGame.balance += winAmount;
                diceGame.totalWins++;
                diceGame.totalWon += winAmount;
                
                // Send win result to server
                const netWinAmount = winAmount - diceGame.currentBet; // Net win (excluding returned bet)
                sendDiceResult('win', diceGame.dice1, diceGame.dice2, diceGame.total, netWinAmount, 0);
                
                updateDiceGameStatus(`üéâ YOU WIN! +$${winAmount} üéâ`, 'text-dt-green');
            } else {
                // Send loss result to server
                sendDiceResult('lose', diceGame.dice1, diceGame.dice2, diceGame.total, 0, diceGame.currentBet);
                
                updateDiceGameStatus(`üíî You lose $${diceGame.currentBet} üíî`, 'text-red-500');
            }
            
            // Update global balance
            router.balance = diceGame.balance;
            localStorage.setItem('vegasBalance', router.balance.toString());
            router.updateBalance('diceBalanceTop');
            
            updateDiceUI();
            
            // Reset for next round
            setTimeout(() => {
                resetDiceRound();
            }, 3000);
        }
        
        // Reset for next round
        function resetDiceRound() {
            diceGame.currentBet = 0;
            diceGame.betType = null;
            diceGame.payout = 0;
            diceGame.isRolling = false;
            
            document.getElementById('dice1').textContent = '?';
            document.getElementById('dice2').textContent = '?';
            document.getElementById('diceTotal').textContent = '-';
            
            document.querySelectorAll('.bet-button').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-white');
            });
            
            updateDiceUI();
            updateDiceGameStatus('Choose your bet and roll the dice!', 'text-dt-cyan');
        }
        
        // Update dice game UI
        function updateDiceUI() {
            document.getElementById('currentDiceBet').textContent = diceGame.currentBet;
            document.getElementById('currentBetType').textContent = diceGame.betType || 'None';
            document.getElementById('currentPayout').textContent = diceGame.betType ? `${diceGame.payout}:1` : '-';
            
            document.getElementById('totalRolls').textContent = diceGame.totalRolls;
            document.getElementById('totalWins').textContent = diceGame.totalWins;
            document.getElementById('winRate').textContent = diceGame.totalRolls > 0 ? 
                `${Math.round((diceGame.totalWins / diceGame.totalRolls) * 100)}%` : '0%';
            document.getElementById('totalWon').textContent = diceGame.totalWon;
            
            // Update roll button
            const rollBtn = document.getElementById('rollDiceBtn');
            rollBtn.disabled = diceGame.currentBet === 0 || !diceGame.betType || diceGame.isRolling;
        }
        
        // Update dice game status
        function updateDiceGameStatus(message, colorClass = 'text-dt-cyan') {
            const statusElement = document.getElementById('diceGameStatus');
            if (statusElement) {
                statusElement.textContent = message;
                statusElement.className = `text-center text-2xl font-bold ${colorClass} mb-6 min-h-[3rem] flex items-center justify-center transition-all duration-300`;
            }
        }

        // Send dice roll request to server
        function sendDiceRoll() {
            const userData = JSON.parse(localStorage.getItem('vegas.customerData') || '{}');
            
            const payload = {
                Username: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                CustomerName: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                Email: userData.email || 'user@demo.com',
                CompanyName: userData.companyName || 'Demo Company',
                Persona: userData.persona || 'Demo User',
                Booth: userData.booth || 'UI Demo',
                OptIn: userData.optIn !== false,
                BetAmount: diceGame.currentBet,
                balance: diceGame.balance + diceGame.currentBet, // Send balance before deduction
                Balance: diceGame.balance + diceGame.currentBet,
                BetType: diceGame.betType,
                Game: 'Vegas Dice Roll',
                Action: 'Roll',
                GameState: 'Started',
                Device: 'Browser-UI',
                CheatActive: diceCheatState.active !== null,
                CheatType: diceCheatState.active,
                CheatDetails: diceCheatState.active ? {
                    type: diceCheatState.active,
                    description: diceCheatMethods[diceCheatState.active]?.description || ''
                } : null,
                correlationId: 'ui_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9)
            };

            console.log('üé≤ Sending dice roll request:', payload);

            fetch('/api/dice/roll', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'User-Agent': 'Vegas-Casino-UI'
                },
                body: JSON.stringify(payload)
            }).then(response => response.json())
            .then(data => {
                console.log('üé≤ Dice roll response:', data);
            }).catch(error => {
                console.error('‚ùå Error sending dice roll:', error);
            });
        }

        // Send dice result to server
        function sendDiceResult(result, dice1, dice2, total, winAmount = 0, lossAmount = 0) {
            const userData = JSON.parse(localStorage.getItem('vegas.customerData') || '{}');
            
            const payload = {
                Username: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                CustomerName: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                Email: userData.email || 'user@demo.com',
                CompanyName: userData.companyName || 'Demo Company',
                Persona: userData.persona || 'Demo User',
                Booth: userData.booth || 'UI Demo',
                OptIn: userData.optIn !== false,
                BetAmount: diceGame.currentBet,
                balance: diceGame.balance - winAmount + lossAmount, // Original balance
                newBalance: diceGame.balance,
                Balance: diceGame.balance,
                BetType: diceGame.betType,
                Game: 'Vegas Dice Roll',
                Action: 'GameResult',
                GameState: 'Completed',
                Result: result, // 'win' or 'lose'
                Dice1: dice1,
                Dice2: dice2,
                DiceTotal: total,
                WinAmount: winAmount,
                LossAmount: lossAmount,
                WinFlag: winAmount > 0 ? 1 : 0,
                LossFlag: lossAmount > 0 ? 1 : 0,
                Payout: winAmount > 0 ? winAmount / diceGame.currentBet : 0,
                Device: 'Browser-UI',
                CheatActive: diceCheatState.active !== null,
                CheatType: diceCheatState.active,
                CheatDetails: diceCheatState.active ? {
                    type: diceCheatState.active,
                    description: diceCheatMethods[diceCheatState.active]?.description || ''
                } : null,
                correlationId: 'ui_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                timestamp: new Date().toISOString()
            };

            console.log('üé≤ Sending dice result:', payload);

            fetch('/api/dice/roll', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'User-Agent': 'Vegas-Casino-UI'
                },
                body: JSON.stringify(payload)
            }).then(response => response.json())
            .then(data => {
                console.log('üé≤ Dice result response:', data);
            }).catch(error => {
                console.error('‚ùå Error sending dice result:', error);
            });
        }
        
        // ==================== END DICE GAME FUNCTIONALITY ====================

        // ==================== ROULETTE GAME FUNCTIONALITY ====================
        
        let rouletteGame = {
            balance: 5600,
            bets: {}, // Store multiple bets: { betType: amount }
            totalBet: 0,
            isSpinning: false,
            result: null,
            totalSpins: 0,
            totalWins: 0,
            totalWon: 0
        };

        // Roulette cheat system
        let rouletteCheatState = {
            active: null,
            winRateBoost: 0,
            detectionRisk: 0
        };

        const rouletteCheatMethods = {
            magnet: {
                name: 'Magnetic Ball',
                description: 'Ball attracted to your bet',
                winRateBoost: 70,
                detectionRisk: 30
            },
            wheelControl: {
                name: 'Wheel Control', 
                description: 'Control wheel mechanics',
                winRateBoost: 85,
                detectionRisk: 45
            }
        };

        // Roulette numbers and colors
        const rouletteNumbers = {
            0: 'green', '00': 'green',
            1: 'red', 2: 'black', 3: 'red', 4: 'black', 5: 'red', 6: 'black',
            7: 'red', 8: 'black', 9: 'red', 10: 'black', 11: 'black', 12: 'red',
            13: 'black', 14: 'red', 15: 'black', 16: 'red', 17: 'black', 18: 'red',
            19: 'red', 20: 'black', 21: 'red', 22: 'black', 23: 'red', 24: 'black',
            25: 'red', 26: 'black', 27: 'red', 28: 'black', 29: 'black', 30: 'red',
            31: 'black', 32: 'red', 33: 'black', 34: 'red', 35: 'black', 36: 'red'
        };

        // Initialize roulette game
        function initializeRouletteGame() {
            rouletteGame.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            updateRouletteUI();
            
            // Update username and balance displays
            const username = localStorage.getItem('vegasUsername') || 'Player';
            document.getElementById('rouletteUsername').textContent = username;
            document.getElementById('rouletteBalance').textContent = `Balance: $${rouletteGame.balance}`;
            
            console.log('üéØ Roulette game initialized with balance:', rouletteGame.balance);
        }

        // Toggle roulette cheat panel
        function toggleRouletteCheatPanel() {
            const panel = document.getElementById('rouletteCheatPanel');
            panel.classList.toggle('translate-x-full');
        }

        // Activate roulette cheat
        function activateRouletteCheat(cheatType) {
            rouletteCheatState.active = cheatType;
            const cheat = rouletteCheatMethods[cheatType];
            rouletteCheatState.winRateBoost = cheat.winRateBoost;
            rouletteCheatState.detectionRisk = cheat.detectionRisk;
            
            // Update UI
            updateRouletteCheatUI();
            
            console.log(`üéØ Roulette cheat activated: ${cheat.name}`);
        }

        // Deactivate roulette cheat
        function deactivateRouletteCheat() {
            rouletteCheatState.active = null;
            rouletteCheatState.winRateBoost = 0;
            rouletteCheatState.detectionRisk = 0;
            
            updateRouletteCheatUI();
            console.log('üéØ Roulette cheat deactivated');
        }

        // Update cheat UI
        function updateRouletteCheatUI() {
            const buttons = document.querySelectorAll('#rouletteCheatPanel .cheat-button');
            buttons.forEach(btn => btn.classList.remove('ring-4', 'ring-yellow-400'));
            
            if (rouletteCheatState.active) {
                const activeBtn = document.getElementById(`rouletteCheat${rouletteCheatState.active.charAt(0).toUpperCase() + rouletteCheatState.active.slice(1)}`);
                if (activeBtn) activeBtn.classList.add('ring-4', 'ring-yellow-400');
                
                // Update side panel status
                document.getElementById('rouletteSidePanelCheatStatus').textContent = 
                    rouletteCheatMethods[rouletteCheatState.active].name;
                
                // Update risk meter
                document.getElementById('rouletteRiskMeter').style.width = 
                    `${rouletteCheatState.detectionRisk}%`;
            } else {
                document.getElementById('rouletteSidePanelCheatStatus').textContent = 'None';
                document.getElementById('rouletteRiskMeter').style.width = '0%';
            }
        }

        // Place a bet (for outside bets like red/black)
        function placeBet(betType) {
            if (rouletteGame.isSpinning) return;
            
            const chipAmount = parseInt(document.getElementById('rouletteChipAmount').value);
            
            // Sync balance from localStorage
            rouletteGame.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            
            if (rouletteGame.balance < chipAmount) {
                updateRouletteStatus('Insufficient balance!', 'text-red-500');
                return;
            }
            
            // Add to existing bet or create new bet
            if (!rouletteGame.bets[betType]) {
                rouletteGame.bets[betType] = 0;
            }
            rouletteGame.bets[betType] += chipAmount;
            rouletteGame.totalBet += chipAmount;
            
            updateRouletteUI();
            updateRouletteStatus(`Added $${chipAmount} to ${betType.toUpperCase()}`, 'text-dt-yellow');
            
            // Enable spin button if there are bets
            document.getElementById('spinRouletteBtn').disabled = rouletteGame.totalBet === 0;
        }

        // Place a number bet (for specific numbers)
        function placeNumberBet(number) {
            if (rouletteGame.isSpinning) return;
            
            const chipAmount = parseInt(document.getElementById('rouletteChipAmount').value);
            
            // Sync balance from localStorage
            rouletteGame.balance = parseInt(localStorage.getItem('vegasBalance') || '5600');
            
            if (rouletteGame.balance < chipAmount) {
                updateRouletteStatus('Insufficient balance!', 'text-red-500');
                return;
            }
            
            // Add to existing bet or create new bet
            if (!rouletteGame.bets[number]) {
                rouletteGame.bets[number] = 0;
            }
            rouletteGame.bets[number] += chipAmount;
            rouletteGame.totalBet += chipAmount;
            
            // Update chip display on the number
            updateChipDisplay(number);
            
            updateRouletteUI();
            updateRouletteStatus(`Added $${chipAmount} to number ${number}`, 'text-dt-yellow');
            
            // Enable spin button if there are bets
            document.getElementById('spinRouletteBtn').disabled = rouletteGame.totalBet === 0;
        }

        // Update chip display on betting table
        function updateChipDisplay(number) {
            const numberCell = document.querySelector(`[data-number="${number}"]`);
            if (numberCell) {
                const chipDisplay = numberCell.querySelector('.bet-chips');
                const betAmount = rouletteGame.bets[number] || 0;
                if (betAmount > 0) {
                    chipDisplay.textContent = `$${betAmount}`;
                    chipDisplay.classList.add('bg-dt-yellow', 'text-black', 'rounded-full', 'px-1');
                } else {
                    chipDisplay.textContent = '';
                    chipDisplay.classList.remove('bg-dt-yellow', 'text-black', 'rounded-full', 'px-1');
                }
            }
        }

        // Clear all bets
        function clearAllBets() {
            if (rouletteGame.isSpinning) return;
            
            rouletteGame.bets = {};
            rouletteGame.totalBet = 0;
            
            // Clear all chip displays
            document.querySelectorAll('.bet-chips').forEach(chipDisplay => {
                chipDisplay.textContent = '';
                chipDisplay.classList.remove('bg-dt-yellow', 'text-black', 'rounded-full', 'px-1');
            });
            
            // Clear bet button highlights
            document.querySelectorAll('.bet-button').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-yellow-400');
            });
            
            updateRouletteUI();
            updateRouletteStatus('All bets cleared', 'text-dt-cyan');
            
            // Disable spin button
            document.getElementById('spinRouletteBtn').disabled = true;
        }

        // Spin the roulette wheel
        function spinRoulette() {
            if (rouletteGame.totalBet === 0 || rouletteGame.isSpinning) return;
            
            rouletteGame.isSpinning = true;
            document.getElementById('spinRouletteBtn').disabled = true;
            
            // Send spin request to server
            sendRouletteSpinRequest();
            
            // Deduct total bet from balance
            rouletteGame.balance -= rouletteGame.totalBet;
            router.balance = rouletteGame.balance;
            localStorage.setItem('vegasBalance', router.balance.toString());
            
            updateRouletteStatus('Spinning...', 'text-dt-orange');
            
            // Animate wheel spin
            const wheel = document.getElementById('rouletteWheel');
            const ball = document.getElementById('rouletteBall');
            
            // Generate result (apply cheat if active)
            let result = generateRouletteResult();
            
            // Spin animation
            const spins = 4 + Math.random() * 2; // 4-6 full rotations
            const finalRotation = spins * 360;
            
            wheel.style.transform = `rotate(${finalRotation}deg)`;
            ball.style.transform = `rotate(${-finalRotation * 1.2}deg)`;
            
            // Show result after animation
            setTimeout(() => {
                displayRouletteResult(result);
            }, 4000);
        }

        // Generate roulette result
        function generateRouletteResult() {
            let possibleResults = Object.keys(rouletteNumbers);
            
            // Apply cheat logic if active
            if (rouletteCheatState.active && Math.random() * 100 < rouletteCheatState.winRateBoost) {
                return generateWinningRouletteResult();
            }
            
            // Normal random result
            return possibleResults[Math.floor(Math.random() * possibleResults.length)];
        }

        // Generate winning result based on current bet
        function generateWinningRouletteResult() {
            const betType = rouletteGame.betType;
            let winningNumbers = [];
            
            switch(betType) {
                case 'red':
                    winningNumbers = Object.keys(rouletteNumbers).filter(num => rouletteNumbers[num] === 'red');
                    break;
                case 'black':
                    winningNumbers = Object.keys(rouletteNumbers).filter(num => rouletteNumbers[num] === 'black');
                    break;
                case 'even':
                    winningNumbers = Object.keys(rouletteNumbers).filter(num => 
                        !isNaN(num) && parseInt(num) > 0 && parseInt(num) % 2 === 0);
                    break;
                case 'odd':
                    winningNumbers = Object.keys(rouletteNumbers).filter(num => 
                        !isNaN(num) && parseInt(num) > 0 && parseInt(num) % 2 === 1);
                    break;
                case 'low':
                    winningNumbers = Object.keys(rouletteNumbers).filter(num => 
                        !isNaN(num) && parseInt(num) >= 1 && parseInt(num) <= 18);
                    break;
                case 'high':
                    winningNumbers = Object.keys(rouletteNumbers).filter(num => 
                        !isNaN(num) && parseInt(num) >= 19 && parseInt(num) <= 36);
                    break;
                case 'zero':
                    return '0';
                case '00':
                    return '00';
                default:
                    // If betting on a specific number, return that number
                    if (Object.keys(rouletteNumbers).includes(betType)) {
                        return betType;
                    }
                    // Fallback to red numbers
                    winningNumbers = Object.keys(rouletteNumbers).filter(num => rouletteNumbers[num] === 'red');
            }
            
            return winningNumbers[Math.floor(Math.random() * winningNumbers.length)] || '0';
        }

        // Display roulette result and handle winnings
        function displayRouletteResult(result) {
            rouletteGame.result = result;
            document.getElementById('rouletteResult').textContent = result;
            rouletteGame.totalSpins++;
            
            let totalWinAmount = 0;
            let totalLossAmount = 0;
            let winningBets = [];
            
            // Check each bet to see if it won
            Object.keys(rouletteGame.bets).forEach(betType => {
                const betAmount = rouletteGame.bets[betType];
                const won = checkRouletteWin(betType, result);
                
                if (won) {
                    let winAmount = calculateRouletteWinAmount(betType, betAmount);
                    
                    // Apply cheat bonus if active
                    if (rouletteCheatState.active === 'wheelControl') {
                        winAmount = Math.floor(winAmount * 1.5); // 50% bonus
                    }
                    
                    totalWinAmount += winAmount;
                    winningBets.push(`${betType}: +$${winAmount}`);
                } else {
                    totalLossAmount += betAmount;
                }
            });
            
            // Update balance and stats
            rouletteGame.balance += totalWinAmount;
            if (totalWinAmount > 0) {
                rouletteGame.totalWins++;
                rouletteGame.totalWon += totalWinAmount;
            }
            
            // Send result to server
            if (totalWinAmount > 0) {
                const netWinAmount = totalWinAmount - rouletteGame.totalBet;
                sendRouletteResult('win', result, netWinAmount, 0);
            } else {
                sendRouletteResult('lose', result, 0, rouletteGame.totalBet);
            }
            
            // Display result message
            if (totalWinAmount > 0) {
                updateRouletteStatus(`üéâ YOU WIN! +$${totalWinAmount} üéâ`, 'text-dt-green');
                document.getElementById('rouletteWin').innerHTML = `
                    <div>üéä Result: ${result} üéä</div>
                    <div class="text-sm mt-1">${winningBets.join(', ')}</div>
                `;
            } else {
                updateRouletteStatus(`Result: ${result} - You lose $${rouletteGame.totalBet}`, 'text-red-500');
                document.getElementById('rouletteWin').textContent = '';
            }
            
            // Show cheat status if active
            if (rouletteCheatState.active) {
                document.getElementById('rouletteCheatStatusDisplay').textContent = 
                    `‚ö†Ô∏è Cheat Active: ${rouletteCheatMethods[rouletteCheatState.active].name}`;
            }
            
            // Update global balance
            router.balance = rouletteGame.balance;
            localStorage.setItem('vegasBalance', router.balance.toString());
            router.updateBalance('rouletteBalance');
            
            updateRouletteUI();
            
            // Reset for next spin
            setTimeout(() => {
                resetRouletteRound();
            }, 4000);
        }

        // Check if bet won
        function checkRouletteWin(betType, result) {
            const resultNum = parseInt(result);
            const resultColor = rouletteNumbers[result];
            
            switch(betType) {
                case 'red': return resultColor === 'red';
                case 'black': return resultColor === 'black';
                case 'even': return !isNaN(resultNum) && resultNum > 0 && resultNum % 2 === 0;
                case 'odd': return !isNaN(resultNum) && resultNum > 0 && resultNum % 2 === 1;
                case 'low': return !isNaN(resultNum) && resultNum >= 1 && resultNum <= 18;
                case 'high': return !isNaN(resultNum) && resultNum >= 19 && resultNum <= 36;
                case 'zero': return result === '0';
                case '00': return result === '00';
                default: return result === betType; // Direct number bet
            }
        }

        // Calculate win amount based on bet type
        function calculateRouletteWinAmount(betType, betAmount) {
            switch(betType) {
                case 'red':
                case 'black':
                case 'even':
                case 'odd':
                case 'low':
                case 'high':
                    return betAmount * 2; // 1:1 payout (return bet + win)
                case 'zero':
                case '00':
                    return betAmount * 36; // 35:1 payout (return bet + 35x win)
                default:
                    // Single number bets
                    if (Object.keys(rouletteNumbers).includes(betType)) {
                        return betAmount * 36; // 35:1 payout
                    }
                    return betAmount * 2; // Default 1:1
            }
        }

        // Reset for next round
        function resetRouletteRound() {
            rouletteGame.bets = {};
            rouletteGame.totalBet = 0;
            rouletteGame.isSpinning = false;
            
            // Clear all chip displays
            document.querySelectorAll('.bet-chips').forEach(chipDisplay => {
                chipDisplay.textContent = '';
                chipDisplay.classList.remove('bg-dt-yellow', 'text-black', 'rounded-full', 'px-1');
            });
            
            // Clear bet button highlights
            document.querySelectorAll('.bet-button').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-yellow-400');
            });
            
            // Reset wheel rotation
            document.getElementById('rouletteWheel').style.transform = 'rotate(0deg)';
            document.getElementById('rouletteBall').style.transform = 'rotate(0deg)';
            document.getElementById('rouletteResult').textContent = '?';
            
            updateRouletteUI();
            updateRouletteStatus('Place your bets for the next spin!', 'text-dt-green');
            document.getElementById('rouletteWin').textContent = '';
            document.getElementById('rouletteCheatStatusDisplay').textContent = '';
            
            // Disable spin button until bets are placed
            document.getElementById('spinRouletteBtn').disabled = true;
        }

        // Update roulette UI
        function updateRouletteUI() {
            document.getElementById('rouletteBalance').textContent = `Balance: $${rouletteGame.balance}`;
            
            // Update active bets display
            if (rouletteGame.totalBet > 0) {
                const betsList = Object.keys(rouletteGame.bets).map(betType => {
                    return `${betType}: $${rouletteGame.bets[betType]}`;
                }).join(', ');
                document.getElementById('rouletteActiveBets').textContent = betsList;
            } else {
                document.getElementById('rouletteActiveBets').textContent = 'No bets placed';
            }
            
            document.getElementById('rouletteTotalBet').textContent = rouletteGame.totalBet;
        }

        // Update roulette status message
        function updateRouletteStatus(message, className = 'text-dt-green') {
            const statusElement = document.getElementById('rouletteStatus');
            statusElement.textContent = message;
            statusElement.className = `text-lg font-semibold ${className}`;
        }

        // Send roulette spin request to server
        function sendRouletteSpinRequest() {
            const userData = JSON.parse(localStorage.getItem('vegas.customerData') || '{}');
            
            const payload = {
                Username: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                CustomerName: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                Email: userData.email || 'user@demo.com',
                CompanyName: userData.companyName || 'Demo Company',
                Persona: userData.persona || 'Demo User',
                Booth: userData.booth || 'UI Demo',
                OptIn: userData.optIn !== false,
                BetAmount: rouletteGame.totalBet,
                balance: rouletteGame.balance + rouletteGame.totalBet, // Send balance before deduction
                Balance: rouletteGame.balance + rouletteGame.totalBet,
                Bets: rouletteGame.bets, // Send all bets
                TotalBets: Object.keys(rouletteGame.bets).length,
                Game: 'Vegas Roulette',
                Action: 'Spin',
                GameState: 'Started',
                Device: 'Browser-UI',
                CheatActive: rouletteCheatState.active !== null,
                CheatType: rouletteCheatState.active,
                CheatDetails: rouletteCheatState.active ? {
                    type: rouletteCheatState.active,
                    description: rouletteCheatMethods[rouletteCheatState.active]?.description || ''
                } : null,
                correlationId: 'ui_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9)
            };

            console.log('üéØ Sending roulette spin request:', payload);

            fetch('/api/roulette/spin', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'User-Agent': 'Vegas-Casino-UI'
                },
                body: JSON.stringify(payload)
            }).then(response => response.json())
            .then(data => {
                console.log('üéØ Roulette spin response:', data);
            }).catch(error => {
                console.error('‚ùå Error sending roulette spin:', error);
            });
        }

        // Send roulette result to server
        function sendRouletteResult(result, number, winAmount = 0, lossAmount = 0) {
            const userData = JSON.parse(localStorage.getItem('vegas.customerData') || '{}');
            
            const payload = {
                Username: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                CustomerName: userData.customerName || localStorage.getItem('vegasUsername') || 'Anonymous',
                Email: userData.email || 'user@demo.com',
                CompanyName: userData.companyName || 'Demo Company',
                Persona: userData.persona || 'Demo User',
                Booth: userData.booth || 'UI Demo',
                OptIn: userData.optIn !== false,
                BetAmount: rouletteGame.totalBet,
                balance: rouletteGame.balance - winAmount + lossAmount, // Original balance
                newBalance: rouletteGame.balance,
                Balance: rouletteGame.balance,
                Bets: rouletteGame.bets, // Send all bets that were placed
                TotalBets: Object.keys(rouletteGame.bets).length,
                Game: 'Vegas Roulette',
                Action: 'GameResult',
                GameState: 'Completed',
                Result: result, // 'win' or 'lose'
                WinningNumber: number,
                NumberColor: rouletteNumbers[number] || 'unknown',
                WinAmount: winAmount,
                LossAmount: lossAmount,
                WinFlag: winAmount > 0 ? 1 : 0,
                LossFlag: lossAmount > 0 ? 1 : 0,
                Payout: winAmount > 0 ? winAmount / rouletteGame.totalBet : 0,
                Device: 'Browser-UI',
                CheatActive: rouletteCheatState.active !== null,
                CheatType: rouletteCheatState.active,
                CheatDetails: rouletteCheatState.active ? {
                    type: rouletteCheatState.active,
                    description: rouletteCheatMethods[rouletteCheatState.active]?.description || ''
                } : null,
                correlationId: 'ui_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                timestamp: new Date().toISOString()
            };

            console.log('üéØ Sending roulette result:', payload);

            fetch('/api/roulette/spin', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'User-Agent': 'Vegas-Casino-UI'
                },
                body: JSON.stringify(payload)
            }).then(response => response.json())
            .then(data => {
                console.log('üéØ Roulette result response:', data);
            }).catch(error => {
                console.error('‚ùå Error sending roulette result:', error);
            });
        }
        
        // ==================== END ROULETTE GAME FUNCTIONALITY ====================
        
        // Initialize router
        const router = new VegasRouter();
        
        document.addEventListener('DOMContentLoaded', () => {
            router.init();
            console.log('‚úÖ Vegas Casino SPA Ready!');
            
            // Check if current user is locked out
            setTimeout(() => {
                checkLockoutStatus();
            }, 1000); // Small delay to ensure router is fully initialized
        });
    </script>
</body>
</html>